{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/manifest/v9.json", "dbt_version": "1.5.1", "generated_at": "2023-12-21T20:55:34.328515Z", "invocation_id": "bf5cd255-80a0-49ee-bd14-97db9529e56d", "env": {}, "project_id": "37e9b0fc1542514abb8721cf67968006", "user_id": "3753eec8-782e-4b21-af36-aafc92836c40", "send_anonymous_usage_stats": true, "adapter_type": "postgres"}, "nodes": {"model.sagerx.int_ndc_all_ndcs_to_sources": {"database": "sagerx", "schema": "intermediate", "name": "int_ndc_all_ndcs_to_sources", "resource_type": "model", "package_name": "sagerx", "path": "intermediate/ndc/int_ndc_all_ndcs_to_sources.sql", "original_file_path": "models/intermediate/ndc/int_ndc_all_ndcs_to_sources.sql", "unique_id": "model.sagerx.int_ndc_all_ndcs_to_sources", "fqn": ["sagerx", "intermediate", "ndc", "int_ndc_all_ndcs_to_sources"], "alias": "int_ndc_all_ndcs_to_sources", "checksum": {"name": "sha256", "checksum": "607a1814a4911b6d24e1d31fdb825a7dcb304b72fef82bc9a638691cb186d342"}, "config": {"enabled": true, "alias": null, "schema": "intermediate", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate", "materialized": "table"}, "created_at": 1703192134.8340735, "relation_name": "\"sagerx\".\"intermediate\".\"int_ndc_all_ndcs_to_sources\"", "raw_code": "-- stg_ndc_all_ndcs_to_sources.sql\n\nwith rxnorm_historical_ndcs as\n(\n    -- NOTE: likely need to pick the most recent NDC\n    -- instead of just distinct\n    -- and pull in the other columns too possibly\n    select distinct ndc\n    from {{ ref('stg_rxnorm_historical__ndcs') }}\n)\n\n, rxnorm_all_ndcs as\n(\n    select distinct ndc11 as ndc\n    from {{ ref('stg_rxnorm__all_ndcs') }}\n)\n\n, fda_ndc_ndcs as\n(\n    select distinct ndc11 as ndc\n    from {{ ref('stg_fda_ndc__ndc') }}\n)\n\n, fda_excluded_ndcs as\n(\n    select distinct ndc11 as ndc\n    from staging.fda_excluded\n)\n\n, fda_unfinished_ndcs as\n(\n    select distinct ndc11 as ndc\n    from staging.fda_unfinished\n)\n\n, all_distinct_ndcs as\n(\n    select ndc from rxnorm_historical_ndcs\n    union\n    select ndc from rxnorm_all_ndcs\n    union\n    select ndc from fda_ndc_ndcs\n    union\n    select ndc from fda_excluded_ndcs\n    union\n    select ndc from fda_unfinished_ndcs\n)\n\nselect\n    all_distinct_ndcs.ndc\n    , case when rxnorm_historical_ndcs.ndc is not null\n        then 1 \n        else 0\n        end as rxnorm_historical_ndcs\n    , case when rxnorm_all_ndcs.ndc is not null\n        then 1 \n        else 0\n        end as rxnorm_all_ndcs\n    , case when fda_ndc_ndcs.ndc is not null\n        then 1 \n        else 0\n        end as fda_ndc_ndcs\n    , case when fda_excluded_ndcs.ndc is not null\n        then 1 \n        else 0\n        end as fda_excluded_ndcs\n    , case when fda_unfinished_ndcs.ndc is not null\n        then 1 \n        else 0\n        end as fda_unfinished_ndcs\nfrom all_distinct_ndcs\nleft join rxnorm_historical_ndcs\n    on rxnorm_historical_ndcs.ndc = all_distinct_ndcs.ndc\nleft join rxnorm_all_ndcs\n    on rxnorm_all_ndcs.ndc = all_distinct_ndcs.ndc\nleft join fda_ndc_ndcs\n    on fda_ndc_ndcs.ndc = all_distinct_ndcs.ndc\nleft join fda_excluded_ndcs\n    on fda_excluded_ndcs.ndc = all_distinct_ndcs.ndc\nleft join fda_unfinished_ndcs\n    on fda_unfinished_ndcs.ndc = all_distinct_ndcs.ndc", "language": "sql", "refs": [{"name": "stg_rxnorm_historical__ndcs", "package": null, "version": null}, {"name": "stg_rxnorm__all_ndcs", "package": null, "version": null}, {"name": "stg_fda_ndc__ndc", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.sagerx.stg_rxnorm_historical__ndcs", "model.sagerx.stg_rxnorm__all_ndcs", "model.sagerx.stg_fda_ndc__ndc"]}, "compiled_path": "target/compiled/sagerx/models/intermediate/ndc/int_ndc_all_ndcs_to_sources.sql", "compiled": true, "compiled_code": "-- stg_ndc_all_ndcs_to_sources.sql\n\nwith rxnorm_historical_ndcs as\n(\n    -- NOTE: likely need to pick the most recent NDC\n    -- instead of just distinct\n    -- and pull in the other columns too possibly\n    select distinct ndc\n    from \"sagerx\".\"staging\".\"stg_rxnorm_historical__ndcs\"\n)\n\n, rxnorm_all_ndcs as\n(\n    select distinct ndc11 as ndc\n    from \"sagerx\".\"staging\".\"stg_rxnorm__all_ndcs\"\n)\n\n, fda_ndc_ndcs as\n(\n    select distinct ndc11 as ndc\n    from \"sagerx\".\"staging\".\"stg_fda_ndc__ndc\"\n)\n\n, fda_excluded_ndcs as\n(\n    select distinct ndc11 as ndc\n    from staging.fda_excluded\n)\n\n, fda_unfinished_ndcs as\n(\n    select distinct ndc11 as ndc\n    from staging.fda_unfinished\n)\n\n, all_distinct_ndcs as\n(\n    select ndc from rxnorm_historical_ndcs\n    union\n    select ndc from rxnorm_all_ndcs\n    union\n    select ndc from fda_ndc_ndcs\n    union\n    select ndc from fda_excluded_ndcs\n    union\n    select ndc from fda_unfinished_ndcs\n)\n\nselect\n    all_distinct_ndcs.ndc\n    , case when rxnorm_historical_ndcs.ndc is not null\n        then 1 \n        else 0\n        end as rxnorm_historical_ndcs\n    , case when rxnorm_all_ndcs.ndc is not null\n        then 1 \n        else 0\n        end as rxnorm_all_ndcs\n    , case when fda_ndc_ndcs.ndc is not null\n        then 1 \n        else 0\n        end as fda_ndc_ndcs\n    , case when fda_excluded_ndcs.ndc is not null\n        then 1 \n        else 0\n        end as fda_excluded_ndcs\n    , case when fda_unfinished_ndcs.ndc is not null\n        then 1 \n        else 0\n        end as fda_unfinished_ndcs\nfrom all_distinct_ndcs\nleft join rxnorm_historical_ndcs\n    on rxnorm_historical_ndcs.ndc = all_distinct_ndcs.ndc\nleft join rxnorm_all_ndcs\n    on rxnorm_all_ndcs.ndc = all_distinct_ndcs.ndc\nleft join fda_ndc_ndcs\n    on fda_ndc_ndcs.ndc = all_distinct_ndcs.ndc\nleft join fda_excluded_ndcs\n    on fda_excluded_ndcs.ndc = all_distinct_ndcs.ndc\nleft join fda_unfinished_ndcs\n    on fda_unfinished_ndcs.ndc = all_distinct_ndcs.ndc", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.int_rxnorm_clinical_products_to_dose_forms": {"database": "sagerx", "schema": "intermediate", "name": "int_rxnorm_clinical_products_to_dose_forms", "resource_type": "model", "package_name": "sagerx", "path": "intermediate/rxnorm/int_rxnorm_clinical_products_to_dose_forms.sql", "original_file_path": "models/intermediate/rxnorm/int_rxnorm_clinical_products_to_dose_forms.sql", "unique_id": "model.sagerx.int_rxnorm_clinical_products_to_dose_forms", "fqn": ["sagerx", "intermediate", "rxnorm", "int_rxnorm_clinical_products_to_dose_forms"], "alias": "int_rxnorm_clinical_products_to_dose_forms", "checksum": {"name": "sha256", "checksum": "5c0dd87efc6781f9c6c2e2aa81b87d948c9982936d2b7f9513a346075fbbaf84"}, "config": {"enabled": true, "alias": null, "schema": "intermediate", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "RxNorm clinical products to dose forms.", "columns": {"clinical_product_rxcui": {"name": "clinical_product_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_name": {"name": "clinical_product_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_tty": {"name": "clinical_product_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_component_rxcui": {"name": "clinical_product_component_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_compnent_name": {"name": "clinical_product_compnent_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_component_tty": {"name": "clinical_product_component_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "dose_form_rxcui": {"name": "dose_form_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "dose_form_name": {"name": "dose_form_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "dose_form_tty": {"name": "dose_form_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active": {"name": "active", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "prescribable": {"name": "prescribable", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/intermediate/rxnorm/_int_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate", "materialized": "table"}, "created_at": 1703192135.0206025, "relation_name": "\"sagerx\".\"intermediate\".\"int_rxnorm_clinical_products_to_dose_forms\"", "raw_code": "-- int_rxnorm_clinical_products_to_dose_forms.sql\n\nwith\n\nrcp as (\n\n    select * from {{ ref('stg_rxnorm__clinical_products') }}\n\n),\n\nrcpcl as (\n\n    select * from {{ ref('stg_rxnorm__clinical_product_component_links') }}\n\n),\n\nrcpc as (\n\n    select * from {{ ref('stg_rxnorm__clinical_product_components') }}\n\n),\n\nrdf as (\n\n    select * from {{ ref('stg_rxnorm__dose_forms') }}\n\n)\n\nselect\n    rcp.rxcui as clinical_product_rxcui\n    , rcp.name as clinical_product_name\n    , rcp.tty as clinical_product_tty\n    , rcpc.rxcui as clinical_product_component_rxcui\n    , rcpc.name as clinical_product_compnent_name\n    , rcpc.tty as clinical_product_component_tty\n    , rdf.rxcui as dose_form_rxcui\n    , rdf.name as dose_form_name\n    , rdf.tty as dose_form_tty\n    , rcp.active\n    , rcp.prescribable\nfrom rcp \nleft join rcpcl \n    on rcp.rxcui = rcpcl.clinical_product_rxcui \nleft join rcpc \n    on rcpcl.clinical_product_component_rxcui = rcpc.rxcui \nleft join rdf \n    on rcpc.dose_form_rxcui = rdf.rxcui", "language": "sql", "refs": [{"name": "stg_rxnorm__clinical_products", "package": null, "version": null}, {"name": "stg_rxnorm__clinical_product_component_links", "package": null, "version": null}, {"name": "stg_rxnorm__clinical_product_components", "package": null, "version": null}, {"name": "stg_rxnorm__dose_forms", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.sagerx.stg_rxnorm__clinical_products", "model.sagerx.stg_rxnorm__clinical_product_component_links", "model.sagerx.stg_rxnorm__clinical_product_components", "model.sagerx.stg_rxnorm__dose_forms"]}, "compiled_path": "target/compiled/sagerx/models/intermediate/rxnorm/int_rxnorm_clinical_products_to_dose_forms.sql", "compiled": true, "compiled_code": "-- int_rxnorm_clinical_products_to_dose_forms.sql\n\nwith\n\nrcp as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__clinical_products\"\n\n),\n\nrcpcl as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__clinical_product_component_links\"\n\n),\n\nrcpc as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__clinical_product_components\"\n\n),\n\nrdf as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__dose_forms\"\n\n)\n\nselect\n    rcp.rxcui as clinical_product_rxcui\n    , rcp.name as clinical_product_name\n    , rcp.tty as clinical_product_tty\n    , rcpc.rxcui as clinical_product_component_rxcui\n    , rcpc.name as clinical_product_compnent_name\n    , rcpc.tty as clinical_product_component_tty\n    , rdf.rxcui as dose_form_rxcui\n    , rdf.name as dose_form_name\n    , rdf.tty as dose_form_tty\n    , rcp.active\n    , rcp.prescribable\nfrom rcp \nleft join rcpcl \n    on rcp.rxcui = rcpcl.clinical_product_rxcui \nleft join rcpc \n    on rcpcl.clinical_product_component_rxcui = rcpc.rxcui \nleft join rdf \n    on rcpc.dose_form_rxcui = rdf.rxcui", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.int_rxnorm_clinical_products_to_ingredient_strengths": {"database": "sagerx", "schema": "intermediate", "name": "int_rxnorm_clinical_products_to_ingredient_strengths", "resource_type": "model", "package_name": "sagerx", "path": "intermediate/rxnorm/int_rxnorm_clinical_products_to_ingredient_strengths.sql", "original_file_path": "models/intermediate/rxnorm/int_rxnorm_clinical_products_to_ingredient_strengths.sql", "unique_id": "model.sagerx.int_rxnorm_clinical_products_to_ingredient_strengths", "fqn": ["sagerx", "intermediate", "rxnorm", "int_rxnorm_clinical_products_to_ingredient_strengths"], "alias": "int_rxnorm_clinical_products_to_ingredient_strengths", "checksum": {"name": "sha256", "checksum": "19e756ad830f021e6224504172abd2aff93900707cbd565edfc674a726177473"}, "config": {"enabled": true, "alias": null, "schema": "intermediate", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "RxNorm clinical products to ingredient strengths.", "columns": {"clinical_product_rxcui": {"name": "clinical_product_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_name": {"name": "clinical_product_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_tty": {"name": "clinical_product_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_component_rxcui": {"name": "clinical_product_component_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_compnent_name": {"name": "clinical_product_compnent_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_component_tty": {"name": "clinical_product_component_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "dose_form_rxcui": {"name": "dose_form_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "dose_form_name": {"name": "dose_form_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "dose_form_tty": {"name": "dose_form_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ingredient_rxcui": {"name": "ingredient_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ingredient_name": {"name": "ingredient_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ingredient_tty": {"name": "ingredient_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ingredient_component_rxcui": {"name": "ingredient_component_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ingredient_component_name": {"name": "ingredient_component_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ingredient_component_tty": {"name": "ingredient_component_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ingredient_strength_rxcui": {"name": "ingredient_strength_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ingredient_strength_name": {"name": "ingredient_strength_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "strength_numerator_value": {"name": "strength_numerator_value", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "strength_numerator_unit": {"name": "strength_numerator_unit", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "strength_denominator_value": {"name": "strength_denominator_value", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "strength_denominator_unit": {"name": "strength_denominator_unit", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "strength_text": {"name": "strength_text", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active": {"name": "active", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "prescribable": {"name": "prescribable", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/intermediate/rxnorm/_int_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate", "materialized": "table"}, "created_at": 1703192135.043796, "relation_name": "\"sagerx\".\"intermediate\".\"int_rxnorm_clinical_products_to_ingredient_strengths\"", "raw_code": "-- int_rxnorm_clinical_products_to_ingredient_strengths.sql\n\nwith\n\nrcp as (\n\n    select * from {{ ref('stg_rxnorm__clinical_products') }}\n\n),\n\nrcpcl as (\n\n    select * from {{ ref('stg_rxnorm__clinical_product_component_links') }}\n\n),\n\nrcpc as (\n\n    select * from {{ ref('stg_rxnorm__clinical_product_components') }}\n\n),\n\nrdf as (\n\n    select * from {{ ref('stg_rxnorm__dose_forms') }}\n\n),\n\nri as (\n\n    select * from {{ ref('stg_rxnorm__ingredients') }}\n\n),\n\nricl as (\n\n    select * from {{ ref('stg_rxnorm__ingredient_component_links') }}\n\n),\n\nric as (\n\n    select * from {{ ref('stg_rxnorm__ingredient_components') }}\n\n),\n\nrisl as (\n\n    select * from {{ ref('stg_rxnorm__ingredient_strength_links') }}\n\n),\n\nris as (\n\n    select * from {{ ref('stg_rxnorm__ingredient_strengths') }}\n\n),\n\npinl as (\n\n    select * from {{ ref('stg_rxnorm__precise_ingredient_links') }}\n\n),\n\npin as (\n\n    select * from {{ ref('stg_rxnorm__precise_ingredients') }}\n\n)\n\nselect\n    rcp.rxcui as clinical_product_rxcui\n    , rcp.name as clinical_product_name\n    , rcp.tty as clinical_product_tty\n    , rcpc.rxcui as clinical_product_component_rxcui\n    , rcpc.name as clinical_product_compnent_name\n    , rcpc.tty as clinical_product_component_tty\n    , rdf.rxcui as dose_form_rxcui\n    , rdf.name as dose_form_name\n    , rdf.tty as dose_form_tty\n    , ri.rxcui as ingredient_rxcui\n    , ri.name as ingredient_name\n    , ri.tty as ingredient_tty\n    , ric.rxcui as ingredient_component_rxcui\n    , ric.name as ingredient_component_name\n    , ric.tty as ingredient_component_tty\n    , ris.rxcui as ingredient_strength_rxcui\n    , ris.name as ingredient_strength_name\n    , ris.numerator_value as strength_numerator_value\n    , ris.numerator_unit as strength_numerator_unit\n    , ris.denominator_value as strength_denominator_value\n    , ris.denominator_unit as strength_denominator_unit\n    , ris.text as strength_text\n    , pin.rxcui as precise_ingredient_rxcui\n    , pin.name as precise_ingredient_name\n    , pin.tty as precise_ingredient_tty\n    , rcp.active\n    , rcp.prescribable\nfrom rcp \nleft join rcpcl \n    on rcp.rxcui = rcpcl.clinical_product_rxcui \nleft join rcpc \n    on rcpcl.clinical_product_component_rxcui = rcpc.rxcui \nleft join rdf \n    on rcpc.dose_form_rxcui = rdf.rxcui \nleft join ri \n    on rcpc.ingredient_rxcui = ri.rxcui \nleft join ricl \n    on ri.rxcui = ricl.ingredient_rxcui \nleft join ric \n    on ricl.ingredient_component_rxcui = ric.rxcui \nleft join risl \n    on rcpc.rxcui = risl.clinical_product_component_rxcui \n    and ric.rxcui = risl.ingredient_component_rxcui \nleft join ris \n    on risl.ingredient_strength_rxcui = ris.rxcui\nleft join pinl\n    on ris.rxcui = pinl.ingredient_strength_rxcui\nleft join pin\n    on pinl.precise_ingredient_rxcui = pin.rxcui", "language": "sql", "refs": [{"name": "stg_rxnorm__clinical_products", "package": null, "version": null}, {"name": "stg_rxnorm__clinical_product_component_links", "package": null, "version": null}, {"name": "stg_rxnorm__clinical_product_components", "package": null, "version": null}, {"name": "stg_rxnorm__dose_forms", "package": null, "version": null}, {"name": "stg_rxnorm__ingredients", "package": null, "version": null}, {"name": "stg_rxnorm__ingredient_component_links", "package": null, "version": null}, {"name": "stg_rxnorm__ingredient_components", "package": null, "version": null}, {"name": "stg_rxnorm__ingredient_strength_links", "package": null, "version": null}, {"name": "stg_rxnorm__ingredient_strengths", "package": null, "version": null}, {"name": "stg_rxnorm__precise_ingredient_links", "package": null, "version": null}, {"name": "stg_rxnorm__precise_ingredients", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.sagerx.stg_rxnorm__clinical_products", "model.sagerx.stg_rxnorm__clinical_product_component_links", "model.sagerx.stg_rxnorm__clinical_product_components", "model.sagerx.stg_rxnorm__dose_forms", "model.sagerx.stg_rxnorm__ingredients", "model.sagerx.stg_rxnorm__ingredient_component_links", "model.sagerx.stg_rxnorm__ingredient_components", "model.sagerx.stg_rxnorm__ingredient_strength_links", "model.sagerx.stg_rxnorm__ingredient_strengths", "model.sagerx.stg_rxnorm__precise_ingredient_links", "model.sagerx.stg_rxnorm__precise_ingredients"]}, "compiled_path": "target/compiled/sagerx/models/intermediate/rxnorm/int_rxnorm_clinical_products_to_ingredient_strengths.sql", "compiled": true, "compiled_code": "-- int_rxnorm_clinical_products_to_ingredient_strengths.sql\n\nwith\n\nrcp as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__clinical_products\"\n\n),\n\nrcpcl as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__clinical_product_component_links\"\n\n),\n\nrcpc as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__clinical_product_components\"\n\n),\n\nrdf as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__dose_forms\"\n\n),\n\nri as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__ingredients\"\n\n),\n\nricl as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__ingredient_component_links\"\n\n),\n\nric as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__ingredient_components\"\n\n),\n\nrisl as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__ingredient_strength_links\"\n\n),\n\nris as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__ingredient_strengths\"\n\n),\n\npinl as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__precise_ingredient_links\"\n\n),\n\npin as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__precise_ingredients\"\n\n)\n\nselect\n    rcp.rxcui as clinical_product_rxcui\n    , rcp.name as clinical_product_name\n    , rcp.tty as clinical_product_tty\n    , rcpc.rxcui as clinical_product_component_rxcui\n    , rcpc.name as clinical_product_compnent_name\n    , rcpc.tty as clinical_product_component_tty\n    , rdf.rxcui as dose_form_rxcui\n    , rdf.name as dose_form_name\n    , rdf.tty as dose_form_tty\n    , ri.rxcui as ingredient_rxcui\n    , ri.name as ingredient_name\n    , ri.tty as ingredient_tty\n    , ric.rxcui as ingredient_component_rxcui\n    , ric.name as ingredient_component_name\n    , ric.tty as ingredient_component_tty\n    , ris.rxcui as ingredient_strength_rxcui\n    , ris.name as ingredient_strength_name\n    , ris.numerator_value as strength_numerator_value\n    , ris.numerator_unit as strength_numerator_unit\n    , ris.denominator_value as strength_denominator_value\n    , ris.denominator_unit as strength_denominator_unit\n    , ris.text as strength_text\n    , pin.rxcui as precise_ingredient_rxcui\n    , pin.name as precise_ingredient_name\n    , pin.tty as precise_ingredient_tty\n    , rcp.active\n    , rcp.prescribable\nfrom rcp \nleft join rcpcl \n    on rcp.rxcui = rcpcl.clinical_product_rxcui \nleft join rcpc \n    on rcpcl.clinical_product_component_rxcui = rcpc.rxcui \nleft join rdf \n    on rcpc.dose_form_rxcui = rdf.rxcui \nleft join ri \n    on rcpc.ingredient_rxcui = ri.rxcui \nleft join ricl \n    on ri.rxcui = ricl.ingredient_rxcui \nleft join ric \n    on ricl.ingredient_component_rxcui = ric.rxcui \nleft join risl \n    on rcpc.rxcui = risl.clinical_product_component_rxcui \n    and ric.rxcui = risl.ingredient_component_rxcui \nleft join ris \n    on risl.ingredient_strength_rxcui = ris.rxcui\nleft join pinl\n    on ris.rxcui = pinl.ingredient_strength_rxcui\nleft join pin\n    on pinl.precise_ingredient_rxcui = pin.rxcui", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.int_rxnorm_clinical_products_to_ingredient_components": {"database": "sagerx", "schema": "intermediate", "name": "int_rxnorm_clinical_products_to_ingredient_components", "resource_type": "model", "package_name": "sagerx", "path": "intermediate/rxnorm/int_rxnorm_clinical_products_to_ingredient_components.sql", "original_file_path": "models/intermediate/rxnorm/int_rxnorm_clinical_products_to_ingredient_components.sql", "unique_id": "model.sagerx.int_rxnorm_clinical_products_to_ingredient_components", "fqn": ["sagerx", "intermediate", "rxnorm", "int_rxnorm_clinical_products_to_ingredient_components"], "alias": "int_rxnorm_clinical_products_to_ingredient_components", "checksum": {"name": "sha256", "checksum": "e3f42f6afb7a05488305fcb8226126b009a4f4ee064685505be72b3cfdca865a"}, "config": {"enabled": true, "alias": null, "schema": "intermediate", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "RxNorm clinical products to ingredient components.", "columns": {"clinical_product_rxcui": {"name": "clinical_product_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_name": {"name": "clinical_product_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_tty": {"name": "clinical_product_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_component_rxcui": {"name": "clinical_product_component_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_compnent_name": {"name": "clinical_product_compnent_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_component_tty": {"name": "clinical_product_component_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "dose_form_rxcui": {"name": "dose_form_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "dose_form_name": {"name": "dose_form_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "dose_form_tty": {"name": "dose_form_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ingredient_rxcui": {"name": "ingredient_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ingredient_name": {"name": "ingredient_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ingredient_tty": {"name": "ingredient_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ingredient_component_rxcui": {"name": "ingredient_component_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ingredient_component_name": {"name": "ingredient_component_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ingredient_component_tty": {"name": "ingredient_component_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active": {"name": "active", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "prescribable": {"name": "prescribable", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/intermediate/rxnorm/_int_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate", "materialized": "table"}, "created_at": 1703192135.03619, "relation_name": "\"sagerx\".\"intermediate\".\"int_rxnorm_clinical_products_to_ingredient_components\"", "raw_code": "-- int_rxnorm_clinical_products_to_ingredient_components.sql\n\nwith\n\nrcp as (\n\n    select * from {{ ref('stg_rxnorm__clinical_products') }}\n\n),\n\nrcpcl as (\n\n    select * from {{ ref('stg_rxnorm__clinical_product_component_links') }}\n\n),\n\nrcpc as (\n\n    select * from {{ ref('stg_rxnorm__clinical_product_components') }}\n\n),\n\nrdf as (\n\n    select * from {{ ref('stg_rxnorm__dose_forms') }}\n\n),\n\nri as (\n\n    select * from {{ ref('stg_rxnorm__ingredients') }}\n\n),\n\nricl as (\n\n    select * from {{ ref('stg_rxnorm__ingredient_component_links') }}\n\n),\n\nric as (\n\n    select * from {{ ref('stg_rxnorm__ingredient_components') }}\n\n)\n\nselect\n    rcp.rxcui as clinical_product_rxcui\n    , rcp.name as clinical_product_name\n    , rcp.tty as clinical_product_tty\n    , rcpc.rxcui as clinical_product_component_rxcui\n    , rcpc.name as clinical_product_component_name\n    , rcpc.tty as clinical_product_component_tty\n    , rdf.rxcui as dose_form_rxcui\n    , rdf.name as dose_form_name\n    , rdf.tty as dose_form_tty\n    , ri.rxcui as ingredient_rxcui\n    , ri.name as ingredient_name\n    , ri.tty as ingredient_tty\n    , ric.rxcui as ingredient_component_rxcui\n    , ric.name as ingredient_component_name\n    , ric.tty as ingredient_component_tty\n    , rcp.active\n    , rcp.prescribable\nfrom rcp \nleft join rcpcl \n    on rcp.rxcui = rcpcl.clinical_product_rxcui \nleft join rcpc \n    on rcpcl.clinical_product_component_rxcui = rcpc.rxcui \nleft join rdf \n    on rcpc.dose_form_rxcui = rdf.rxcui \nleft join ri \n    on rcpc.ingredient_rxcui = ri.rxcui \nleft join ricl \n    on ri.rxcui = ricl.ingredient_rxcui \nleft join ric \n    on ricl.ingredient_component_rxcui = ric.rxcui", "language": "sql", "refs": [{"name": "stg_rxnorm__clinical_products", "package": null, "version": null}, {"name": "stg_rxnorm__clinical_product_component_links", "package": null, "version": null}, {"name": "stg_rxnorm__clinical_product_components", "package": null, "version": null}, {"name": "stg_rxnorm__dose_forms", "package": null, "version": null}, {"name": "stg_rxnorm__ingredients", "package": null, "version": null}, {"name": "stg_rxnorm__ingredient_component_links", "package": null, "version": null}, {"name": "stg_rxnorm__ingredient_components", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.sagerx.stg_rxnorm__clinical_products", "model.sagerx.stg_rxnorm__clinical_product_component_links", "model.sagerx.stg_rxnorm__clinical_product_components", "model.sagerx.stg_rxnorm__dose_forms", "model.sagerx.stg_rxnorm__ingredients", "model.sagerx.stg_rxnorm__ingredient_component_links", "model.sagerx.stg_rxnorm__ingredient_components"]}, "compiled_path": "target/compiled/sagerx/models/intermediate/rxnorm/int_rxnorm_clinical_products_to_ingredient_components.sql", "compiled": true, "compiled_code": "-- int_rxnorm_clinical_products_to_ingredient_components.sql\n\nwith\n\nrcp as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__clinical_products\"\n\n),\n\nrcpcl as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__clinical_product_component_links\"\n\n),\n\nrcpc as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__clinical_product_components\"\n\n),\n\nrdf as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__dose_forms\"\n\n),\n\nri as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__ingredients\"\n\n),\n\nricl as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__ingredient_component_links\"\n\n),\n\nric as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__ingredient_components\"\n\n)\n\nselect\n    rcp.rxcui as clinical_product_rxcui\n    , rcp.name as clinical_product_name\n    , rcp.tty as clinical_product_tty\n    , rcpc.rxcui as clinical_product_component_rxcui\n    , rcpc.name as clinical_product_component_name\n    , rcpc.tty as clinical_product_component_tty\n    , rdf.rxcui as dose_form_rxcui\n    , rdf.name as dose_form_name\n    , rdf.tty as dose_form_tty\n    , ri.rxcui as ingredient_rxcui\n    , ri.name as ingredient_name\n    , ri.tty as ingredient_tty\n    , ric.rxcui as ingredient_component_rxcui\n    , ric.name as ingredient_component_name\n    , ric.tty as ingredient_component_tty\n    , rcp.active\n    , rcp.prescribable\nfrom rcp \nleft join rcpcl \n    on rcp.rxcui = rcpcl.clinical_product_rxcui \nleft join rcpc \n    on rcpcl.clinical_product_component_rxcui = rcpc.rxcui \nleft join rdf \n    on rcpc.dose_form_rxcui = rdf.rxcui \nleft join ri \n    on rcpc.ingredient_rxcui = ri.rxcui \nleft join ricl \n    on ri.rxcui = ricl.ingredient_rxcui \nleft join ric \n    on ricl.ingredient_component_rxcui = ric.rxcui", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.int_rxnorm_all_ndcs_to_product_rxcuis": {"database": "sagerx", "schema": "intermediate", "name": "int_rxnorm_all_ndcs_to_product_rxcuis", "resource_type": "model", "package_name": "sagerx", "path": "intermediate/rxnorm/int_rxnorm_all_ndcs_to_product_rxcuis.sql", "original_file_path": "models/intermediate/rxnorm/int_rxnorm_all_ndcs_to_product_rxcuis.sql", "unique_id": "model.sagerx.int_rxnorm_all_ndcs_to_product_rxcuis", "fqn": ["sagerx", "intermediate", "rxnorm", "int_rxnorm_all_ndcs_to_product_rxcuis"], "alias": "int_rxnorm_all_ndcs_to_product_rxcuis", "checksum": {"name": "sha256", "checksum": "162cc8ae8935a0fd04f9bfa13339f383189dd49d0530c968fcd259a2768f1e40"}, "config": {"enabled": true, "alias": null, "schema": "intermediate", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate", "materialized": "table"}, "created_at": 1703192134.8571706, "relation_name": "\"sagerx\".\"intermediate\".\"int_rxnorm_all_ndcs_to_product_rxcuis\"", "raw_code": "with all_ndcs as\n(\n    select * from {{ ref('stg_rxnorm__all_ndcs') }}\n),\n\nproduct_rxcuis as\n(\n    select * from datasource.rxnorm_rxnconso\n    where sab = 'RXNORM'\n        and tty in ('SCD', 'SBD', 'GPCK', 'BPCK')\n)\n\nselect distinct\n    all_ndcs.ndc11\n    , product_rxcuis.rxcui\nfrom all_ndcs\ninner join product_rxcuis\n    on all_ndcs.rxcui = product_rxcuis.rxcui", "language": "sql", "refs": [{"name": "stg_rxnorm__all_ndcs", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.sagerx.stg_rxnorm__all_ndcs"]}, "compiled_path": "target/compiled/sagerx/models/intermediate/rxnorm/int_rxnorm_all_ndcs_to_product_rxcuis.sql", "compiled": true, "compiled_code": "with all_ndcs as\n(\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__all_ndcs\"\n),\n\nproduct_rxcuis as\n(\n    select * from datasource.rxnorm_rxnconso\n    where sab = 'RXNORM'\n        and tty in ('SCD', 'SBD', 'GPCK', 'BPCK')\n)\n\nselect distinct\n    all_ndcs.ndc11\n    , product_rxcuis.rxcui\nfrom all_ndcs\ninner join product_rxcuis\n    on all_ndcs.rxcui = product_rxcuis.rxcui", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.int_mthspl_products_to_active_moieties": {"database": "sagerx", "schema": "intermediate", "name": "int_mthspl_products_to_active_moieties", "resource_type": "model", "package_name": "sagerx", "path": "intermediate/rxnorm/int_mthspl_products_to_active_moieties.sql", "original_file_path": "models/intermediate/rxnorm/int_mthspl_products_to_active_moieties.sql", "unique_id": "model.sagerx.int_mthspl_products_to_active_moieties", "fqn": ["sagerx", "intermediate", "rxnorm", "int_mthspl_products_to_active_moieties"], "alias": "int_mthspl_products_to_active_moieties", "checksum": {"name": "sha256", "checksum": "e66043d39e7bfb773651a95cd569f4ab1a9f5e90b2bb45490a96d6f482e2e629"}, "config": {"enabled": true, "alias": null, "schema": "intermediate", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "NLM SPL products to active moieties.", "columns": {"ndc9": {"name": "ndc9", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ndc": {"name": "ndc", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "product_rxcui": {"name": "product_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "product_name": {"name": "product_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "product_tty": {"name": "product_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active_moiety_unii": {"name": "active_moiety_unii", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active_moiety_rxcui": {"name": "active_moiety_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active_moiety_name": {"name": "active_moiety_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active_moiety_tty": {"name": "active_moiety_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active": {"name": "active", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "prescribable": {"name": "prescribable", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/intermediate/rxnorm/_int_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate", "materialized": "table"}, "created_at": 1703192135.0111322, "relation_name": "\"sagerx\".\"intermediate\".\"int_mthspl_products_to_active_moieties\"", "raw_code": "-- int_mthspl_products_to_active_moieties.sql\n\nwith\n\nsubstance as (\n\n    select * from {{ ref('stg_rxnorm__mthspl_substances') }}\n\n),\n\nproduct as (\n\n    select * from {{ ref('stg_rxnorm__mthspl_products') }}\n\n)\n\nselect distinct\n    concat(lpad(split_part(product.ndc,'-', 1), 5, '0'), lpad(split_part(product.ndc,'-', 2), 4, '0')) as ndc9\n    , product.ndc as ndc\n    , product.rxcui as product_rxcui\n    , product.name as product_name\n    , product.tty as product_tty\n    , substance.unii as active_moiety_unii\n    , substance.rxcui as active_moiety_rxcui\n    , substance.name as active_moiety_name\n    , substance.tty as active_moiety_tty\t\n    , product.active as active\n    , product.prescribable as prescribable\nfrom datasource.rxnorm_rxnrel rxnrel\ninner join substance\n    on rxnrel.rxaui1 = substance.rxaui\ninner join product\n    on rxnrel.rxaui2 = product.rxaui\nwhere rela = 'has_active_moiety'", "language": "sql", "refs": [{"name": "stg_rxnorm__mthspl_substances", "package": null, "version": null}, {"name": "stg_rxnorm__mthspl_products", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.sagerx.stg_rxnorm__mthspl_substances", "model.sagerx.stg_rxnorm__mthspl_products"]}, "compiled_path": "target/compiled/sagerx/models/intermediate/rxnorm/int_mthspl_products_to_active_moieties.sql", "compiled": true, "compiled_code": "-- int_mthspl_products_to_active_moieties.sql\n\nwith\n\nsubstance as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__mthspl_substances\"\n\n),\n\nproduct as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__mthspl_products\"\n\n)\n\nselect distinct\n    concat(lpad(split_part(product.ndc,'-', 1), 5, '0'), lpad(split_part(product.ndc,'-', 2), 4, '0')) as ndc9\n    , product.ndc as ndc\n    , product.rxcui as product_rxcui\n    , product.name as product_name\n    , product.tty as product_tty\n    , substance.unii as active_moiety_unii\n    , substance.rxcui as active_moiety_rxcui\n    , substance.name as active_moiety_name\n    , substance.tty as active_moiety_tty\t\n    , product.active as active\n    , product.prescribable as prescribable\nfrom datasource.rxnorm_rxnrel rxnrel\ninner join substance\n    on rxnrel.rxaui1 = substance.rxaui\ninner join product\n    on rxnrel.rxaui2 = product.rxaui\nwhere rela = 'has_active_moiety'", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.int_mthspl_products_to_inactive_ingredients": {"database": "sagerx", "schema": "intermediate", "name": "int_mthspl_products_to_inactive_ingredients", "resource_type": "model", "package_name": "sagerx", "path": "intermediate/rxnorm/int_mthspl_products_to_inactive_ingredients.sql", "original_file_path": "models/intermediate/rxnorm/int_mthspl_products_to_inactive_ingredients.sql", "unique_id": "model.sagerx.int_mthspl_products_to_inactive_ingredients", "fqn": ["sagerx", "intermediate", "rxnorm", "int_mthspl_products_to_inactive_ingredients"], "alias": "int_mthspl_products_to_inactive_ingredients", "checksum": {"name": "sha256", "checksum": "5da6620dd180b6989e782ed7c6eb768741047b76a4b68666e01d4448af48f47c"}, "config": {"enabled": true, "alias": null, "schema": "intermediate", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "NLM SPL products to inactive ingredients.", "columns": {"ndc9": {"name": "ndc9", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ndc": {"name": "ndc", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "product_rxcui": {"name": "product_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "product_name": {"name": "product_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "product_tty": {"name": "product_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "inactive_ingredient_unii": {"name": "inactive_ingredient_unii", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "inactive_ingredient_rxcui": {"name": "inactive_ingredient_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "inactive_ingredient_name": {"name": "inactive_ingredient_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "inactive_ingredient_tty": {"name": "inactive_ingredient_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active": {"name": "active", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "prescribable": {"name": "prescribable", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/intermediate/rxnorm/_int_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate", "materialized": "table"}, "created_at": 1703192135.0073807, "relation_name": "\"sagerx\".\"intermediate\".\"int_mthspl_products_to_inactive_ingredients\"", "raw_code": "-- int_mthspl_products_to_inactive_ingredients.sql\n\nwith\n\nsubstance as (\n\n    select * from {{ ref('stg_rxnorm__mthspl_substances') }}\n\n),\n\nproduct as (\n\n    select * from {{ ref('stg_rxnorm__mthspl_products') }}\n\n)\n\nselect distinct\n    concat(lpad(split_part(product.ndc,'-', 1), 5, '0'), lpad(split_part(product.ndc,'-', 2), 4, '0')) as ndc9\n    , product.ndc as ndc\n    , product.rxcui as product_rxcui\n    , product.name as product_name\n    , product.tty as product_tty\n    , substance.unii as inactive_ingredient_unii\n    , substance.rxcui as inactive_ingredient_rxcui\n    , substance.name as inactive_ingredient_name\n    , substance.tty as inactive_ingredient_tty\t\n    , product.active as active\n    , product.prescribable as prescribable\nfrom datasource.rxnorm_rxnrel rxnrel\ninner join substance\n    on rxnrel.rxaui1 = substance.rxaui\ninner join product\n    on rxnrel.rxaui2 = product.rxaui\nwhere rela = 'has_inactive_ingredient'", "language": "sql", "refs": [{"name": "stg_rxnorm__mthspl_substances", "package": null, "version": null}, {"name": "stg_rxnorm__mthspl_products", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.sagerx.stg_rxnorm__mthspl_substances", "model.sagerx.stg_rxnorm__mthspl_products"]}, "compiled_path": "target/compiled/sagerx/models/intermediate/rxnorm/int_mthspl_products_to_inactive_ingredients.sql", "compiled": true, "compiled_code": "-- int_mthspl_products_to_inactive_ingredients.sql\n\nwith\n\nsubstance as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__mthspl_substances\"\n\n),\n\nproduct as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__mthspl_products\"\n\n)\n\nselect distinct\n    concat(lpad(split_part(product.ndc,'-', 1), 5, '0'), lpad(split_part(product.ndc,'-', 2), 4, '0')) as ndc9\n    , product.ndc as ndc\n    , product.rxcui as product_rxcui\n    , product.name as product_name\n    , product.tty as product_tty\n    , substance.unii as inactive_ingredient_unii\n    , substance.rxcui as inactive_ingredient_rxcui\n    , substance.name as inactive_ingredient_name\n    , substance.tty as inactive_ingredient_tty\t\n    , product.active as active\n    , product.prescribable as prescribable\nfrom datasource.rxnorm_rxnrel rxnrel\ninner join substance\n    on rxnrel.rxaui1 = substance.rxaui\ninner join product\n    on rxnrel.rxaui2 = product.rxaui\nwhere rela = 'has_inactive_ingredient'", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.int_rxnorm_clinical_products_to_ingredients": {"database": "sagerx", "schema": "intermediate", "name": "int_rxnorm_clinical_products_to_ingredients", "resource_type": "model", "package_name": "sagerx", "path": "intermediate/rxnorm/int_rxnorm_clinical_products_to_ingredients.sql", "original_file_path": "models/intermediate/rxnorm/int_rxnorm_clinical_products_to_ingredients.sql", "unique_id": "model.sagerx.int_rxnorm_clinical_products_to_ingredients", "fqn": ["sagerx", "intermediate", "rxnorm", "int_rxnorm_clinical_products_to_ingredients"], "alias": "int_rxnorm_clinical_products_to_ingredients", "checksum": {"name": "sha256", "checksum": "44e50556bee95d8f49a7173383ab0e9c0955de650e6450fe4964cb183587e3a1"}, "config": {"enabled": true, "alias": null, "schema": "intermediate", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "RxNorm clinical products to ingredients.", "columns": {"clinical_product_rxcui": {"name": "clinical_product_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_name": {"name": "clinical_product_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_tty": {"name": "clinical_product_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_component_rxcui": {"name": "clinical_product_component_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_compnent_name": {"name": "clinical_product_compnent_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_component_tty": {"name": "clinical_product_component_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "dose_form_rxcui": {"name": "dose_form_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "dose_form_name": {"name": "dose_form_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "dose_form_tty": {"name": "dose_form_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ingredient_rxcui": {"name": "ingredient_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ingredient_name": {"name": "ingredient_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ingredient_tty": {"name": "ingredient_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active": {"name": "active", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "prescribable": {"name": "prescribable", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/intermediate/rxnorm/_int_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate", "materialized": "table"}, "created_at": 1703192135.0306413, "relation_name": "\"sagerx\".\"intermediate\".\"int_rxnorm_clinical_products_to_ingredients\"", "raw_code": "-- int_rxnorm_clinical_products_to_ingredients.sql\n\nwith\n\nrcp as (\n\n    select * from {{ ref('stg_rxnorm__clinical_products') }}\n\n),\n\nrcpcl as (\n\n    select * from {{ ref('stg_rxnorm__clinical_product_component_links') }}\n\n),\n\nrcpc as (\n\n    select * from {{ ref('stg_rxnorm__clinical_product_components') }}\n\n),\n\nrdf as (\n\n    select * from {{ ref('stg_rxnorm__dose_forms') }}\n\n),\n\nri as (\n\n    select * from {{ ref('stg_rxnorm__ingredients') }}\n\n)\n\nselect\n    rcp.rxcui as clinical_product_rxcui\n    , rcp.name as clinical_product_name\n    , rcp.tty as clinical_product_tty\n    , rcpc.rxcui as clinical_product_component_rxcui\n    , rcpc.name as clinical_product_compnent_name\n    , rcpc.tty as clinical_product_component_tty\n    , rdf.rxcui as dose_form_rxcui\n    , rdf.name as dose_form_name\n    , rdf.tty as dose_form_tty\n    , ri.rxcui as ingredient_rxcui\n    , ri.name as ingredient_name\n    , ri.tty as ingredient_tty\n    , rcp.active\n    , rcp.prescribable        \nfrom rcp \nleft join rcpcl \n    on rcp.rxcui = rcpcl.clinical_product_rxcui \nleft join rcpc \n    on rcpcl.clinical_product_component_rxcui = rcpc.rxcui \nleft join rdf \n    on rcpc.dose_form_rxcui = rdf.rxcui \nleft join ri \n    on rcpc.ingredient_rxcui = ri.rxcui", "language": "sql", "refs": [{"name": "stg_rxnorm__clinical_products", "package": null, "version": null}, {"name": "stg_rxnorm__clinical_product_component_links", "package": null, "version": null}, {"name": "stg_rxnorm__clinical_product_components", "package": null, "version": null}, {"name": "stg_rxnorm__dose_forms", "package": null, "version": null}, {"name": "stg_rxnorm__ingredients", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.sagerx.stg_rxnorm__clinical_products", "model.sagerx.stg_rxnorm__clinical_product_component_links", "model.sagerx.stg_rxnorm__clinical_product_components", "model.sagerx.stg_rxnorm__dose_forms", "model.sagerx.stg_rxnorm__ingredients"]}, "compiled_path": "target/compiled/sagerx/models/intermediate/rxnorm/int_rxnorm_clinical_products_to_ingredients.sql", "compiled": true, "compiled_code": "-- int_rxnorm_clinical_products_to_ingredients.sql\n\nwith\n\nrcp as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__clinical_products\"\n\n),\n\nrcpcl as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__clinical_product_component_links\"\n\n),\n\nrcpc as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__clinical_product_components\"\n\n),\n\nrdf as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__dose_forms\"\n\n),\n\nri as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__ingredients\"\n\n)\n\nselect\n    rcp.rxcui as clinical_product_rxcui\n    , rcp.name as clinical_product_name\n    , rcp.tty as clinical_product_tty\n    , rcpc.rxcui as clinical_product_component_rxcui\n    , rcpc.name as clinical_product_compnent_name\n    , rcpc.tty as clinical_product_component_tty\n    , rdf.rxcui as dose_form_rxcui\n    , rdf.name as dose_form_name\n    , rdf.tty as dose_form_tty\n    , ri.rxcui as ingredient_rxcui\n    , ri.name as ingredient_name\n    , ri.tty as ingredient_tty\n    , rcp.active\n    , rcp.prescribable        \nfrom rcp \nleft join rcpcl \n    on rcp.rxcui = rcpcl.clinical_product_rxcui \nleft join rcpc \n    on rcpcl.clinical_product_component_rxcui = rcpc.rxcui \nleft join rdf \n    on rcpc.dose_form_rxcui = rdf.rxcui \nleft join ri \n    on rcpc.ingredient_rxcui = ri.rxcui", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.int_rxnorm_clinical_products_to_ndcs": {"database": "sagerx", "schema": "intermediate", "name": "int_rxnorm_clinical_products_to_ndcs", "resource_type": "model", "package_name": "sagerx", "path": "intermediate/rxnorm/int_rxnorm_clinical_products_to_ndcs.sql", "original_file_path": "models/intermediate/rxnorm/int_rxnorm_clinical_products_to_ndcs.sql", "unique_id": "model.sagerx.int_rxnorm_clinical_products_to_ndcs", "fqn": ["sagerx", "intermediate", "rxnorm", "int_rxnorm_clinical_products_to_ndcs"], "alias": "int_rxnorm_clinical_products_to_ndcs", "checksum": {"name": "sha256", "checksum": "6afce76f004dcf22b503c53fe2d8acabc46da926bd17e67ed984d0ce6c332f13"}, "config": {"enabled": true, "alias": null, "schema": "intermediate", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "RxNorm clinical products to NDCs.", "columns": {"clinical_product_rxcui": {"name": "clinical_product_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_name": {"name": "clinical_product_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_tty": {"name": "clinical_product_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_component_rxcui": {"name": "clinical_product_component_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_compnent_name": {"name": "clinical_product_compnent_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_component_tty": {"name": "clinical_product_component_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "dose_form_rxcui": {"name": "dose_form_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "dose_form_name": {"name": "dose_form_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "dose_form_tty": {"name": "dose_form_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ingredient_rxcui": {"name": "ingredient_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ingredient_name": {"name": "ingredient_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ingredient_tty": {"name": "ingredient_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "brand_product_rxcui": {"name": "brand_product_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ndc": {"name": "ndc", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active": {"name": "active", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "prescribable": {"name": "prescribable", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/intermediate/rxnorm/_int_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate", "materialized": "table"}, "created_at": 1703192135.0259247, "relation_name": "\"sagerx\".\"intermediate\".\"int_rxnorm_clinical_products_to_ndcs\"", "raw_code": "-- int_rxnorm_clinical_products_to_ndcs.sql\n\nwith\n\nrcp as (\n\n    select * from {{ ref('stg_rxnorm__clinical_products') }}\n\n),\n\nrcpcl as (\n\n    select * from {{ ref('stg_rxnorm__clinical_product_component_links') }}\n\n),\n\nrcpc as (\n\n    select * from {{ ref('stg_rxnorm__clinical_product_components') }}\n\n),\n\nrdf as (\n\n    select * from {{ ref('stg_rxnorm__dose_forms') }}\n\n),\n\nri as (\n\n    select * from {{ ref('stg_rxnorm__ingredients') }}\n\n),\n\nrn as (\n\n    select * from {{ ref('stg_rxnorm__ndcs') }}\n\n)\n\nselect\n    rcp.rxcui as clinical_product_rxcui\n    , rcp.name as clinical_product_name\n    , rcp.tty as clinical_product_tty\n    , rcpc.rxcui as clinical_product_component_rxcui\n    , rcpc.name as clinical_product_compnent_name\n    , rcpc.tty as clinical_product_component_tty\n    , rdf.rxcui as dose_form_rxcui\n    , rdf.name as dose_form_name\n    , rdf.tty as dose_form_tty\n    , ri.rxcui as ingredient_rxcui\n    , ri.name as ingredient_name\n    , ri.tty as ingredient_tty\n    , rn.brand_product_rxcui\n    , rn.ndc\n    , rcp.active\n    , rcp.prescribable\nfrom rcp \nleft join rcpcl \n    on rcp.rxcui = rcpcl.clinical_product_rxcui \nleft join rcpc \n    on rcpcl.clinical_product_component_rxcui = rcpc.rxcui \nleft join rdf \n    on rcpc.dose_form_rxcui = rdf.rxcui \nleft join ri \n    on rcpc.ingredient_rxcui = ri.rxcui \nleft join rn\n    on rcp.rxcui = rn.clinical_product_rxcui", "language": "sql", "refs": [{"name": "stg_rxnorm__clinical_products", "package": null, "version": null}, {"name": "stg_rxnorm__clinical_product_component_links", "package": null, "version": null}, {"name": "stg_rxnorm__clinical_product_components", "package": null, "version": null}, {"name": "stg_rxnorm__dose_forms", "package": null, "version": null}, {"name": "stg_rxnorm__ingredients", "package": null, "version": null}, {"name": "stg_rxnorm__ndcs", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.sagerx.stg_rxnorm__clinical_products", "model.sagerx.stg_rxnorm__clinical_product_component_links", "model.sagerx.stg_rxnorm__clinical_product_components", "model.sagerx.stg_rxnorm__dose_forms", "model.sagerx.stg_rxnorm__ingredients", "model.sagerx.stg_rxnorm__ndcs"]}, "compiled_path": "target/compiled/sagerx/models/intermediate/rxnorm/int_rxnorm_clinical_products_to_ndcs.sql", "compiled": true, "compiled_code": "-- int_rxnorm_clinical_products_to_ndcs.sql\n\nwith\n\nrcp as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__clinical_products\"\n\n),\n\nrcpcl as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__clinical_product_component_links\"\n\n),\n\nrcpc as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__clinical_product_components\"\n\n),\n\nrdf as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__dose_forms\"\n\n),\n\nri as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__ingredients\"\n\n),\n\nrn as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__ndcs\"\n\n)\n\nselect\n    rcp.rxcui as clinical_product_rxcui\n    , rcp.name as clinical_product_name\n    , rcp.tty as clinical_product_tty\n    , rcpc.rxcui as clinical_product_component_rxcui\n    , rcpc.name as clinical_product_compnent_name\n    , rcpc.tty as clinical_product_component_tty\n    , rdf.rxcui as dose_form_rxcui\n    , rdf.name as dose_form_name\n    , rdf.tty as dose_form_tty\n    , ri.rxcui as ingredient_rxcui\n    , ri.name as ingredient_name\n    , ri.tty as ingredient_tty\n    , rn.brand_product_rxcui\n    , rn.ndc\n    , rcp.active\n    , rcp.prescribable\nfrom rcp \nleft join rcpcl \n    on rcp.rxcui = rcpcl.clinical_product_rxcui \nleft join rcpc \n    on rcpcl.clinical_product_component_rxcui = rcpc.rxcui \nleft join rdf \n    on rcpc.dose_form_rxcui = rdf.rxcui \nleft join ri \n    on rcpc.ingredient_rxcui = ri.rxcui \nleft join rn\n    on rcp.rxcui = rn.clinical_product_rxcui", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.int_mthspl_products_to_active_ingredients": {"database": "sagerx", "schema": "intermediate", "name": "int_mthspl_products_to_active_ingredients", "resource_type": "model", "package_name": "sagerx", "path": "intermediate/rxnorm/int_mthspl_products_to_active_ingredients.sql", "original_file_path": "models/intermediate/rxnorm/int_mthspl_products_to_active_ingredients.sql", "unique_id": "model.sagerx.int_mthspl_products_to_active_ingredients", "fqn": ["sagerx", "intermediate", "rxnorm", "int_mthspl_products_to_active_ingredients"], "alias": "int_mthspl_products_to_active_ingredients", "checksum": {"name": "sha256", "checksum": "ff336cd7f98078c41d6119c3bb79c7cbafca2b7009ecc6e603f6567ec0b99ef0"}, "config": {"enabled": true, "alias": null, "schema": "intermediate", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "NLM SPL products to active ingredients.", "columns": {"ndc9": {"name": "ndc9", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ndc": {"name": "ndc", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "product_rxcui": {"name": "product_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "product_name": {"name": "product_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "product_tty": {"name": "product_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active_ingredient_unii": {"name": "active_ingredient_unii", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active_ingredient_rxcui": {"name": "active_ingredient_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active_ingredient_name": {"name": "active_ingredient_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active_ingredient_tty": {"name": "active_ingredient_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active": {"name": "active", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "prescribable": {"name": "prescribable", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/intermediate/rxnorm/_int_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate", "materialized": "table"}, "created_at": 1703192135.0033948, "relation_name": "\"sagerx\".\"intermediate\".\"int_mthspl_products_to_active_ingredients\"", "raw_code": "-- int_mthspl_products_to_active_ingredients.sql\n\nwith\n\nsubstance as (\n\n    select * from {{ ref('stg_rxnorm__mthspl_substances') }}\n\n),\n\nproduct as (\n\n    select * from {{ ref('stg_rxnorm__mthspl_products') }}\n\n)\n\nselect distinct\n    concat(lpad(split_part(product.ndc,'-', 1), 5, '0'), lpad(split_part(product.ndc,'-', 2), 4, '0')) as ndc9\n    , product.ndc as ndc\n    , product.rxcui as product_rxcui\n    , product.name as product_name\n    , product.tty as product_tty\n    , substance.unii as active_ingredient_unii\n    , substance.rxcui as active_ingredient_rxcui\n    , substance.name as active_ingredient_name\n    , substance.tty as active_ingredient_tty\t\n    , product.active as active\n    , product.prescribable as prescribable\nfrom datasource.rxnorm_rxnrel rxnrel\ninner join substance\n    on rxnrel.rxaui1 = substance.rxaui\ninner join product\n    on rxnrel.rxaui2 = product.rxaui\nwhere rela = 'has_active_ingredient'", "language": "sql", "refs": [{"name": "stg_rxnorm__mthspl_substances", "package": null, "version": null}, {"name": "stg_rxnorm__mthspl_products", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.sagerx.stg_rxnorm__mthspl_substances", "model.sagerx.stg_rxnorm__mthspl_products"]}, "compiled_path": "target/compiled/sagerx/models/intermediate/rxnorm/int_mthspl_products_to_active_ingredients.sql", "compiled": true, "compiled_code": "-- int_mthspl_products_to_active_ingredients.sql\n\nwith\n\nsubstance as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__mthspl_substances\"\n\n),\n\nproduct as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__mthspl_products\"\n\n)\n\nselect distinct\n    concat(lpad(split_part(product.ndc,'-', 1), 5, '0'), lpad(split_part(product.ndc,'-', 2), 4, '0')) as ndc9\n    , product.ndc as ndc\n    , product.rxcui as product_rxcui\n    , product.name as product_name\n    , product.tty as product_tty\n    , substance.unii as active_ingredient_unii\n    , substance.rxcui as active_ingredient_rxcui\n    , substance.name as active_ingredient_name\n    , substance.tty as active_ingredient_tty\t\n    , product.active as active\n    , product.prescribable as prescribable\nfrom datasource.rxnorm_rxnrel rxnrel\ninner join substance\n    on rxnrel.rxaui1 = substance.rxaui\ninner join product\n    on rxnrel.rxaui2 = product.rxaui\nwhere rela = 'has_active_ingredient'", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.int_rxnorm_clinical_products_to_clinical_product_components": {"database": "sagerx", "schema": "intermediate", "name": "int_rxnorm_clinical_products_to_clinical_product_components", "resource_type": "model", "package_name": "sagerx", "path": "intermediate/rxnorm/int_rxnorm_clinical_products_to_clinical_product_components.sql", "original_file_path": "models/intermediate/rxnorm/int_rxnorm_clinical_products_to_clinical_product_components.sql", "unique_id": "model.sagerx.int_rxnorm_clinical_products_to_clinical_product_components", "fqn": ["sagerx", "intermediate", "rxnorm", "int_rxnorm_clinical_products_to_clinical_product_components"], "alias": "int_rxnorm_clinical_products_to_clinical_product_components", "checksum": {"name": "sha256", "checksum": "7a88bc57ff6851c59b97538050210d668eaad6a0c2958d182cb37f7cad43b8c1"}, "config": {"enabled": true, "alias": null, "schema": "intermediate", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "RxNorm clinical products to clinical product components.", "columns": {"clinical_product_rxcui": {"name": "clinical_product_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_name": {"name": "clinical_product_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_tty": {"name": "clinical_product_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_component_rxcui": {"name": "clinical_product_component_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_compnent_name": {"name": "clinical_product_compnent_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_component_tty": {"name": "clinical_product_component_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active": {"name": "active", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "prescribable": {"name": "prescribable", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/intermediate/rxnorm/_int_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate", "materialized": "table"}, "created_at": 1703192135.0167265, "relation_name": "\"sagerx\".\"intermediate\".\"int_rxnorm_clinical_products_to_clinical_product_components\"", "raw_code": "-- int_rxnorm_clinical_products_to_clinical_product_components.sql\n\nwith\n\nndc as (\n\n    select * from {{ ref('stg_rxnorm__ndcs') }}\n\n),\n\nrcp as (\n\n    select * from {{ ref('stg_rxnorm__clinical_products') }}\n\n),\n\nrcpcl as (\n\n    select * from {{ ref('stg_rxnorm__clinical_product_component_links') }}\n\n),\n\nrcpc as (\n\n    select * from {{ ref('stg_rxnorm__clinical_product_components') }}\n\n)\n\nselect\n    rcp.rxcui as clinical_product_rxcui\n    , rcp.name as clinical_product_name\n    , rcp.tty as clinical_product_tty\n    , rcpc.rxcui as clinical_product_component_rxcui\n    , rcpc.name as clinical_product_compnent_name\n    , rcpc.tty as clinical_product_component_tty\n    , rcp.active\n    , rcp.prescribable\nfrom rcp \nleft join rcpcl \n    on rcp.rxcui = rcpcl.clinical_product_rxcui \nleft join rcpc \n    on rcpcl.clinical_product_component_rxcui = rcpc.rxcui", "language": "sql", "refs": [{"name": "stg_rxnorm__ndcs", "package": null, "version": null}, {"name": "stg_rxnorm__clinical_products", "package": null, "version": null}, {"name": "stg_rxnorm__clinical_product_component_links", "package": null, "version": null}, {"name": "stg_rxnorm__clinical_product_components", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.sagerx.stg_rxnorm__ndcs", "model.sagerx.stg_rxnorm__clinical_products", "model.sagerx.stg_rxnorm__clinical_product_component_links", "model.sagerx.stg_rxnorm__clinical_product_components"]}, "compiled_path": "target/compiled/sagerx/models/intermediate/rxnorm/int_rxnorm_clinical_products_to_clinical_product_components.sql", "compiled": true, "compiled_code": "-- int_rxnorm_clinical_products_to_clinical_product_components.sql\n\nwith\n\nndc as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__ndcs\"\n\n),\n\nrcp as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__clinical_products\"\n\n),\n\nrcpcl as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__clinical_product_component_links\"\n\n),\n\nrcpc as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__clinical_product_components\"\n\n)\n\nselect\n    rcp.rxcui as clinical_product_rxcui\n    , rcp.name as clinical_product_name\n    , rcp.tty as clinical_product_tty\n    , rcpc.rxcui as clinical_product_component_rxcui\n    , rcpc.name as clinical_product_compnent_name\n    , rcpc.tty as clinical_product_component_tty\n    , rcp.active\n    , rcp.prescribable\nfrom rcp \nleft join rcpcl \n    on rcp.rxcui = rcpcl.clinical_product_rxcui \nleft join rcpc \n    on rcpcl.clinical_product_component_rxcui = rcpc.rxcui", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.int_atc_codes_to_product_rxcuis": {"database": "sagerx", "schema": "intermediate", "name": "int_atc_codes_to_product_rxcuis", "resource_type": "model", "package_name": "sagerx", "path": "intermediate/rxnorm/int_atc_codes_to_product_rxcuis.sql", "original_file_path": "models/intermediate/rxnorm/int_atc_codes_to_product_rxcuis.sql", "unique_id": "model.sagerx.int_atc_codes_to_product_rxcuis", "fqn": ["sagerx", "intermediate", "rxnorm", "int_atc_codes_to_product_rxcuis"], "alias": "int_atc_codes_to_product_rxcuis", "checksum": {"name": "sha256", "checksum": "493b8426aeb00d9b19ef274b2e620ce269f65e90d729544aaa1a9807f257ffbc"}, "config": {"enabled": true, "alias": null, "schema": "intermediate", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate", "materialized": "table"}, "created_at": 1703192134.8797429, "relation_name": "\"sagerx\".\"intermediate\".\"int_atc_codes_to_product_rxcuis\"", "raw_code": "with atc_codes_to_products as (\n\tselect * from datasource.rxclass_atc_to_product\n),\n\natc_codes as (\n    select * from {{ ref('stg_rxnorm__atc_codes') }}\n)\n\nselect\n\tatc_codes.*\n\t, atc_codes_to_products.rxcui\nfrom atc_codes_to_products\nleft join atc_codes\n\ton atc_codes.atc_4_code = atc_codes_to_products.class_id\norder by\n\tatc_1_name\n\t, atc_2_name\n\t, atc_3_name\n\t, atc_4_name\n\t, atc_5_name", "language": "sql", "refs": [{"name": "stg_rxnorm__atc_codes", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.sagerx.stg_rxnorm__atc_codes"]}, "compiled_path": "target/compiled/sagerx/models/intermediate/rxnorm/int_atc_codes_to_product_rxcuis.sql", "compiled": true, "compiled_code": "with atc_codes_to_products as (\n\tselect * from datasource.rxclass_atc_to_product\n),\n\natc_codes as (\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__atc_codes\"\n)\n\nselect\n\tatc_codes.*\n\t, atc_codes_to_products.rxcui\nfrom atc_codes_to_products\nleft join atc_codes\n\ton atc_codes.atc_4_code = atc_codes_to_products.class_id\norder by\n\tatc_1_name\n\t, atc_2_name\n\t, atc_3_name\n\t, atc_4_name\n\t, atc_5_name", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.int_rxnorm_ndcs_to_products": {"database": "sagerx", "schema": "intermediate", "name": "int_rxnorm_ndcs_to_products", "resource_type": "model", "package_name": "sagerx", "path": "intermediate/rxnorm/int_rxnorm_ndcs_to_products.sql", "original_file_path": "models/intermediate/rxnorm/int_rxnorm_ndcs_to_products.sql", "unique_id": "model.sagerx.int_rxnorm_ndcs_to_products", "fqn": ["sagerx", "intermediate", "rxnorm", "int_rxnorm_ndcs_to_products"], "alias": "int_rxnorm_ndcs_to_products", "checksum": {"name": "sha256", "checksum": "44c827c46f0990ec5de8dcb49ab21baf7670212ba73d967a1f04baec60a49103"}, "config": {"enabled": true, "alias": null, "schema": "intermediate", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "RxNorm NDCs to products. Will return brand product if NDC is brand name, or generic product if NDC is generic.", "columns": {"ndc": {"name": "ndc", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "product_rxcui": {"name": "product_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "product_name": {"name": "product_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "product_tty": {"name": "product_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_rxcui": {"name": "clinical_product_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_name": {"name": "clinical_product_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_tty": {"name": "clinical_product_tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/intermediate/rxnorm/_int_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate", "materialized": "table"}, "created_at": 1703192135.013847, "relation_name": "\"sagerx\".\"intermediate\".\"int_rxnorm_ndcs_to_products\"", "raw_code": "-- int_rxnorm_ndcs_to_products.sql\n\nwith\n\nndc as (\n\n    select * from {{ ref('stg_rxnorm__ndcs') }}\n\n),\n\nrcp as (\n\n    select * from {{ ref('stg_rxnorm__clinical_products') }}\n\n),\n\nrbp as (\n\n    select * from {{ ref('stg_rxnorm__brand_products') }}\n\n)\n\nselect distinct\n    ndc\n    , coalesce(rbp.rxcui, rcp.rxcui, null) as product_rxcui\n    , coalesce(rbp.name, rcp.name, null) as product_name\n    , coalesce(rbp.tty, rcp.tty, null) as product_tty\n    , rcp.rxcui as clinical_product_rxcui\n    , rcp.name as clinical_product_name\n    , rcp.tty as clinical_product_tty\nfrom ndc\nleft join rcp \n    on ndc.clinical_product_rxcui = rcp.rxcui\nleft join rbp\n    on ndc.brand_product_rxcui = rbp.rxcui", "language": "sql", "refs": [{"name": "stg_rxnorm__ndcs", "package": null, "version": null}, {"name": "stg_rxnorm__clinical_products", "package": null, "version": null}, {"name": "stg_rxnorm__brand_products", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.sagerx.stg_rxnorm__ndcs", "model.sagerx.stg_rxnorm__clinical_products", "model.sagerx.stg_rxnorm__brand_products"]}, "compiled_path": "target/compiled/sagerx/models/intermediate/rxnorm/int_rxnorm_ndcs_to_products.sql", "compiled": true, "compiled_code": "-- int_rxnorm_ndcs_to_products.sql\n\nwith\n\nndc as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__ndcs\"\n\n),\n\nrcp as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__clinical_products\"\n\n),\n\nrbp as (\n\n    select * from \"sagerx\".\"staging\".\"stg_rxnorm__brand_products\"\n\n)\n\nselect distinct\n    ndc\n    , coalesce(rbp.rxcui, rcp.rxcui, null) as product_rxcui\n    , coalesce(rbp.name, rcp.name, null) as product_name\n    , coalesce(rbp.tty, rcp.tty, null) as product_tty\n    , rcp.rxcui as clinical_product_rxcui\n    , rcp.name as clinical_product_name\n    , rcp.tty as clinical_product_tty\nfrom ndc\nleft join rcp \n    on ndc.clinical_product_rxcui = rcp.rxcui\nleft join rbp\n    on ndc.brand_product_rxcui = rbp.rxcui", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.int_inactive_ingredients_to_fda_enforcement_reports": {"database": "sagerx", "schema": "intermediate", "name": "int_inactive_ingredients_to_fda_enforcement_reports", "resource_type": "model", "package_name": "sagerx", "path": "intermediate/fda_enforcement/int_inactive_ingredients_to_fda_enforcement_reports.sql", "original_file_path": "models/intermediate/fda_enforcement/int_inactive_ingredients_to_fda_enforcement_reports.sql", "unique_id": "model.sagerx.int_inactive_ingredients_to_fda_enforcement_reports", "fqn": ["sagerx", "intermediate", "fda_enforcement", "int_inactive_ingredients_to_fda_enforcement_reports"], "alias": "int_inactive_ingredients_to_fda_enforcement_reports", "checksum": {"name": "sha256", "checksum": "3c670bbddb5e377533a719b7e8dcb7068c5f07bfae2fcd9a081a74944c94ea4b"}, "config": {"enabled": true, "alias": null, "schema": "intermediate", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate", "materialized": "table"}, "created_at": 1703192134.8859067, "relation_name": "\"sagerx\".\"intermediate\".\"int_inactive_ingredients_to_fda_enforcement_reports\"", "raw_code": "with\n\nregex_ndcs as (\n\n    select * from {{ ref('stg_fda_enforcement__regex_ndcs') }}\n\n),\n\njson_ndcs as (\n\n    select * from {{ ref('stg_fda_enforcement__json_ndcs') }}\n\n),\n\nenf as (\n    -- UNION RegEx NDCs from description and JSON NDCs from OpenFDA column\n    -- NOTE: UNION removes duplicates by default, which is what we want here\n    select * from (\n        -- first get only the NDCs from combined RegEx and JSON enforcement report data\n        select \n            recall_number\n            , ndc11\n            , ndc9\n        from regex_ndcs\n        \n        union\n        \n        select\n            recall_number\n            , ndc11\n            , ndc9\n        from json_ndcs\n    ) enf_ndcs\n    -- then, join NDCs with application numbers, where they exist from JSON data\n    left join (\n        -- get distinct NDC11 -> application numbers so as to not blow up granularity\n        select\n            ndc11\n            , app_num\n        from json_ndcs\n        group by\n            ndc11\n            , app_num\n    ) json_app_num\n        on enf_ndcs.ndc11 = json_app_num.ndc11\n),\n\nndc as (\n\n    select * from {{ ref('int_rxnorm_ndcs_to_products') }}\n\n),\n\ning as (\n\n    select * from {{ ref('int_rxnorm_clinical_products_to_ingredients') }}\n\n),\n\nspl as (\n\n    select * from {{ ref('int_mthspl_products_to_inactive_ingredients') }}\n\n),\n\nfda as (\n\n    select * from {{ ref('stg_fda_ndc__ndc') }}\n\n)\n\nselect distinct\n    ndc.ndc as ndc11\n    , left(ndc.ndc, 9) as ndc9\n    , ndc.product_rxcui\n    , ndc.product_name\n    , ndc.product_tty\n    , ndc.clinical_product_rxcui\n    , ndc.clinical_product_name\n    , ndc.clinical_product_tty\n    , ing.ingredient_rxcui as active_ingredient_rxcui\n    , ing.ingredient_name as active_ingredient_name\n    , ing.ingredient_tty as active_ingredient_tty\n    -- if FDA NDC Directory has an application number, use that...\n    -- otherwise, use the application number from the enforcement report JSON\n    , coalesce(fda.applicationnumber, enf.app_num) as application_number\n    , fda.labelername as labeler\n    , enf.recall_number\n    , spl.inactive_ingredient_unii\n    , spl.inactive_ingredient_rxcui\n    , spl.inactive_ingredient_name\n    , spl.inactive_ingredient_tty\n-- RxNorm NDCs that have one of the ingredients in the WHERE clause\nfrom ndc\n-- clinical product and related active ingredients for each NDC\nleft join ing\n    on ing.clinical_product_rxcui = ndc.clinical_product_rxcui\n-- FDA enforcement reports (UNION of RegEx and JSON) joined on NDC9\nleft join enf\n    on enf.ndc9 = left(ndc.ndc, 9)\n-- DailyMed SPL inactive ingredients joined on NDC9\nleft join spl\n    on spl.ndc9 = left(ndc.ndc, 9)\n-- FDA NDC Directory joined on NDC11 to pull in application number\nleft join fda\n    on fda.ndc11 = ndc.ndc", "language": "sql", "refs": [{"name": "stg_fda_enforcement__regex_ndcs", "package": null, "version": null}, {"name": "stg_fda_enforcement__json_ndcs", "package": null, "version": null}, {"name": "int_rxnorm_ndcs_to_products", "package": null, "version": null}, {"name": "int_rxnorm_clinical_products_to_ingredients", "package": null, "version": null}, {"name": "int_mthspl_products_to_inactive_ingredients", "package": null, "version": null}, {"name": "stg_fda_ndc__ndc", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.sagerx.stg_fda_enforcement__regex_ndcs", "model.sagerx.stg_fda_enforcement__json_ndcs", "model.sagerx.int_rxnorm_ndcs_to_products", "model.sagerx.int_rxnorm_clinical_products_to_ingredients", "model.sagerx.int_mthspl_products_to_inactive_ingredients", "model.sagerx.stg_fda_ndc__ndc"]}, "compiled_path": "target/compiled/sagerx/models/intermediate/fda_enforcement/int_inactive_ingredients_to_fda_enforcement_reports.sql", "compiled": true, "compiled_code": "with\n\nregex_ndcs as (\n\n    select * from \"sagerx\".\"staging\".\"stg_fda_enforcement__regex_ndcs\"\n\n),\n\njson_ndcs as (\n\n    select * from \"sagerx\".\"staging\".\"stg_fda_enforcement__json_ndcs\"\n\n),\n\nenf as (\n    -- UNION RegEx NDCs from description and JSON NDCs from OpenFDA column\n    -- NOTE: UNION removes duplicates by default, which is what we want here\n    select * from (\n        -- first get only the NDCs from combined RegEx and JSON enforcement report data\n        select \n            recall_number\n            , ndc11\n            , ndc9\n        from regex_ndcs\n        \n        union\n        \n        select\n            recall_number\n            , ndc11\n            , ndc9\n        from json_ndcs\n    ) enf_ndcs\n    -- then, join NDCs with application numbers, where they exist from JSON data\n    left join (\n        -- get distinct NDC11 -> application numbers so as to not blow up granularity\n        select\n            ndc11\n            , app_num\n        from json_ndcs\n        group by\n            ndc11\n            , app_num\n    ) json_app_num\n        on enf_ndcs.ndc11 = json_app_num.ndc11\n),\n\nndc as (\n\n    select * from \"sagerx\".\"intermediate\".\"int_rxnorm_ndcs_to_products\"\n\n),\n\ning as (\n\n    select * from \"sagerx\".\"intermediate\".\"int_rxnorm_clinical_products_to_ingredients\"\n\n),\n\nspl as (\n\n    select * from \"sagerx\".\"intermediate\".\"int_mthspl_products_to_inactive_ingredients\"\n\n),\n\nfda as (\n\n    select * from \"sagerx\".\"staging\".\"stg_fda_ndc__ndc\"\n\n)\n\nselect distinct\n    ndc.ndc as ndc11\n    , left(ndc.ndc, 9) as ndc9\n    , ndc.product_rxcui\n    , ndc.product_name\n    , ndc.product_tty\n    , ndc.clinical_product_rxcui\n    , ndc.clinical_product_name\n    , ndc.clinical_product_tty\n    , ing.ingredient_rxcui as active_ingredient_rxcui\n    , ing.ingredient_name as active_ingredient_name\n    , ing.ingredient_tty as active_ingredient_tty\n    -- if FDA NDC Directory has an application number, use that...\n    -- otherwise, use the application number from the enforcement report JSON\n    , coalesce(fda.applicationnumber, enf.app_num) as application_number\n    , fda.labelername as labeler\n    , enf.recall_number\n    , spl.inactive_ingredient_unii\n    , spl.inactive_ingredient_rxcui\n    , spl.inactive_ingredient_name\n    , spl.inactive_ingredient_tty\n-- RxNorm NDCs that have one of the ingredients in the WHERE clause\nfrom ndc\n-- clinical product and related active ingredients for each NDC\nleft join ing\n    on ing.clinical_product_rxcui = ndc.clinical_product_rxcui\n-- FDA enforcement reports (UNION of RegEx and JSON) joined on NDC9\nleft join enf\n    on enf.ndc9 = left(ndc.ndc, 9)\n-- DailyMed SPL inactive ingredients joined on NDC9\nleft join spl\n    on spl.ndc9 = left(ndc.ndc, 9)\n-- FDA NDC Directory joined on NDC11 to pull in application number\nleft join fda\n    on fda.ndc11 = ndc.ndc", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_rxnorm__mthspl_ndcs": {"database": "sagerx", "schema": "staging", "name": "stg_rxnorm__mthspl_ndcs", "resource_type": "model", "package_name": "sagerx", "path": "staging/rxnorm/stg_rxnorm__mthspl_ndcs.sql", "original_file_path": "models/staging/rxnorm/stg_rxnorm__mthspl_ndcs.sql", "unique_id": "model.sagerx.stg_rxnorm__mthspl_ndcs", "fqn": ["sagerx", "staging", "rxnorm", "stg_rxnorm__mthspl_ndcs"], "alias": "stg_rxnorm__mthspl_ndcs", "checksum": {"name": "sha256", "checksum": "662f9fe71956067538d7633537af34487ab5b833c45c24b033dd6c1fda254bb9"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192134.8891318, "relation_name": "\"sagerx\".\"staging\".\"stg_rxnorm__mthspl_ndcs\"", "raw_code": "-- stg_rxnorm__mthspl_ndcs.sql\n\nselect\n    ndc_to_11(rxnsat.atv) as ndc11\n    , rxnsat.atv as ndc\n    , rxnsat.rxcui\n\t, case when rxnsat.suppress = 'N' then true else false end as active\n\t, case when rxnsat.cvf = '4096' then true else false end as prescribable\nfrom datasource.rxnorm_rxnsat rxnsat\n    where rxnsat.atn = 'NDC'\n        and rxnsat.sab = 'MTHSPL'", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/stg_rxnorm__mthspl_ndcs.sql", "compiled": true, "compiled_code": "-- stg_rxnorm__mthspl_ndcs.sql\n\nselect\n    ndc_to_11(rxnsat.atv) as ndc11\n    , rxnsat.atv as ndc\n    , rxnsat.rxcui\n\t, case when rxnsat.suppress = 'N' then true else false end as active\n\t, case when rxnsat.cvf = '4096' then true else false end as prescribable\nfrom datasource.rxnorm_rxnsat rxnsat\n    where rxnsat.atn = 'NDC'\n        and rxnsat.sab = 'MTHSPL'", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_rxnorm__dose_form_group_links": {"database": "sagerx", "schema": "staging", "name": "stg_rxnorm__dose_form_group_links", "resource_type": "model", "package_name": "sagerx", "path": "staging/rxnorm/stg_rxnorm__dose_form_group_links.sql", "original_file_path": "models/staging/rxnorm/stg_rxnorm__dose_form_group_links.sql", "unique_id": "model.sagerx.stg_rxnorm__dose_form_group_links", "fqn": ["sagerx", "staging", "rxnorm", "stg_rxnorm__dose_form_group_links"], "alias": "stg_rxnorm__dose_form_group_links", "checksum": {"name": "sha256", "checksum": "1ada7fc3c8ed26b33b957972e9fa84e62125cbb32e1d74ecb2d35c0446c48122"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "Links dose forms (DF) to dose form groups (DFG).", "columns": {"dose_form_rxcui": {"name": "dose_form_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "dose_form_group_rxcui": {"name": "dose_form_group_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/staging/rxnorm/_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192135.0550754, "relation_name": "\"sagerx\".\"staging\".\"stg_rxnorm__dose_form_group_links\"", "raw_code": "-- stg_rxnorm__dose_form_group_links.sql\n\nselect distinct\n\tdose_form.rxcui dose_form_rxcui\n\t, rxnrel.rxcui1 dose_form_group_rxcui\nfrom datasource.rxnorm_rxnconso dose_form\ninner join datasource.rxnorm_rxnrel rxnrel\n\ton rxnrel.rxcui2 = dose_form.rxcui\n\tand rxnrel.rela = 'isa'\n\tand rxnrel.sab = 'RXNORM'\nwhere dose_form.tty = 'DF'\n\tand dose_form.sab = 'RXNORM'", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/stg_rxnorm__dose_form_group_links.sql", "compiled": true, "compiled_code": "-- stg_rxnorm__dose_form_group_links.sql\n\nselect distinct\n\tdose_form.rxcui dose_form_rxcui\n\t, rxnrel.rxcui1 dose_form_group_rxcui\nfrom datasource.rxnorm_rxnconso dose_form\ninner join datasource.rxnorm_rxnrel rxnrel\n\ton rxnrel.rxcui2 = dose_form.rxcui\n\tand rxnrel.rela = 'isa'\n\tand rxnrel.sab = 'RXNORM'\nwhere dose_form.tty = 'DF'\n\tand dose_form.sab = 'RXNORM'", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_rxnorm__ingredients": {"database": "sagerx", "schema": "staging", "name": "stg_rxnorm__ingredients", "resource_type": "model", "package_name": "sagerx", "path": "staging/rxnorm/stg_rxnorm__ingredients.sql", "original_file_path": "models/staging/rxnorm/stg_rxnorm__ingredients.sql", "unique_id": "model.sagerx.stg_rxnorm__ingredients", "fqn": ["sagerx", "staging", "rxnorm", "stg_rxnorm__ingredients"], "alias": "stg_rxnorm__ingredients", "checksum": {"name": "sha256", "checksum": "615847ad960c2a0960e411ca37782c1d0a5e4ea0ca34b64c60f2006a15786532"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "RxNorm ingredients (IN/MIN).", "columns": {"rxcui": {"name": "rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "name": {"name": "name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "tty": {"name": "tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active": {"name": "active", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "prescribable": {"name": "prescribable", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/staging/rxnorm/_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192135.0592296, "relation_name": "\"sagerx\".\"staging\".\"stg_rxnorm__ingredients\"", "raw_code": "-- stg_rxnorm__ingredients.sql\n\nselect\n\tingredient.rxcui rxcui\n\t, ingredient.str name\n\t, ingredient.tty tty\n\t, case when ingredient.suppress = 'N' then true else false end as active\n\t, case when ingredient.cvf = '4096' then true else false end as prescribable\nfrom datasource.rxnorm_rxnconso ingredient\nwhere ingredient.tty in('IN', 'MIN')\n\tand ingredient.sab = 'RXNORM'", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/stg_rxnorm__ingredients.sql", "compiled": true, "compiled_code": "-- stg_rxnorm__ingredients.sql\n\nselect\n\tingredient.rxcui rxcui\n\t, ingredient.str name\n\t, ingredient.tty tty\n\t, case when ingredient.suppress = 'N' then true else false end as active\n\t, case when ingredient.cvf = '4096' then true else false end as prescribable\nfrom datasource.rxnorm_rxnconso ingredient\nwhere ingredient.tty in('IN', 'MIN')\n\tand ingredient.sab = 'RXNORM'", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_rxnorm__atc_codes": {"database": "sagerx", "schema": "staging", "name": "stg_rxnorm__atc_codes", "resource_type": "model", "package_name": "sagerx", "path": "staging/rxnorm/stg_rxnorm__atc_codes.sql", "original_file_path": "models/staging/rxnorm/stg_rxnorm__atc_codes.sql", "unique_id": "model.sagerx.stg_rxnorm__atc_codes", "fqn": ["sagerx", "staging", "rxnorm", "stg_rxnorm__atc_codes"], "alias": "stg_rxnorm__atc_codes", "checksum": {"name": "sha256", "checksum": "5ad452da40a3bb1909958c59adb2a60a907a3f4d980841e51a25e4fa32e856f5"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192134.898016, "relation_name": "\"sagerx\".\"staging\".\"stg_rxnorm__atc_codes\"", "raw_code": "with atc as (\n\tselect distinct a.rxcui\n\t\t,a.code\n\t\t,b.atn\n\t\t,b.atv as atc_class_level\n\t\t,a.str as description\n\t\t,a.sab\n\t\t,a.tty\n\tfrom (\n\t\tselect *\n\t\tfrom datasource.rxnorm_rxnconso\n\t\twhere sab = 'ATC'\n\t\tand tty not like 'RXN%'\n\t\torder by code\n\t) a\n\tleft join datasource.rxnorm_rxnsat b\n\t\ton a.code= b.code\n\twhere atn = 'ATC_LEVEL'\n\torder by code\n)\n\n, atc_5 as (\n\tselect\n\t\t*\n\tfrom atc\n\twhere atc_class_level = '5'\n)\n\n, atc_4 as (\n\tselect\n\t\t*\n\tfrom atc\n\twhere atc_class_level = '4'\n)\n\n, atc_3 as (\n\tselect\n\t\t*\n\tfrom atc\n\twhere atc_class_level = '3'\n)\n\n, atc_2 as (\n\tselect\n\t\t*\n\tfrom atc\n\twhere atc_class_level = '2'\n)\n\n, atc_1 as (\n\tselect\n\t\t*\n\tfrom atc\n\twhere atc_class_level = '1'\n)\n\n, sagerx_atc as (\n\nselect\n\tatc_1.code as atc_1_code\n\t, atc_1.description as atc_1_name\n\t, atc_2.code as atc_2_code\n\t, atc_2.description as atc_2_name\n\t, atc_3.code as atc_3_code\n\t, atc_3.description as atc_3_name\n\t, atc_4.code as atc_4_code\n\t, atc_4.description as atc_4_name\n\t, atc_5.code as atc_5_code\n\t, atc_5.description as atc_5_name\n\t, atc_5.rxcui as ingredient_rxcui\n\t, atc_5.description as ingredient_name\n\t, atc_5.tty as ingredient_tty\n\nfrom atc_5\nleft join atc_4\n\ton left(atc_5.code, 5) = atc_4.code\nleft join atc_3\n\ton left(atc_4.code, 4) = atc_3.code\nleft join atc_2\n\ton left(atc_3.code, 3) = atc_2.code\nleft join atc_1\n\ton left(atc_2.code, 1) = atc_1.code\n)\n\t\nselect * \nfrom sagerx_atc", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/stg_rxnorm__atc_codes.sql", "compiled": true, "compiled_code": "with atc as (\n\tselect distinct a.rxcui\n\t\t,a.code\n\t\t,b.atn\n\t\t,b.atv as atc_class_level\n\t\t,a.str as description\n\t\t,a.sab\n\t\t,a.tty\n\tfrom (\n\t\tselect *\n\t\tfrom datasource.rxnorm_rxnconso\n\t\twhere sab = 'ATC'\n\t\tand tty not like 'RXN%'\n\t\torder by code\n\t) a\n\tleft join datasource.rxnorm_rxnsat b\n\t\ton a.code= b.code\n\twhere atn = 'ATC_LEVEL'\n\torder by code\n)\n\n, atc_5 as (\n\tselect\n\t\t*\n\tfrom atc\n\twhere atc_class_level = '5'\n)\n\n, atc_4 as (\n\tselect\n\t\t*\n\tfrom atc\n\twhere atc_class_level = '4'\n)\n\n, atc_3 as (\n\tselect\n\t\t*\n\tfrom atc\n\twhere atc_class_level = '3'\n)\n\n, atc_2 as (\n\tselect\n\t\t*\n\tfrom atc\n\twhere atc_class_level = '2'\n)\n\n, atc_1 as (\n\tselect\n\t\t*\n\tfrom atc\n\twhere atc_class_level = '1'\n)\n\n, sagerx_atc as (\n\nselect\n\tatc_1.code as atc_1_code\n\t, atc_1.description as atc_1_name\n\t, atc_2.code as atc_2_code\n\t, atc_2.description as atc_2_name\n\t, atc_3.code as atc_3_code\n\t, atc_3.description as atc_3_name\n\t, atc_4.code as atc_4_code\n\t, atc_4.description as atc_4_name\n\t, atc_5.code as atc_5_code\n\t, atc_5.description as atc_5_name\n\t, atc_5.rxcui as ingredient_rxcui\n\t, atc_5.description as ingredient_name\n\t, atc_5.tty as ingredient_tty\n\nfrom atc_5\nleft join atc_4\n\ton left(atc_5.code, 5) = atc_4.code\nleft join atc_3\n\ton left(atc_4.code, 4) = atc_3.code\nleft join atc_2\n\ton left(atc_3.code, 3) = atc_2.code\nleft join atc_1\n\ton left(atc_2.code, 1) = atc_1.code\n)\n\t\nselect * \nfrom sagerx_atc", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_rxnorm__clinical_products": {"database": "sagerx", "schema": "staging", "name": "stg_rxnorm__clinical_products", "resource_type": "model", "package_name": "sagerx", "path": "staging/rxnorm/stg_rxnorm__clinical_products.sql", "original_file_path": "models/staging/rxnorm/stg_rxnorm__clinical_products.sql", "unique_id": "model.sagerx.stg_rxnorm__clinical_products", "fqn": ["sagerx", "staging", "rxnorm", "stg_rxnorm__clinical_products"], "alias": "stg_rxnorm__clinical_products", "checksum": {"name": "sha256", "checksum": "fe0926cf749195a3e3d2d02b52ee8fb3746b12511d1b12fa0d3a0dda04992d32"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "RxNorm clinical products (SCD, GPCK).", "columns": {"rxcui": {"name": "rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "name": {"name": "name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "tty": {"name": "tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active": {"name": "active", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "prescribable": {"name": "prescribable", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/staging/rxnorm/_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192135.0479937, "relation_name": "\"sagerx\".\"staging\".\"stg_rxnorm__clinical_products\"", "raw_code": "-- stg_rxnorm__clinical_products.sql\n\nselect\n\tproduct.rxcui as rxcui\n\t, product.str as name\n\t, product.tty as tty\n\t, case when product.suppress = 'N' then true else false end as active\n\t, case when product.cvf = '4096' then true else false end as prescribable\nfrom datasource.rxnorm_rxnconso product\nwhere product.tty in('SCD', 'GPCK')\n\tand product.sab = 'RXNORM'", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/stg_rxnorm__clinical_products.sql", "compiled": true, "compiled_code": "-- stg_rxnorm__clinical_products.sql\n\nselect\n\tproduct.rxcui as rxcui\n\t, product.str as name\n\t, product.tty as tty\n\t, case when product.suppress = 'N' then true else false end as active\n\t, case when product.cvf = '4096' then true else false end as prescribable\nfrom datasource.rxnorm_rxnconso product\nwhere product.tty in('SCD', 'GPCK')\n\tand product.sab = 'RXNORM'", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_rxnorm__ingredient_strengths": {"database": "sagerx", "schema": "staging", "name": "stg_rxnorm__ingredient_strengths", "resource_type": "model", "package_name": "sagerx", "path": "staging/rxnorm/stg_rxnorm__ingredient_strengths.sql", "original_file_path": "models/staging/rxnorm/stg_rxnorm__ingredient_strengths.sql", "unique_id": "model.sagerx.stg_rxnorm__ingredient_strengths", "fqn": ["sagerx", "staging", "rxnorm", "stg_rxnorm__ingredient_strengths"], "alias": "stg_rxnorm__ingredient_strengths", "checksum": {"name": "sha256", "checksum": "af9e9c70dfa2f57666c71193ff670b51d9f5dc9e2fad32497cf3b3e902118d90"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "RxNorm ingredient strengths.", "columns": {"rxcui": {"name": "rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "name": {"name": "name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "numerator_value": {"name": "numerator_value", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "numerator_unit": {"name": "numerator_unit", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "denominator_value": {"name": "denominator_value", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "denominator_unit": {"name": "denominator_unit", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "text": {"name": "text", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active": {"name": "active", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "prescribable": {"name": "prescribable", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/staging/rxnorm/_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192135.0675044, "relation_name": "\"sagerx\".\"staging\".\"stg_rxnorm__ingredient_strengths\"", "raw_code": "-- stg_rxnorm__ingredient_strengths.sql\n\nselect\n\tingredient_strength.rxcui as rxcui\n\t, ingredient_strength.str as name\n\t, numerator_value.atv as numerator_value\n\t, numerator_unit.atv as numerator_unit\n\t, denominator_value.atv as denominator_value\n\t, denominator_unit.atv as denominator_unit\n\t, text.atv as text\n\t, case when ingredient_strength.suppress = 'N'\n        then true\n        else false\n        end as active\n\t, case when ingredient_strength.cvf = '4096'\n        then true\n        else false\n        end as prescribable\nfrom datasource.rxnorm_rxnconso ingredient_strength\nleft join datasource.rxnorm_rxnsat numerator_value\n    on numerator_value.rxcui = ingredient_strength.rxcui\n    and numerator_value.atn = 'RXN_BOSS_STRENGTH_NUM_VALUE'\nleft join datasource.rxnorm_rxnsat numerator_unit\n    on numerator_unit.rxcui = ingredient_strength.rxcui\n    and numerator_unit.atn = 'RXN_BOSS_STRENGTH_NUM_UNIT'\nleft join datasource.rxnorm_rxnsat denominator_value\n    on denominator_value.rxcui = ingredient_strength.rxcui\n    and denominator_value.atn = 'RXN_BOSS_STRENGTH_DENOM_VALUE'\nleft join datasource.rxnorm_rxnsat denominator_unit\n    on denominator_unit.rxcui = ingredient_strength.rxcui\n    and denominator_unit.atn = 'RXN_BOSS_STRENGTH_DENOM_UNIT'\nleft join datasource.rxnorm_rxnsat text\n    on text.rxcui = ingredient_strength.rxcui\n    and text.atn = 'RXN_STRENGTH'\nwhere ingredient_strength.tty = 'SCDC'\n\tand ingredient_strength.sab = 'RXNORM'", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/stg_rxnorm__ingredient_strengths.sql", "compiled": true, "compiled_code": "-- stg_rxnorm__ingredient_strengths.sql\n\nselect\n\tingredient_strength.rxcui as rxcui\n\t, ingredient_strength.str as name\n\t, numerator_value.atv as numerator_value\n\t, numerator_unit.atv as numerator_unit\n\t, denominator_value.atv as denominator_value\n\t, denominator_unit.atv as denominator_unit\n\t, text.atv as text\n\t, case when ingredient_strength.suppress = 'N'\n        then true\n        else false\n        end as active\n\t, case when ingredient_strength.cvf = '4096'\n        then true\n        else false\n        end as prescribable\nfrom datasource.rxnorm_rxnconso ingredient_strength\nleft join datasource.rxnorm_rxnsat numerator_value\n    on numerator_value.rxcui = ingredient_strength.rxcui\n    and numerator_value.atn = 'RXN_BOSS_STRENGTH_NUM_VALUE'\nleft join datasource.rxnorm_rxnsat numerator_unit\n    on numerator_unit.rxcui = ingredient_strength.rxcui\n    and numerator_unit.atn = 'RXN_BOSS_STRENGTH_NUM_UNIT'\nleft join datasource.rxnorm_rxnsat denominator_value\n    on denominator_value.rxcui = ingredient_strength.rxcui\n    and denominator_value.atn = 'RXN_BOSS_STRENGTH_DENOM_VALUE'\nleft join datasource.rxnorm_rxnsat denominator_unit\n    on denominator_unit.rxcui = ingredient_strength.rxcui\n    and denominator_unit.atn = 'RXN_BOSS_STRENGTH_DENOM_UNIT'\nleft join datasource.rxnorm_rxnsat text\n    on text.rxcui = ingredient_strength.rxcui\n    and text.atn = 'RXN_STRENGTH'\nwhere ingredient_strength.tty = 'SCDC'\n\tand ingredient_strength.sab = 'RXNORM'", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_rxnorm__precise_ingredients": {"database": "sagerx", "schema": "staging", "name": "stg_rxnorm__precise_ingredients", "resource_type": "model", "package_name": "sagerx", "path": "staging/rxnorm/stg_rxnorm__precise_ingredients.sql", "original_file_path": "models/staging/rxnorm/stg_rxnorm__precise_ingredients.sql", "unique_id": "model.sagerx.stg_rxnorm__precise_ingredients", "fqn": ["sagerx", "staging", "rxnorm", "stg_rxnorm__precise_ingredients"], "alias": "stg_rxnorm__precise_ingredients", "checksum": {"name": "sha256", "checksum": "af6ea0b0bac5b10b11094d1bb6f1b8167fdd73b1d481b3b5a5be12ad9b31c871"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192134.9069624, "relation_name": "\"sagerx\".\"staging\".\"stg_rxnorm__precise_ingredients\"", "raw_code": "-- stg_rxnorm__precise_ingredients.sql\n\nselect\n\tingredient.rxcui rxcui\n\t, ingredient.str name\n\t, ingredient.tty tty\n\t, case when ingredient.suppress = 'N' then true else false end as active\n\t, case when ingredient.cvf = '4096' then true else false end as prescribable\nfrom datasource.rxnorm_rxnconso ingredient\nwhere ingredient.tty = 'PIN'\n\tand ingredient.sab = 'RXNORM'", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/stg_rxnorm__precise_ingredients.sql", "compiled": true, "compiled_code": "-- stg_rxnorm__precise_ingredients.sql\n\nselect\n\tingredient.rxcui rxcui\n\t, ingredient.str name\n\t, ingredient.tty tty\n\t, case when ingredient.suppress = 'N' then true else false end as active\n\t, case when ingredient.cvf = '4096' then true else false end as prescribable\nfrom datasource.rxnorm_rxnconso ingredient\nwhere ingredient.tty = 'PIN'\n\tand ingredient.sab = 'RXNORM'", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_rxnorm__brand_products": {"database": "sagerx", "schema": "staging", "name": "stg_rxnorm__brand_products", "resource_type": "model", "package_name": "sagerx", "path": "staging/rxnorm/stg_rxnorm__brand_products.sql", "original_file_path": "models/staging/rxnorm/stg_rxnorm__brand_products.sql", "unique_id": "model.sagerx.stg_rxnorm__brand_products", "fqn": ["sagerx", "staging", "rxnorm", "stg_rxnorm__brand_products"], "alias": "stg_rxnorm__brand_products", "checksum": {"name": "sha256", "checksum": "626684b05c41e7b42ce19b41bfc01faf3f5e44043d78ad7210e763f23934ffed"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "RxNorm brand name products (SBD/BPCK).", "columns": {"rxcui": {"name": "rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "name": {"name": "name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "tty": {"name": "tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_rxcui": {"name": "clinical_product_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active": {"name": "active", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "prescribable": {"name": "prescribable", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/staging/rxnorm/_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192135.075245, "relation_name": "\"sagerx\".\"staging\".\"stg_rxnorm__brand_products\"", "raw_code": "-- stg_rxnorm__brand_products.sql\n\nselect\n\tproduct.rxcui as rxcui\n\t, product.str as name\n\t, product.tty as tty\n\t, clinical_product.rxcui as clinical_product_rxcui\n\t, case when product.suppress = 'N' then true else false end as active\n\t, case when product.cvf = '4096' then true else false end as prescribable\nfrom datasource.rxnorm_rxnconso product\nleft join datasource.rxnorm_rxnrel rxnrel on rxnrel.rxcui2 = product.rxcui and rxnrel.rela = 'tradename_of'\nleft join datasource.rxnorm_rxnconso clinical_product\n\ton rxnrel.rxcui1 = clinical_product.rxcui\n\tand clinical_product.tty in ('SCD', 'GPCK')\n\tand clinical_product.sab = 'RXNORM'\nwhere product.tty in('SBD', 'BPCK')\n\tand product.sab = 'RXNORM'", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/stg_rxnorm__brand_products.sql", "compiled": true, "compiled_code": "-- stg_rxnorm__brand_products.sql\n\nselect\n\tproduct.rxcui as rxcui\n\t, product.str as name\n\t, product.tty as tty\n\t, clinical_product.rxcui as clinical_product_rxcui\n\t, case when product.suppress = 'N' then true else false end as active\n\t, case when product.cvf = '4096' then true else false end as prescribable\nfrom datasource.rxnorm_rxnconso product\nleft join datasource.rxnorm_rxnrel rxnrel on rxnrel.rxcui2 = product.rxcui and rxnrel.rela = 'tradename_of'\nleft join datasource.rxnorm_rxnconso clinical_product\n\ton rxnrel.rxcui1 = clinical_product.rxcui\n\tand clinical_product.tty in ('SCD', 'GPCK')\n\tand clinical_product.sab = 'RXNORM'\nwhere product.tty in('SBD', 'BPCK')\n\tand product.sab = 'RXNORM'", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_rxnorm__brands": {"database": "sagerx", "schema": "staging", "name": "stg_rxnorm__brands", "resource_type": "model", "package_name": "sagerx", "path": "staging/rxnorm/stg_rxnorm__brands.sql", "original_file_path": "models/staging/rxnorm/stg_rxnorm__brands.sql", "unique_id": "model.sagerx.stg_rxnorm__brands", "fqn": ["sagerx", "staging", "rxnorm", "stg_rxnorm__brands"], "alias": "stg_rxnorm__brands", "checksum": {"name": "sha256", "checksum": "bca430e820ceeaf886dc7b9248973ef39e847298411852fbb7bfbc4329f208e0"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "RxNorm brand names (BN).", "columns": {"rxcui": {"name": "rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "name": {"name": "name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "tty": {"name": "tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active": {"name": "active", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "prescribable": {"name": "prescribable", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ingredient_rxcui": {"name": "ingredient_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/staging/rxnorm/_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192135.0814981, "relation_name": "\"sagerx\".\"staging\".\"stg_rxnorm__brands\"", "raw_code": "-- stg_rxnorm__brands.sql\n\nwith cte as (\n\tselect\n\t\tsq.*\n\t\t, row_number() over(partition by rxcui order by ingredient_tty desc) as rn\n\tfrom (\n\n\t\tselect\n\t\t\tbrand.rxcui as rxcui\n\t\t\t, brand.str as name\n\t\t\t, brand.tty as tty\n\t\t\t, ingredient.rxcui as ingredient_rxcui\n\t\t\t, ingredient.str as ingredient_name\n\t\t\t, ingredient.tty as ingredient_tty\n\t\tfrom datasource.rxnorm_rxnconso brand\n\t\tinner join datasource.rxnorm_rxnrel rxnrel on rxnrel.rxcui2 = brand.rxcui and rxnrel.rela = 'tradename_of'\n\t\tinner join datasource.rxnorm_rxnconso ingredient\n\t\t\ton rxnrel.rxcui1 = ingredient.rxcui\n\t\t\tand ingredient.tty = 'IN'\n\t\t\tand ingredient.sab = 'RXNORM'\n\t\twhere brand.tty = 'BN'\n\t\t\tand brand.sab = 'RXNORM'\n\n\t\tunion all\n\n\t\tselect\n\t\t\tbrand.rxcui as rxcui\n\t\t\t, brand.str as name\n\t\t\t, brand.tty as tty\n\t\t\t, ingredient.rxcui as ingredient_rxcui\n\t\t\t, ingredient.str as ingredient_name\n\t\t\t, ingredient.tty as ingredient_tty\n\t\tfrom datasource.rxnorm_rxnconso brand\n\t\tinner join datasource.rxnorm_rxnrel sbd_rxnrel on sbd_rxnrel.rxcui2 = brand.rxcui and sbd_rxnrel.rela = 'ingredient_of'\n\t\tinner join datasource.rxnorm_rxnrel scd_rxnrel on scd_rxnrel.rxcui2 = sbd_rxnrel.rxcui1 and scd_rxnrel.rela = 'tradename_of'\n\t\tinner join datasource.rxnorm_rxnrel ingredient_rxnrel on ingredient_rxnrel.rxcui2 = scd_rxnrel.rxcui1 and ingredient_rxnrel.rela = 'has_ingredients'\n\t\tleft join datasource.rxnorm_rxnconso ingredient\n\t\t\ton ingredient_rxnrel.rxcui1 = ingredient.rxcui\n\t\t\tand ingredient.tty = 'MIN'\n\t\t\tand ingredient.sab = 'RXNORM'\t\t\n\t\twhere brand.tty = 'BN'\n\t\t\tand brand.sab = 'RXNORM'\n\t) sq\n)\n\nselect distinct\n\tbrand.rxcui as rxcui\n\t, brand.str as name\n\t, brand.tty as tty\n\t, case when brand.suppress = 'N' then true else false end as active\n\t, case when brand.cvf = '4096' then true else false end as prescribable\n\t, cte.ingredient_rxcui as ingredient_rxcui\nfrom datasource.rxnorm_rxnconso product\ninner join datasource.rxnorm_rxnrel rxnrel on rxnrel.rxcui2 = product.rxcui and rxnrel.rela = 'has_ingredient'\ninner join datasource.rxnorm_rxnconso brand\n\ton rxnrel.rxcui1 = brand.rxcui\n\tand brand.tty = 'BN'\n\tand brand.sab = 'RXNORM'\nLeft join cte on cte.rxcui = brand.rxcui and cte.rn < 2\nwhere product.tty = 'SBD'\n\tand product.sab = 'RXNORM'", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/stg_rxnorm__brands.sql", "compiled": true, "compiled_code": "-- stg_rxnorm__brands.sql\n\nwith cte as (\n\tselect\n\t\tsq.*\n\t\t, row_number() over(partition by rxcui order by ingredient_tty desc) as rn\n\tfrom (\n\n\t\tselect\n\t\t\tbrand.rxcui as rxcui\n\t\t\t, brand.str as name\n\t\t\t, brand.tty as tty\n\t\t\t, ingredient.rxcui as ingredient_rxcui\n\t\t\t, ingredient.str as ingredient_name\n\t\t\t, ingredient.tty as ingredient_tty\n\t\tfrom datasource.rxnorm_rxnconso brand\n\t\tinner join datasource.rxnorm_rxnrel rxnrel on rxnrel.rxcui2 = brand.rxcui and rxnrel.rela = 'tradename_of'\n\t\tinner join datasource.rxnorm_rxnconso ingredient\n\t\t\ton rxnrel.rxcui1 = ingredient.rxcui\n\t\t\tand ingredient.tty = 'IN'\n\t\t\tand ingredient.sab = 'RXNORM'\n\t\twhere brand.tty = 'BN'\n\t\t\tand brand.sab = 'RXNORM'\n\n\t\tunion all\n\n\t\tselect\n\t\t\tbrand.rxcui as rxcui\n\t\t\t, brand.str as name\n\t\t\t, brand.tty as tty\n\t\t\t, ingredient.rxcui as ingredient_rxcui\n\t\t\t, ingredient.str as ingredient_name\n\t\t\t, ingredient.tty as ingredient_tty\n\t\tfrom datasource.rxnorm_rxnconso brand\n\t\tinner join datasource.rxnorm_rxnrel sbd_rxnrel on sbd_rxnrel.rxcui2 = brand.rxcui and sbd_rxnrel.rela = 'ingredient_of'\n\t\tinner join datasource.rxnorm_rxnrel scd_rxnrel on scd_rxnrel.rxcui2 = sbd_rxnrel.rxcui1 and scd_rxnrel.rela = 'tradename_of'\n\t\tinner join datasource.rxnorm_rxnrel ingredient_rxnrel on ingredient_rxnrel.rxcui2 = scd_rxnrel.rxcui1 and ingredient_rxnrel.rela = 'has_ingredients'\n\t\tleft join datasource.rxnorm_rxnconso ingredient\n\t\t\ton ingredient_rxnrel.rxcui1 = ingredient.rxcui\n\t\t\tand ingredient.tty = 'MIN'\n\t\t\tand ingredient.sab = 'RXNORM'\t\t\n\t\twhere brand.tty = 'BN'\n\t\t\tand brand.sab = 'RXNORM'\n\t) sq\n)\n\nselect distinct\n\tbrand.rxcui as rxcui\n\t, brand.str as name\n\t, brand.tty as tty\n\t, case when brand.suppress = 'N' then true else false end as active\n\t, case when brand.cvf = '4096' then true else false end as prescribable\n\t, cte.ingredient_rxcui as ingredient_rxcui\nfrom datasource.rxnorm_rxnconso product\ninner join datasource.rxnorm_rxnrel rxnrel on rxnrel.rxcui2 = product.rxcui and rxnrel.rela = 'has_ingredient'\ninner join datasource.rxnorm_rxnconso brand\n\ton rxnrel.rxcui1 = brand.rxcui\n\tand brand.tty = 'BN'\n\tand brand.sab = 'RXNORM'\nLeft join cte on cte.rxcui = brand.rxcui and cte.rn < 2\nwhere product.tty = 'SBD'\n\tand product.sab = 'RXNORM'", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_rxnorm__mthspl_products": {"database": "sagerx", "schema": "staging", "name": "stg_rxnorm__mthspl_products", "resource_type": "model", "package_name": "sagerx", "path": "staging/rxnorm/stg_rxnorm__mthspl_products.sql", "original_file_path": "models/staging/rxnorm/stg_rxnorm__mthspl_products.sql", "unique_id": "model.sagerx.stg_rxnorm__mthspl_products", "fqn": ["sagerx", "staging", "rxnorm", "stg_rxnorm__mthspl_products"], "alias": "stg_rxnorm__mthspl_products", "checksum": {"name": "sha256", "checksum": "1cf7f4f0b00cdc62a089a5c30f6717243b4b69cdd3a21efdd4c33aaa818303c3"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "DailyMed SPL products (DP) at NDC9 level.", "columns": {"rxcui": {"name": "rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "name": {"name": "name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "tty": {"name": "tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "rxaui": {"name": "rxaui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ndc": {"name": "ndc", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active": {"name": "active", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "prescribable": {"name": "prescribable", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/staging/rxnorm/_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192135.0702205, "relation_name": "\"sagerx\".\"staging\".\"stg_rxnorm__mthspl_products\"", "raw_code": "-- stg_rxnorm__mthspl_products.sql\n\nselect\n\tproduct.rxcui as rxcui\n\t, product.str as name\n\t, product.tty as tty\n\t, product.rxaui as rxaui\n\t, product.code as ndc\n\t, case when product.suppress = 'N' then true else false end as active\n\t, case when product.cvf = '4096' then true else false end as prescribable\nfrom datasource.rxnorm_rxnconso product\nwhere product.tty = 'DP'\n\tand product.sab = 'MTHSPL'", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/stg_rxnorm__mthspl_products.sql", "compiled": true, "compiled_code": "-- stg_rxnorm__mthspl_products.sql\n\nselect\n\tproduct.rxcui as rxcui\n\t, product.str as name\n\t, product.tty as tty\n\t, product.rxaui as rxaui\n\t, product.code as ndc\n\t, case when product.suppress = 'N' then true else false end as active\n\t, case when product.cvf = '4096' then true else false end as prescribable\nfrom datasource.rxnorm_rxnconso product\nwhere product.tty = 'DP'\n\tand product.sab = 'MTHSPL'", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_rxnorm__mthspl_substances": {"database": "sagerx", "schema": "staging", "name": "stg_rxnorm__mthspl_substances", "resource_type": "model", "package_name": "sagerx", "path": "staging/rxnorm/stg_rxnorm__mthspl_substances.sql", "original_file_path": "models/staging/rxnorm/stg_rxnorm__mthspl_substances.sql", "unique_id": "model.sagerx.stg_rxnorm__mthspl_substances", "fqn": ["sagerx", "staging", "rxnorm", "stg_rxnorm__mthspl_substances"], "alias": "stg_rxnorm__mthspl_substances", "checksum": {"name": "sha256", "checksum": "ac9bcd6103df70ac35252620e69e5888c7cbe0a5d89b657e255ff533489e050d"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "DailyMed SPL substances (SU).", "columns": {"rxcui": {"name": "rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "name": {"name": "name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "tty": {"name": "tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "rxaui": {"name": "rxaui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "unii": {"name": "unii", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active": {"name": "active", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "prescribable": {"name": "prescribable", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/staging/rxnorm/_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192135.0728095, "relation_name": "\"sagerx\".\"staging\".\"stg_rxnorm__mthspl_substances\"", "raw_code": "-- stg_rxnorm__mthspl_substances.sql\n\nselect\n\tsubstance.rxcui rxcui\n\t, substance.str name\n\t, substance.tty tty\n\t, substance.rxaui rxaui\n\t, substance.code unii\n\t, case when substance.suppress = 'N' then true else false end as active\n\t, case when substance.cvf = '4096' then true else false end as prescribable\nfrom datasource.rxnorm_rxnconso substance\nwhere substance.tty = 'SU'\n\tand substance.sab = 'MTHSPL'", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/stg_rxnorm__mthspl_substances.sql", "compiled": true, "compiled_code": "-- stg_rxnorm__mthspl_substances.sql\n\nselect\n\tsubstance.rxcui rxcui\n\t, substance.str name\n\t, substance.tty tty\n\t, substance.rxaui rxaui\n\t, substance.code unii\n\t, case when substance.suppress = 'N' then true else false end as active\n\t, case when substance.cvf = '4096' then true else false end as prescribable\nfrom datasource.rxnorm_rxnconso substance\nwhere substance.tty = 'SU'\n\tand substance.sab = 'MTHSPL'", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_rxnorm__ingredient_strength_links": {"database": "sagerx", "schema": "staging", "name": "stg_rxnorm__ingredient_strength_links", "resource_type": "model", "package_name": "sagerx", "path": "staging/rxnorm/stg_rxnorm__ingredient_strength_links.sql", "original_file_path": "models/staging/rxnorm/stg_rxnorm__ingredient_strength_links.sql", "unique_id": "model.sagerx.stg_rxnorm__ingredient_strength_links", "fqn": ["sagerx", "staging", "rxnorm", "stg_rxnorm__ingredient_strength_links"], "alias": "stg_rxnorm__ingredient_strength_links", "checksum": {"name": "sha256", "checksum": "bda3bcbb78702d6975c6f425169d39e6de5d3da8ab6ccffab4f3f1d9c9f3f8dd"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "Links combination of clinical product components (SCD) + ingredient components (IN) to ingredient strengths.", "columns": {"clinical_product_component_rxcui": {"name": "clinical_product_component_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ingredient_component_rxcui": {"name": "ingredient_component_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ingredient_strength_rxcui": {"name": "ingredient_strength_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/staging/rxnorm/_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192135.0643399, "relation_name": "\"sagerx\".\"staging\".\"stg_rxnorm__ingredient_strength_links\"", "raw_code": "-- stg_rxnorm__ingredient_strength_links.sql\n\nselect distinct\n\tproduct_component.rxcui as clinical_product_component_rxcui\n\t, ingredient.rxcui as ingredient_component_rxcui\n\t, ingredient_strength.rxcui as ingredient_strength_rxcui\nfrom datasource.rxnorm_rxnconso ingredient_strength\ninner join datasource.rxnorm_rxnrel has_ingredient\n    on has_ingredient.rxcui2 = ingredient_strength.rxcui\n    and has_ingredient.rela = 'has_ingredient'\ninner join datasource.rxnorm_rxnconso ingredient\n\ton ingredient.rxcui = has_ingredient.rxcui1\n\tand ingredient.tty = 'IN'\n\tand ingredient.sab = 'RXNORM'\ninner join datasource.rxnorm_rxnrel constitutes\n    on constitutes.rxcui2 = ingredient_strength.rxcui\n    and constitutes.rela = 'constitutes'\ninner join datasource.rxnorm_rxnconso product_component\n\ton product_component.rxcui = constitutes.rxcui1\n\tand product_component.tty = 'SCD'\n\tand product_component.sab = 'RXNORM'\nwhere ingredient_strength.tty = 'SCDC'\n\tand ingredient_strength.sab = 'RXNORM'", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/stg_rxnorm__ingredient_strength_links.sql", "compiled": true, "compiled_code": "-- stg_rxnorm__ingredient_strength_links.sql\n\nselect distinct\n\tproduct_component.rxcui as clinical_product_component_rxcui\n\t, ingredient.rxcui as ingredient_component_rxcui\n\t, ingredient_strength.rxcui as ingredient_strength_rxcui\nfrom datasource.rxnorm_rxnconso ingredient_strength\ninner join datasource.rxnorm_rxnrel has_ingredient\n    on has_ingredient.rxcui2 = ingredient_strength.rxcui\n    and has_ingredient.rela = 'has_ingredient'\ninner join datasource.rxnorm_rxnconso ingredient\n\ton ingredient.rxcui = has_ingredient.rxcui1\n\tand ingredient.tty = 'IN'\n\tand ingredient.sab = 'RXNORM'\ninner join datasource.rxnorm_rxnrel constitutes\n    on constitutes.rxcui2 = ingredient_strength.rxcui\n    and constitutes.rela = 'constitutes'\ninner join datasource.rxnorm_rxnconso product_component\n\ton product_component.rxcui = constitutes.rxcui1\n\tand product_component.tty = 'SCD'\n\tand product_component.sab = 'RXNORM'\nwhere ingredient_strength.tty = 'SCDC'\n\tand ingredient_strength.sab = 'RXNORM'", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_rxnorm__clinical_product_components": {"database": "sagerx", "schema": "staging", "name": "stg_rxnorm__clinical_product_components", "resource_type": "model", "package_name": "sagerx", "path": "staging/rxnorm/stg_rxnorm__clinical_product_components.sql", "original_file_path": "models/staging/rxnorm/stg_rxnorm__clinical_product_components.sql", "unique_id": "model.sagerx.stg_rxnorm__clinical_product_components", "fqn": ["sagerx", "staging", "rxnorm", "stg_rxnorm__clinical_product_components"], "alias": "stg_rxnorm__clinical_product_components", "checksum": {"name": "sha256", "checksum": "14f85f00449b3654b515945507e8c3a8cab478ae84dfd30fb7f78757a4919c97"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "RxNorm clinical product components (SCD).", "columns": {"rxcui": {"name": "rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "name": {"name": "name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "tty": {"name": "tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active": {"name": "active", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "prescribable": {"name": "prescribable", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ingredient_rxcui": {"name": "ingredient_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "dose_form_rxcui": {"name": "dose_form_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/staging/rxnorm/_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192135.0518909, "relation_name": "\"sagerx\".\"staging\".\"stg_rxnorm__clinical_product_components\"", "raw_code": "-- stg_rxnorm__clinical_product_components.sql\n\nwith cte as (\n\tselect\n\tsq.*,\n\trow_number() over(partition by product_component_rxcui order by ingredient_tty desc) as rn\n\tfrom (\n\t\tselect\n\t\t\tproduct_component.rxcui as product_component_rxcui\n\t\t\t, product_component.str as product_component_name\n\t\t\t, product_component.tty as product_component_tty\n\t\t\t, ingredient.rxcui as ingredient_rxcui\n\t\t\t, ingredient.str as ingredient_name\n\t\t\t, ingredient.tty as ingredient_tty\n\t\tfrom datasource.rxnorm_rxnconso product_component\n\t\tinner join datasource.rxnorm_rxnrel rxnrel on rxnrel.rxcui2 = product_component.rxcui and rxnrel.rela = 'has_ingredients'\n\t\tinner join datasource.rxnorm_rxnconso ingredient\n\t\t\ton rxnrel.rxcui1 = ingredient.rxcui\n\t\t\tand ingredient.tty = 'MIN'\n\t\t\tand ingredient.sab = 'RXNORM'\n\t\twhere product_component.tty = 'SCD'\n\t\t\tand product_component.sab = 'RXNORM'\n\n\t\tunion all\n\n\t\tselect\n\t\t\tproduct_component.rxcui as product_component_rxcui\n\t\t\t, product_component.str as product_component_name\n\t\t\t, product_component.tty as product_component_tty\n\t\t\t, ingredient.rxcui as ingredient_rxcui\n\t\t\t, ingredient.str as ingredient_name\n\t\t\t, ingredient.tty as ingredient_tty\n\t\tfrom datasource.rxnorm_rxnconso product_component\n\t\tinner join datasource.rxnorm_rxnrel scdc_rxnrel on scdc_rxnrel.rxcui2 = product_component.rxcui and scdc_rxnrel.rela = 'consists_of'\n\t\tinner join datasource.rxnorm_rxnconso scdc on scdc_rxnrel.rxcui1 = scdc.rxcui\n\t\tinner join datasource.rxnorm_rxnrel ingredient_rxnrel on ingredient_rxnrel.rxcui2 = scdc.rxcui and ingredient_rxnrel.rela = 'has_ingredient'\n\t\tinner join datasource.rxnorm_rxnconso ingredient\n\t\t\ton ingredient_rxnrel.rxcui1 = ingredient.rxcui\n\t\t\tand ingredient.tty = 'IN'\n\t\t\tand ingredient.sab = 'RXNORM'\n\t\twhere product_component.tty = 'SCD'\n\t\t\tand product_component.sab = 'RXNORM'\n\t) sq\n)\n\nselect distinct\n\tcase when product_component.rxcui is null then product.rxcui else product_component.rxcui end rxcui\n\t, case when product_component.str is null then product.str else product_component.str end name \n\t, case when product_component.tty is null then product.tty else product_component.tty end tty\n\t, case when \n\t\tcase when product_component.rxcui is null then product.suppress else product_component.suppress end = 'N' then true else false end as active\n\t, case when \n\t\tcase when product_component.rxcui is null then product.cvf else product_component.cvf end = '4096' then true else false end as prescribable\n\t, cte.ingredient_rxcui as ingredient_rxcui\n\t, dose_form_rxnrel.rxcui1 as dose_form_rxcui\nfrom datasource.rxnorm_rxnconso product\nleft join datasource.rxnorm_rxnrel rxnrel on rxnrel.rxcui2 = product.rxcui and rxnrel.rela = 'contains'\nleft join datasource.rxnorm_rxnconso product_component\n\ton rxnrel.rxcui1 = product_component.rxcui\n    and product_component.tty = 'SCD'\n    and product_component.sab = 'RXNORM'\nleft join cte \n\ton cte.product_component_rxcui = case when product_component.rxcui is null then product.rxcui else product_component.rxcui end\n\tand cte.rn < 2\nleft join datasource.rxnorm_rxnrel dose_form_rxnrel\n\ton dose_form_rxnrel.rxcui2 = case when product_component.rxcui is null then product.rxcui else product_component.rxcui end\n\tand dose_form_rxnrel.rela = 'has_dose_form'\n\tand dose_form_rxnrel.sab = 'RXNORM'\nwhere product.tty in('SCD', 'GPCK')\n\tand product.sab = 'RXNORM'", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/stg_rxnorm__clinical_product_components.sql", "compiled": true, "compiled_code": "-- stg_rxnorm__clinical_product_components.sql\n\nwith cte as (\n\tselect\n\tsq.*,\n\trow_number() over(partition by product_component_rxcui order by ingredient_tty desc) as rn\n\tfrom (\n\t\tselect\n\t\t\tproduct_component.rxcui as product_component_rxcui\n\t\t\t, product_component.str as product_component_name\n\t\t\t, product_component.tty as product_component_tty\n\t\t\t, ingredient.rxcui as ingredient_rxcui\n\t\t\t, ingredient.str as ingredient_name\n\t\t\t, ingredient.tty as ingredient_tty\n\t\tfrom datasource.rxnorm_rxnconso product_component\n\t\tinner join datasource.rxnorm_rxnrel rxnrel on rxnrel.rxcui2 = product_component.rxcui and rxnrel.rela = 'has_ingredients'\n\t\tinner join datasource.rxnorm_rxnconso ingredient\n\t\t\ton rxnrel.rxcui1 = ingredient.rxcui\n\t\t\tand ingredient.tty = 'MIN'\n\t\t\tand ingredient.sab = 'RXNORM'\n\t\twhere product_component.tty = 'SCD'\n\t\t\tand product_component.sab = 'RXNORM'\n\n\t\tunion all\n\n\t\tselect\n\t\t\tproduct_component.rxcui as product_component_rxcui\n\t\t\t, product_component.str as product_component_name\n\t\t\t, product_component.tty as product_component_tty\n\t\t\t, ingredient.rxcui as ingredient_rxcui\n\t\t\t, ingredient.str as ingredient_name\n\t\t\t, ingredient.tty as ingredient_tty\n\t\tfrom datasource.rxnorm_rxnconso product_component\n\t\tinner join datasource.rxnorm_rxnrel scdc_rxnrel on scdc_rxnrel.rxcui2 = product_component.rxcui and scdc_rxnrel.rela = 'consists_of'\n\t\tinner join datasource.rxnorm_rxnconso scdc on scdc_rxnrel.rxcui1 = scdc.rxcui\n\t\tinner join datasource.rxnorm_rxnrel ingredient_rxnrel on ingredient_rxnrel.rxcui2 = scdc.rxcui and ingredient_rxnrel.rela = 'has_ingredient'\n\t\tinner join datasource.rxnorm_rxnconso ingredient\n\t\t\ton ingredient_rxnrel.rxcui1 = ingredient.rxcui\n\t\t\tand ingredient.tty = 'IN'\n\t\t\tand ingredient.sab = 'RXNORM'\n\t\twhere product_component.tty = 'SCD'\n\t\t\tand product_component.sab = 'RXNORM'\n\t) sq\n)\n\nselect distinct\n\tcase when product_component.rxcui is null then product.rxcui else product_component.rxcui end rxcui\n\t, case when product_component.str is null then product.str else product_component.str end name \n\t, case when product_component.tty is null then product.tty else product_component.tty end tty\n\t, case when \n\t\tcase when product_component.rxcui is null then product.suppress else product_component.suppress end = 'N' then true else false end as active\n\t, case when \n\t\tcase when product_component.rxcui is null then product.cvf else product_component.cvf end = '4096' then true else false end as prescribable\n\t, cte.ingredient_rxcui as ingredient_rxcui\n\t, dose_form_rxnrel.rxcui1 as dose_form_rxcui\nfrom datasource.rxnorm_rxnconso product\nleft join datasource.rxnorm_rxnrel rxnrel on rxnrel.rxcui2 = product.rxcui and rxnrel.rela = 'contains'\nleft join datasource.rxnorm_rxnconso product_component\n\ton rxnrel.rxcui1 = product_component.rxcui\n    and product_component.tty = 'SCD'\n    and product_component.sab = 'RXNORM'\nleft join cte \n\ton cte.product_component_rxcui = case when product_component.rxcui is null then product.rxcui else product_component.rxcui end\n\tand cte.rn < 2\nleft join datasource.rxnorm_rxnrel dose_form_rxnrel\n\ton dose_form_rxnrel.rxcui2 = case when product_component.rxcui is null then product.rxcui else product_component.rxcui end\n\tand dose_form_rxnrel.rela = 'has_dose_form'\n\tand dose_form_rxnrel.sab = 'RXNORM'\nwhere product.tty in('SCD', 'GPCK')\n\tand product.sab = 'RXNORM'", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_rxnorm__clinical_product_component_links": {"database": "sagerx", "schema": "staging", "name": "stg_rxnorm__clinical_product_component_links", "resource_type": "model", "package_name": "sagerx", "path": "staging/rxnorm/stg_rxnorm__clinical_product_component_links.sql", "original_file_path": "models/staging/rxnorm/stg_rxnorm__clinical_product_component_links.sql", "unique_id": "model.sagerx.stg_rxnorm__clinical_product_component_links", "fqn": ["sagerx", "staging", "rxnorm", "stg_rxnorm__clinical_product_component_links"], "alias": "stg_rxnorm__clinical_product_component_links", "checksum": {"name": "sha256", "checksum": "fb3f015fba01b4b330d3b8e34595f18ad811bc611ac5becfae8a1e10ade08ad3"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "Links clinical products (SCD/GPCK) with clinical product components (SCD only).", "columns": {"clinical_product_rxcui": {"name": "clinical_product_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_component_rxcui": {"name": "clinical_product_component_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/staging/rxnorm/_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192135.0491579, "relation_name": "\"sagerx\".\"staging\".\"stg_rxnorm__clinical_product_component_links\"", "raw_code": "-- stg_rxnorm__clinical_product_component_links.sql\n\nselect distinct\n\tproduct.rxcui as clinical_product_rxcui\n\t, case when product_component.rxcui is null\n        then product.rxcui \n        else product_component.rxcui \n        end as clinical_product_component_rxcui\nfrom datasource.rxnorm_rxnconso product\nleft join datasource.rxnorm_rxnrel rxnrel on rxnrel.rxcui2 = product.rxcui and rxnrel.rela = 'contains'\nleft join datasource.rxnorm_rxnconso product_component\n    on rxnrel.rxcui1 = product_component.rxcui\n    and product_component.tty = 'SCD'\n    and product_component.sab = 'RXNORM'\nwhere product.tty in('SCD', 'GPCK')\n\tand product.sab = 'RXNORM'", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/stg_rxnorm__clinical_product_component_links.sql", "compiled": true, "compiled_code": "-- stg_rxnorm__clinical_product_component_links.sql\n\nselect distinct\n\tproduct.rxcui as clinical_product_rxcui\n\t, case when product_component.rxcui is null\n        then product.rxcui \n        else product_component.rxcui \n        end as clinical_product_component_rxcui\nfrom datasource.rxnorm_rxnconso product\nleft join datasource.rxnorm_rxnrel rxnrel on rxnrel.rxcui2 = product.rxcui and rxnrel.rela = 'contains'\nleft join datasource.rxnorm_rxnconso product_component\n    on rxnrel.rxcui1 = product_component.rxcui\n    and product_component.tty = 'SCD'\n    and product_component.sab = 'RXNORM'\nwhere product.tty in('SCD', 'GPCK')\n\tand product.sab = 'RXNORM'", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_rxnorm__brand_product_component_links": {"database": "sagerx", "schema": "staging", "name": "stg_rxnorm__brand_product_component_links", "resource_type": "model", "package_name": "sagerx", "path": "staging/rxnorm/stg_rxnorm__brand_product_component_links.sql", "original_file_path": "models/staging/rxnorm/stg_rxnorm__brand_product_component_links.sql", "unique_id": "model.sagerx.stg_rxnorm__brand_product_component_links", "fqn": ["sagerx", "staging", "rxnorm", "stg_rxnorm__brand_product_component_links"], "alias": "stg_rxnorm__brand_product_component_links", "checksum": {"name": "sha256", "checksum": "5c0d3aebd82d21e4bf4ce934793e786b0c4c51283f3aa620ff8bdd6b39268bfd"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "Links brand products (SBD/BPCK) with brand product components (mostly SBD, but BPCKs can also contain SCD).", "columns": {"brand_product_rxcui": {"name": "brand_product_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "brand_product_component_rxcui": {"name": "brand_product_component_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/staging/rxnorm/_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192135.0764077, "relation_name": "\"sagerx\".\"staging\".\"stg_rxnorm__brand_product_component_links\"", "raw_code": "-- stg_rxnorm__brand_product_component_links.sql\n\nselect distinct\n\tproduct.rxcui as brand_product_rxcui\n\t, case when product_component.rxcui is null\n        then product.rxcui\n        else product_component.rxcui\n        end as brand_product_component_rxcui\nfrom datasource.rxnorm_rxnconso product\nleft join datasource.rxnorm_rxnrel rxnrel on rxnrel.rxcui2 = product.rxcui and rxnrel.rela = 'contains'\nleft join datasource.rxnorm_rxnconso product_component\n\ton rxnrel.rxcui1 = product_component.rxcui\n\tand product_component.tty in ('SBD', 'SCD') -- NOTE: BPCKs can contain SBDs AND SCDs\n\tand product_component.sab = 'RXNORM'\nwhere product.tty in ('SBD', 'BPCK')\n\tand product.sab = 'RXNORM'", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/stg_rxnorm__brand_product_component_links.sql", "compiled": true, "compiled_code": "-- stg_rxnorm__brand_product_component_links.sql\n\nselect distinct\n\tproduct.rxcui as brand_product_rxcui\n\t, case when product_component.rxcui is null\n        then product.rxcui\n        else product_component.rxcui\n        end as brand_product_component_rxcui\nfrom datasource.rxnorm_rxnconso product\nleft join datasource.rxnorm_rxnrel rxnrel on rxnrel.rxcui2 = product.rxcui and rxnrel.rela = 'contains'\nleft join datasource.rxnorm_rxnconso product_component\n\ton rxnrel.rxcui1 = product_component.rxcui\n\tand product_component.tty in ('SBD', 'SCD') -- NOTE: BPCKs can contain SBDs AND SCDs\n\tand product_component.sab = 'RXNORM'\nwhere product.tty in ('SBD', 'BPCK')\n\tand product.sab = 'RXNORM'", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_rxnorm__ingredient_component_links": {"database": "sagerx", "schema": "staging", "name": "stg_rxnorm__ingredient_component_links", "resource_type": "model", "package_name": "sagerx", "path": "staging/rxnorm/stg_rxnorm__ingredient_component_links.sql", "original_file_path": "models/staging/rxnorm/stg_rxnorm__ingredient_component_links.sql", "unique_id": "model.sagerx.stg_rxnorm__ingredient_component_links", "fqn": ["sagerx", "staging", "rxnorm", "stg_rxnorm__ingredient_component_links"], "alias": "stg_rxnorm__ingredient_component_links", "checksum": {"name": "sha256", "checksum": "e7b8129438a1787d2409b3e0c8f44e1d8d20a7dd77faee7622dedab5e6b5455a"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "Links ingredients (IN/MIN) to ingredient components (IN).", "columns": {"ingredient_rxcui": {"name": "ingredient_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ingredient_component_rxcui": {"name": "ingredient_component_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/staging/rxnorm/_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192135.0603976, "relation_name": "\"sagerx\".\"staging\".\"stg_rxnorm__ingredient_component_links\"", "raw_code": "-- stg_rxnorm__ingredient_component_links.sql\n\nwith cte as (\n\tselect\n\t\trxnrel.rxcui2 as ingredient_rxcui\n\t\t, ingredient_component.rxcui as ingredient_component_rxcui\n\t\t, ingredient_component.str as ingredient_component_name\n\t\t, ingredient_component.tty as ingredient_component_tty\n\tfrom\n\t\tdatasource.rxnorm_rxnrel rxnrel\n\tinner join datasource.rxnorm_rxnconso ingredient_component\n\t\ton rxnrel.rxcui1 = ingredient_component.rxcui\n\twhere rxnrel.rela = 'has_part'\n\t\tand ingredient_component.tty = 'IN'\n\t\tand ingredient_component.sab = 'RXNORM'\n)\n\nselect distinct\n\tingredient.rxcui as ingredient_rxcui\n\t, case when cte.ingredient_component_rxcui is null\n        then ingredient.rxcui\n        else cte.ingredient_component_rxcui\n        end as ingredient_component_rxcui\nfrom datasource.rxnorm_rxnconso ingredient\nleft join cte on ingredient.rxcui = cte.ingredient_rxcui\nwhere ingredient.tty in('IN', 'MIN')\n\tand ingredient.sab = 'RXNORM'", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/stg_rxnorm__ingredient_component_links.sql", "compiled": true, "compiled_code": "-- stg_rxnorm__ingredient_component_links.sql\n\nwith cte as (\n\tselect\n\t\trxnrel.rxcui2 as ingredient_rxcui\n\t\t, ingredient_component.rxcui as ingredient_component_rxcui\n\t\t, ingredient_component.str as ingredient_component_name\n\t\t, ingredient_component.tty as ingredient_component_tty\n\tfrom\n\t\tdatasource.rxnorm_rxnrel rxnrel\n\tinner join datasource.rxnorm_rxnconso ingredient_component\n\t\ton rxnrel.rxcui1 = ingredient_component.rxcui\n\twhere rxnrel.rela = 'has_part'\n\t\tand ingredient_component.tty = 'IN'\n\t\tand ingredient_component.sab = 'RXNORM'\n)\n\nselect distinct\n\tingredient.rxcui as ingredient_rxcui\n\t, case when cte.ingredient_component_rxcui is null\n        then ingredient.rxcui\n        else cte.ingredient_component_rxcui\n        end as ingredient_component_rxcui\nfrom datasource.rxnorm_rxnconso ingredient\nleft join cte on ingredient.rxcui = cte.ingredient_rxcui\nwhere ingredient.tty in('IN', 'MIN')\n\tand ingredient.sab = 'RXNORM'", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_rxnorm__precise_ingredient_links": {"database": "sagerx", "schema": "staging", "name": "stg_rxnorm__precise_ingredient_links", "resource_type": "model", "package_name": "sagerx", "path": "staging/rxnorm/stg_rxnorm__precise_ingredient_links.sql", "original_file_path": "models/staging/rxnorm/stg_rxnorm__precise_ingredient_links.sql", "unique_id": "model.sagerx.stg_rxnorm__precise_ingredient_links", "fqn": ["sagerx", "staging", "rxnorm", "stg_rxnorm__precise_ingredient_links"], "alias": "stg_rxnorm__precise_ingredient_links", "checksum": {"name": "sha256", "checksum": "1ba2f03db7ba41e491880874310e3139599e3db5d0b25b5afc290e47c8a1959f"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192134.9370418, "relation_name": "\"sagerx\".\"staging\".\"stg_rxnorm__precise_ingredient_links\"", "raw_code": "-- stg_rxnorm__precise_ingredient_links.sql\n\nselect distinct\n\tingredient_strength.rxcui as ingredient_strength_rxcui\n\t, precise_ingredient.rxcui as precise_ingredient_rxcui\nfrom datasource.rxnorm_rxnconso precise_ingredient\ninner join datasource.rxnorm_rxnrel precise_ingredient_of\n    on precise_ingredient_of.rxcui2 = precise_ingredient.rxcui\n    and precise_ingredient_of.rela = 'precise_ingredient_of'\ninner join datasource.rxnorm_rxnconso ingredient_strength\n\ton ingredient_strength.rxcui = precise_ingredient_of.rxcui1\n\tand ingredient_strength.tty = 'SCDC'\n\tand ingredient_strength.sab = 'RXNORM'\nwhere precise_ingredient.tty = 'PIN'\n\tand precise_ingredient.sab = 'RXNORM'", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/stg_rxnorm__precise_ingredient_links.sql", "compiled": true, "compiled_code": "-- stg_rxnorm__precise_ingredient_links.sql\n\nselect distinct\n\tingredient_strength.rxcui as ingredient_strength_rxcui\n\t, precise_ingredient.rxcui as precise_ingredient_rxcui\nfrom datasource.rxnorm_rxnconso precise_ingredient\ninner join datasource.rxnorm_rxnrel precise_ingredient_of\n    on precise_ingredient_of.rxcui2 = precise_ingredient.rxcui\n    and precise_ingredient_of.rela = 'precise_ingredient_of'\ninner join datasource.rxnorm_rxnconso ingredient_strength\n\ton ingredient_strength.rxcui = precise_ingredient_of.rxcui1\n\tand ingredient_strength.tty = 'SCDC'\n\tand ingredient_strength.sab = 'RXNORM'\nwhere precise_ingredient.tty = 'PIN'\n\tand precise_ingredient.sab = 'RXNORM'", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_rxnorm__brand_product_components": {"database": "sagerx", "schema": "staging", "name": "stg_rxnorm__brand_product_components", "resource_type": "model", "package_name": "sagerx", "path": "staging/rxnorm/stg_rxnorm__brand_product_components.sql", "original_file_path": "models/staging/rxnorm/stg_rxnorm__brand_product_components.sql", "unique_id": "model.sagerx.stg_rxnorm__brand_product_components", "fqn": ["sagerx", "staging", "rxnorm", "stg_rxnorm__brand_product_components"], "alias": "stg_rxnorm__brand_product_components", "checksum": {"name": "sha256", "checksum": "8910a205b6e581cfacbea454b1ce79f2d5fcde61346c46e35bfdc6766d5352ed"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "RxNorm brand product components (mostly SBD, but BPCKs can also contain SCD).", "columns": {"rxcui": {"name": "rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "name": {"name": "name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "tty": {"name": "tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_component_rxcui": {"name": "clinical_product_component_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "brand_rxcui": {"name": "brand_rxcui", "description": "NOTE: brand_product_component SCDs will have NULL for brand_rxcui.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active": {"name": "active", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "prescribable": {"name": "prescribable", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/staging/rxnorm/_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192135.07905, "relation_name": "\"sagerx\".\"staging\".\"stg_rxnorm__brand_product_components\"", "raw_code": "-- stg_rxnorm__brand_product_components.sql\n\nselect distinct\n\tcase when product.tty = 'SBD' then product.rxcui else product_component.rxcui end rxcui\n\t, case when product.tty = 'SBD' then product.str else product_component.str end name\n\t, case when product.tty = 'SBD' then product.tty else product_component.tty end tty\n\t, case when product_component.tty = 'SCD' then product_component.rxcui else rxnrel_scd.rxcui1 end clinical_product_component_rxcui\n\t, rxnrel_bn.rxcui1 as brand_rxcui\n\t, case when \n            case when product.tty = 'SBD'\n            then product.suppress\n            else product_component.suppress\n            end = 'N' \n        then true \n        else false\n        end as active\n\t, case when \n            case when product.tty = 'SBD'\n            then product.cvf\n            else product_component.cvf \n            end = '4096' \n        then true\n        else false\n        end as prescribable\nfrom datasource.rxnorm_rxnconso product\nleft join datasource.rxnorm_rxnrel rxnrel on rxnrel.rxcui2 = product.rxcui and rxnrel.rela = 'contains'\nleft join datasource.rxnorm_rxnconso product_component\n\ton rxnrel.rxcui1 = product_component.rxcui\n\tand product_component.tty in ('SBD', 'SCD') -- NOTE: BPCKs can contain SBDs AND SCDs\n\tand product_component.sab = 'RXNORM'\nleft join datasource.rxnorm_rxnrel rxnrel_scd \n\ton rxnrel_scd.rxcui2 = case when product_component.rxcui is null then product.rxcui else product_component.rxcui end \n\tand rxnrel_scd.rela = 'tradename_of' -- rxnrel_scd.rxcui1 = clinical_product_component_rxcui\nleft join datasource.rxnorm_rxnrel rxnrel_bn \n\ton rxnrel_bn.rxcui2 = case when product_component.rxcui is null then product.rxcui else product_component.rxcui end \n\tand rxnrel_bn.rela = 'has_ingredient' -- rxnrel_bn.rxcui1 = brand_rxcui\nwhere product.tty in ('SBD', 'BPCK')\n\tand product.sab = 'RXNORM'", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/stg_rxnorm__brand_product_components.sql", "compiled": true, "compiled_code": "-- stg_rxnorm__brand_product_components.sql\n\nselect distinct\n\tcase when product.tty = 'SBD' then product.rxcui else product_component.rxcui end rxcui\n\t, case when product.tty = 'SBD' then product.str else product_component.str end name\n\t, case when product.tty = 'SBD' then product.tty else product_component.tty end tty\n\t, case when product_component.tty = 'SCD' then product_component.rxcui else rxnrel_scd.rxcui1 end clinical_product_component_rxcui\n\t, rxnrel_bn.rxcui1 as brand_rxcui\n\t, case when \n            case when product.tty = 'SBD'\n            then product.suppress\n            else product_component.suppress\n            end = 'N' \n        then true \n        else false\n        end as active\n\t, case when \n            case when product.tty = 'SBD'\n            then product.cvf\n            else product_component.cvf \n            end = '4096' \n        then true\n        else false\n        end as prescribable\nfrom datasource.rxnorm_rxnconso product\nleft join datasource.rxnorm_rxnrel rxnrel on rxnrel.rxcui2 = product.rxcui and rxnrel.rela = 'contains'\nleft join datasource.rxnorm_rxnconso product_component\n\ton rxnrel.rxcui1 = product_component.rxcui\n\tand product_component.tty in ('SBD', 'SCD') -- NOTE: BPCKs can contain SBDs AND SCDs\n\tand product_component.sab = 'RXNORM'\nleft join datasource.rxnorm_rxnrel rxnrel_scd \n\ton rxnrel_scd.rxcui2 = case when product_component.rxcui is null then product.rxcui else product_component.rxcui end \n\tand rxnrel_scd.rela = 'tradename_of' -- rxnrel_scd.rxcui1 = clinical_product_component_rxcui\nleft join datasource.rxnorm_rxnrel rxnrel_bn \n\ton rxnrel_bn.rxcui2 = case when product_component.rxcui is null then product.rxcui else product_component.rxcui end \n\tand rxnrel_bn.rela = 'has_ingredient' -- rxnrel_bn.rxcui1 = brand_rxcui\nwhere product.tty in ('SBD', 'BPCK')\n\tand product.sab = 'RXNORM'", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_rxnorm__ndcs": {"database": "sagerx", "schema": "staging", "name": "stg_rxnorm__ndcs", "resource_type": "model", "package_name": "sagerx", "path": "staging/rxnorm/stg_rxnorm__ndcs.sql", "original_file_path": "models/staging/rxnorm/stg_rxnorm__ndcs.sql", "unique_id": "model.sagerx.stg_rxnorm__ndcs", "fqn": ["sagerx", "staging", "rxnorm", "stg_rxnorm__ndcs"], "alias": "stg_rxnorm__ndcs", "checksum": {"name": "sha256", "checksum": "2e4fb49cca63aa3b542936b1767a1945bf87033d92890a67a8e843125d43de4f"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "RxNorm NDCs", "columns": {"ndc": {"name": "ndc", "description": "The NDC in NDC11 format.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "clinical_product_rxcui": {"name": "clinical_product_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "brand_product_rxcui": {"name": "brand_product_rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active": {"name": "active", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "prescribable": {"name": "prescribable", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/staging/rxnorm/_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192135.0459821, "relation_name": "\"sagerx\".\"staging\".\"stg_rxnorm__ndcs\"", "raw_code": "-- stg_rxnorm__ndcs.sql\n\nselect rxnsat.atv as ndc\n\t,case when product.tty in ('BPCK','SBD') then clinical_product.rxcui\n\t\telse rxnsat.rxcui end as clinical_product_rxcui\t\t\n\t,case when product.tty in ('BPCK','SBD') then rxnsat.rxcui\n\t\telse null end as brand_product_rxcui\n\t, case when rxnsat.suppress = 'N' then true else false end as active\n\t, case when rxnsat.cvf = '4096' then true else false end as prescribable\nfrom datasource.rxnorm_rxnsat rxnsat\n\tinner join datasource.rxnorm_rxnconso product on rxnsat.rxaui = product.rxaui\n\tleft join datasource.rxnorm_rxnrel rxnrel on rxnsat.rxcui = rxnrel.rxcui2 and rela = 'tradename_of' and product.tty in ('BPCK','SBD')\n\tleft join datasource.rxnorm_rxnconso clinical_product\n\t\ton rxnrel.rxcui1 = clinical_product.rxcui\n\t\tand clinical_product.tty in ('SCD','GPCK')\n\t\tand clinical_product.sab = 'RXNORM'\nwhere rxnsat.atn = 'NDC'\n\tand product.tty in ('SCD','SBD','GPCK','BPCK')\n\tand product.sab = 'RXNORM'", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/stg_rxnorm__ndcs.sql", "compiled": true, "compiled_code": "-- stg_rxnorm__ndcs.sql\n\nselect rxnsat.atv as ndc\n\t,case when product.tty in ('BPCK','SBD') then clinical_product.rxcui\n\t\telse rxnsat.rxcui end as clinical_product_rxcui\t\t\n\t,case when product.tty in ('BPCK','SBD') then rxnsat.rxcui\n\t\telse null end as brand_product_rxcui\n\t, case when rxnsat.suppress = 'N' then true else false end as active\n\t, case when rxnsat.cvf = '4096' then true else false end as prescribable\nfrom datasource.rxnorm_rxnsat rxnsat\n\tinner join datasource.rxnorm_rxnconso product on rxnsat.rxaui = product.rxaui\n\tleft join datasource.rxnorm_rxnrel rxnrel on rxnsat.rxcui = rxnrel.rxcui2 and rela = 'tradename_of' and product.tty in ('BPCK','SBD')\n\tleft join datasource.rxnorm_rxnconso clinical_product\n\t\ton rxnrel.rxcui1 = clinical_product.rxcui\n\t\tand clinical_product.tty in ('SCD','GPCK')\n\t\tand clinical_product.sab = 'RXNORM'\nwhere rxnsat.atn = 'NDC'\n\tand product.tty in ('SCD','SBD','GPCK','BPCK')\n\tand product.sab = 'RXNORM'", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_rxnorm__ingredient_components": {"database": "sagerx", "schema": "staging", "name": "stg_rxnorm__ingredient_components", "resource_type": "model", "package_name": "sagerx", "path": "staging/rxnorm/stg_rxnorm__ingredient_components.sql", "original_file_path": "models/staging/rxnorm/stg_rxnorm__ingredient_components.sql", "unique_id": "model.sagerx.stg_rxnorm__ingredient_components", "fqn": ["sagerx", "staging", "rxnorm", "stg_rxnorm__ingredient_components"], "alias": "stg_rxnorm__ingredient_components", "checksum": {"name": "sha256", "checksum": "6f0d21850f4aeefb8c6f5b4fb901491b9936ebcbd2dc37e4e6a287389c2a73d1"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "RxNorm ingredient components (IN).", "columns": {"rxcui": {"name": "rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "name": {"name": "name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "tty": {"name": "tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active": {"name": "active", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "prescribable": {"name": "prescribable", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/staging/rxnorm/_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192135.062855, "relation_name": "\"sagerx\".\"staging\".\"stg_rxnorm__ingredient_components\"", "raw_code": "-- stg_rxnorm__ingredient_components.sql\n\nwith cte as (\n\tselect\n\t\trxnrel.rxcui2 as ingredient_rxcui\n\t\t, ingredient_component.rxcui as rxcui\n\t\t, ingredient_component.str as name\n\t\t, ingredient_component.tty as tty\n\t\t, ingredient_component.suppress\n\t\t, ingredient_component.cvf\n\tfrom\n\t\tdatasource.rxnorm_rxnrel rxnrel\n\tinner join datasource.rxnorm_rxnconso ingredient_component\n\t\ton rxnrel.rxcui1 = ingredient_component.rxcui\n\twhere rxnrel.rela = 'has_part'\n\t\tand ingredient_component.tty = 'IN'\n\t\tand ingredient_component.sab = 'RXNORM'\n)\n\nselect distinct\n\tcase when cte.rxcui is null then ingredient.rxcui else cte.rxcui end rxcui\n\t, case when cte.name is null then ingredient.str else cte.name end name\n\t, case when cte.tty is null then ingredient.tty else cte.tty end tty\n\t, case when \n\t\tcase when cte.rxcui is null then ingredient.suppress else cte.suppress end = 'N' then true else false end as active\n\t, case when \n\t\tcase when cte.rxcui is null then ingredient.cvf else cte.cvf end = '4096' then true else false end as prescribable\nfrom datasource.rxnorm_rxnconso ingredient\nleft join cte on ingredient.rxcui = cte.ingredient_rxcui\nwhere ingredient.tty in('IN', 'MIN')\n\tand ingredient.sab = 'RXNORM'", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/stg_rxnorm__ingredient_components.sql", "compiled": true, "compiled_code": "-- stg_rxnorm__ingredient_components.sql\n\nwith cte as (\n\tselect\n\t\trxnrel.rxcui2 as ingredient_rxcui\n\t\t, ingredient_component.rxcui as rxcui\n\t\t, ingredient_component.str as name\n\t\t, ingredient_component.tty as tty\n\t\t, ingredient_component.suppress\n\t\t, ingredient_component.cvf\n\tfrom\n\t\tdatasource.rxnorm_rxnrel rxnrel\n\tinner join datasource.rxnorm_rxnconso ingredient_component\n\t\ton rxnrel.rxcui1 = ingredient_component.rxcui\n\twhere rxnrel.rela = 'has_part'\n\t\tand ingredient_component.tty = 'IN'\n\t\tand ingredient_component.sab = 'RXNORM'\n)\n\nselect distinct\n\tcase when cte.rxcui is null then ingredient.rxcui else cte.rxcui end rxcui\n\t, case when cte.name is null then ingredient.str else cte.name end name\n\t, case when cte.tty is null then ingredient.tty else cte.tty end tty\n\t, case when \n\t\tcase when cte.rxcui is null then ingredient.suppress else cte.suppress end = 'N' then true else false end as active\n\t, case when \n\t\tcase when cte.rxcui is null then ingredient.cvf else cte.cvf end = '4096' then true else false end as prescribable\nfrom datasource.rxnorm_rxnconso ingredient\nleft join cte on ingredient.rxcui = cte.ingredient_rxcui\nwhere ingredient.tty in('IN', 'MIN')\n\tand ingredient.sab = 'RXNORM'", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_rxnorm__all_ndcs": {"database": "sagerx", "schema": "staging", "name": "stg_rxnorm__all_ndcs", "resource_type": "model", "package_name": "sagerx", "path": "staging/rxnorm/stg_rxnorm__all_ndcs.sql", "original_file_path": "models/staging/rxnorm/stg_rxnorm__all_ndcs.sql", "unique_id": "model.sagerx.stg_rxnorm__all_ndcs", "fqn": ["sagerx", "staging", "rxnorm", "stg_rxnorm__all_ndcs"], "alias": "stg_rxnorm__all_ndcs", "checksum": {"name": "sha256", "checksum": "6c417b24db280256cbda57941f6d814b044303212ae756b977ac8df98c4e7364"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192134.9489348, "relation_name": "\"sagerx\".\"staging\".\"stg_rxnorm__all_ndcs\"", "raw_code": "-- stg_rxnorm__all_ndcs.sql\n\nselect\n    ndc_to_11(rxnsat.atv) as ndc11\n    , rxnsat.atv as ndc\n    , rxnsat.rxcui\n    , rxnsat.sab\n\t, case when rxnsat.suppress = 'N' then true else false end as active\n\t, case when rxnsat.cvf = '4096' then true else false end as prescribable\nfrom datasource.rxnorm_rxnsat rxnsat\n    where rxnsat.atn = 'NDC'", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/stg_rxnorm__all_ndcs.sql", "compiled": true, "compiled_code": "-- stg_rxnorm__all_ndcs.sql\n\nselect\n    ndc_to_11(rxnsat.atv) as ndc11\n    , rxnsat.atv as ndc\n    , rxnsat.rxcui\n    , rxnsat.sab\n\t, case when rxnsat.suppress = 'N' then true else false end as active\n\t, case when rxnsat.cvf = '4096' then true else false end as prescribable\nfrom datasource.rxnorm_rxnsat rxnsat\n    where rxnsat.atn = 'NDC'", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_rxnorm__dose_form_groups": {"database": "sagerx", "schema": "staging", "name": "stg_rxnorm__dose_form_groups", "resource_type": "model", "package_name": "sagerx", "path": "staging/rxnorm/stg_rxnorm__dose_form_groups.sql", "original_file_path": "models/staging/rxnorm/stg_rxnorm__dose_form_groups.sql", "unique_id": "model.sagerx.stg_rxnorm__dose_form_groups", "fqn": ["sagerx", "staging", "rxnorm", "stg_rxnorm__dose_form_groups"], "alias": "stg_rxnorm__dose_form_groups", "checksum": {"name": "sha256", "checksum": "3fa548e3214f8e734c7bd7868539f84e019fc95063d6e85c463de85f391877be"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "RxNorm dose form groups (DFG).", "columns": {"rxcui": {"name": "rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "name": {"name": "name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "tty": {"name": "tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active": {"name": "active", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "prescribable": {"name": "prescribable", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/staging/rxnorm/_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192135.0572138, "relation_name": "\"sagerx\".\"staging\".\"stg_rxnorm__dose_form_groups\"", "raw_code": "-- stg_rxnorm__dose_form_groups.sql\n\nselect\n\tdose_form_group.rxcui rxcui\n\t, dose_form_group.str name\n\t, dose_form_group.tty tty\n\t, case when dose_form_group.suppress = 'N' then true else false end as active\n\t, case when dose_form_group.cvf = '4096' then true else false end as prescribable\nfrom datasource.rxnorm_rxnconso dose_form_group\nwhere dose_form_group.tty = 'DFG'\n\tand dose_form_group.sab = 'RXNORM'", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/stg_rxnorm__dose_form_groups.sql", "compiled": true, "compiled_code": "-- stg_rxnorm__dose_form_groups.sql\n\nselect\n\tdose_form_group.rxcui rxcui\n\t, dose_form_group.str name\n\t, dose_form_group.tty tty\n\t, case when dose_form_group.suppress = 'N' then true else false end as active\n\t, case when dose_form_group.cvf = '4096' then true else false end as prescribable\nfrom datasource.rxnorm_rxnconso dose_form_group\nwhere dose_form_group.tty = 'DFG'\n\tand dose_form_group.sab = 'RXNORM'", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_rxnorm__dose_forms": {"database": "sagerx", "schema": "staging", "name": "stg_rxnorm__dose_forms", "resource_type": "model", "package_name": "sagerx", "path": "staging/rxnorm/stg_rxnorm__dose_forms.sql", "original_file_path": "models/staging/rxnorm/stg_rxnorm__dose_forms.sql", "unique_id": "model.sagerx.stg_rxnorm__dose_forms", "fqn": ["sagerx", "staging", "rxnorm", "stg_rxnorm__dose_forms"], "alias": "stg_rxnorm__dose_forms", "checksum": {"name": "sha256", "checksum": "d8b54da1641dfb372cc342ef97b1785851c722534989e896ebcaba1bc6207d13"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "RxNorm dose forms (DF).", "columns": {"rxcui": {"name": "rxcui", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "name": {"name": "name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "tty": {"name": "tty", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active": {"name": "active", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "prescribable": {"name": "prescribable", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/staging/rxnorm/_rxnorm__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192135.0539114, "relation_name": "\"sagerx\".\"staging\".\"stg_rxnorm__dose_forms\"", "raw_code": "-- stg_rxnorm__dose_forms.sql\n\nselect\n\tdose_form.rxcui rxcui\n\t, dose_form.str name\n\t, dose_form.tty tty\n\t, case when dose_form.suppress = 'N' then true else false end as active\n\t, case when dose_form.cvf = '4096' then true else false end as prescribable\nfrom datasource.rxnorm_rxnconso dose_form\nwhere dose_form.tty = 'DF'\n\tand dose_form.sab = 'RXNORM'", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/stg_rxnorm__dose_forms.sql", "compiled": true, "compiled_code": "-- stg_rxnorm__dose_forms.sql\n\nselect\n\tdose_form.rxcui rxcui\n\t, dose_form.str name\n\t, dose_form.tty tty\n\t, case when dose_form.suppress = 'N' then true else false end as active\n\t, case when dose_form.cvf = '4096' then true else false end as prescribable\nfrom datasource.rxnorm_rxnconso dose_form\nwhere dose_form.tty = 'DF'\n\tand dose_form.sab = 'RXNORM'", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_fda_enforcement__reports": {"database": "sagerx", "schema": "staging", "name": "stg_fda_enforcement__reports", "resource_type": "model", "package_name": "sagerx", "path": "staging/fda_enforcement/stg_fda_enforcement__reports.sql", "original_file_path": "models/staging/fda_enforcement/stg_fda_enforcement__reports.sql", "unique_id": "model.sagerx.stg_fda_enforcement__reports", "fqn": ["sagerx", "staging", "fda_enforcement", "stg_fda_enforcement__reports"], "alias": "stg_fda_enforcement__reports", "checksum": {"name": "sha256", "checksum": "e9e5b3246e144158dea92634e7e48b6e0cdec4f7e831795d28b623d076967217"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192134.9578364, "relation_name": "\"sagerx\".\"staging\".\"stg_fda_enforcement__reports\"", "raw_code": "-- stg_fda_enforcement__reports.sql\n\nselect\n\tstatus\n\t, city\n\t, state\n\t, country\n\t, classification\n\t, openfda\n\t, product_type\n\t, event_id\n\t, recalling_firm\n\t, address_1\n\t, address_2\n\t, postal_code\n\t, voluntary_mandated\n\t, initial_firm_notification\n\t, distribution_pattern\n\t, recall_number\n\t, product_description\n\t, product_quantity\n\t, reason_for_recall\n\t, recall_initiation_date\n\t, center_classification_date\n\t, report_date\n\t, code_info\nfrom datasource.fda_enforcement", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/fda_enforcement/stg_fda_enforcement__reports.sql", "compiled": true, "compiled_code": "-- stg_fda_enforcement__reports.sql\n\nselect\n\tstatus\n\t, city\n\t, state\n\t, country\n\t, classification\n\t, openfda\n\t, product_type\n\t, event_id\n\t, recalling_firm\n\t, address_1\n\t, address_2\n\t, postal_code\n\t, voluntary_mandated\n\t, initial_firm_notification\n\t, distribution_pattern\n\t, recall_number\n\t, product_description\n\t, product_quantity\n\t, reason_for_recall\n\t, recall_initiation_date\n\t, center_classification_date\n\t, report_date\n\t, code_info\nfrom datasource.fda_enforcement", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_fda_enforcement__regex_ndcs": {"database": "sagerx", "schema": "staging", "name": "stg_fda_enforcement__regex_ndcs", "resource_type": "model", "package_name": "sagerx", "path": "staging/fda_enforcement/stg_fda_enforcement__regex_ndcs.sql", "original_file_path": "models/staging/fda_enforcement/stg_fda_enforcement__regex_ndcs.sql", "unique_id": "model.sagerx.stg_fda_enforcement__regex_ndcs", "fqn": ["sagerx", "staging", "fda_enforcement", "stg_fda_enforcement__regex_ndcs"], "alias": "stg_fda_enforcement__regex_ndcs", "checksum": {"name": "sha256", "checksum": "27c22822990a2df08d16148ecc9c0d48335fa898bade1691a57d6483e616b1e4"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192134.9607627, "relation_name": "\"sagerx\".\"staging\".\"stg_fda_enforcement__regex_ndcs\"", "raw_code": "-- stg_fda_enforcement__regex_ndcs.sql\n\nwith\n\nz as (\n\tselect\n\t\trecall_number\n\t\t, ndc_to_11((regexp_matches(product_description, '(\\m\\d{1,5}-\\d{1,4}-\\d{1,2}\\M|\\m\\d{11}\\M)', 'g'))[1]) as ndc11\n\t\t, left(ndc_to_11((regexp_matches(product_description, '(\\m\\d{1,5}-\\d{1,4}-\\d{1,2}\\M|\\m\\d{11}\\M)', 'g'))[1]), 9) as ndc9\n\tfrom datasource.fda_enforcement\n)\n\nselect\n\t*\nfrom z\nwhere ndc11 is not null", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/fda_enforcement/stg_fda_enforcement__regex_ndcs.sql", "compiled": true, "compiled_code": "-- stg_fda_enforcement__regex_ndcs.sql\n\nwith\n\nz as (\n\tselect\n\t\trecall_number\n\t\t, ndc_to_11((regexp_matches(product_description, '(\\m\\d{1,5}-\\d{1,4}-\\d{1,2}\\M|\\m\\d{11}\\M)', 'g'))[1]) as ndc11\n\t\t, left(ndc_to_11((regexp_matches(product_description, '(\\m\\d{1,5}-\\d{1,4}-\\d{1,2}\\M|\\m\\d{11}\\M)', 'g'))[1]), 9) as ndc9\n\tfrom datasource.fda_enforcement\n)\n\nselect\n\t*\nfrom z\nwhere ndc11 is not null", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_fda_enforcement__json_ndcs": {"database": "sagerx", "schema": "staging", "name": "stg_fda_enforcement__json_ndcs", "resource_type": "model", "package_name": "sagerx", "path": "staging/fda_enforcement/stg_fda_enforcement__json_ndcs.sql", "original_file_path": "models/staging/fda_enforcement/stg_fda_enforcement__json_ndcs.sql", "unique_id": "model.sagerx.stg_fda_enforcement__json_ndcs", "fqn": ["sagerx", "staging", "fda_enforcement", "stg_fda_enforcement__json_ndcs"], "alias": "stg_fda_enforcement__json_ndcs", "checksum": {"name": "sha256", "checksum": "0e7aa98ba89793abb654026ff29ae09c8425225b44794f5e2225b49bf0775cf7"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "FDA enforcement NDCs from JSON.", "columns": {"recall_number": {"name": "recall_number", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ndc11": {"name": "ndc11", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ndc9": {"name": "ndc9", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "app_num": {"name": "app_num", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/staging/fda_enforcement/_fda_enforcement__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192135.1885264, "relation_name": "\"sagerx\".\"staging\".\"stg_fda_enforcement__json_ndcs\"", "raw_code": "-- stg_fda_enforcement__json_ndcs.sql\n\nselect\n\tfdae.recall_number\n\t, ndc_to_11(ndc.id_value #>> '{}') as ndc11\n\t, left(ndc_to_11(ndc.id_value #>> '{}'),9) as ndc9\n\t, app_num.id_value #>> '{}' as app_num\nfrom datasource.fda_enforcement fdae\n\t, json_array_elements(openfda->'package_ndc') with ordinality ndc(id_value, line)\n\t, json_array_elements(openfda->'application_number') with ordinality app_num(id_value, line)\nwhere ndc_to_11(ndc.id_value #>> '{}') is not null", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/fda_enforcement/stg_fda_enforcement__json_ndcs.sql", "compiled": true, "compiled_code": "-- stg_fda_enforcement__json_ndcs.sql\n\nselect\n\tfdae.recall_number\n\t, ndc_to_11(ndc.id_value #>> '{}') as ndc11\n\t, left(ndc_to_11(ndc.id_value #>> '{}'),9) as ndc9\n\t, app_num.id_value #>> '{}' as app_num\nfrom datasource.fda_enforcement fdae\n\t, json_array_elements(openfda->'package_ndc') with ordinality ndc(id_value, line)\n\t, json_array_elements(openfda->'application_number') with ordinality app_num(id_value, line)\nwhere ndc_to_11(ndc.id_value #>> '{}') is not null", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_rxnorm_historical__ndcs": {"database": "sagerx", "schema": "staging", "name": "stg_rxnorm_historical__ndcs", "resource_type": "model", "package_name": "sagerx", "path": "staging/rxnorm_historical/stg_rxnorm_historical__ndcs.sql", "original_file_path": "models/staging/rxnorm_historical/stg_rxnorm_historical__ndcs.sql", "unique_id": "model.sagerx.stg_rxnorm_historical__ndcs", "fqn": ["sagerx", "staging", "rxnorm_historical", "stg_rxnorm_historical__ndcs"], "alias": "stg_rxnorm_historical__ndcs", "checksum": {"name": "sha256", "checksum": "f6cb3a24c605e711f475151f6ab199ef893c9976d9401391576f1fcfddbd03e4"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192134.9667728, "relation_name": "\"sagerx\".\"staging\".\"stg_rxnorm_historical__ndcs\"", "raw_code": "-- stg_rxnorm_historical__ndcs.sql\n\nselect\n    rxcui,\n    (ndc_item->>'ndc')::json->>0 as ndc,\n    ndc_item->>'startDate' as start_date,\n    ndc_item->>'endDate' as end_date,\n    case when item->>'status' = 'indirect'\n        then item->>'rxcui'\n        end as indirect_rxcui\nfrom datasource.rxnorm_historical\n    cross join lateral json_array_elements(ndcs->'historicalNdcTime') as item\n    cross join lateral json_array_elements(item->'ndcTime') as ndc_item", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm_historical/stg_rxnorm_historical__ndcs.sql", "compiled": true, "compiled_code": "-- stg_rxnorm_historical__ndcs.sql\n\nselect\n    rxcui,\n    (ndc_item->>'ndc')::json->>0 as ndc,\n    ndc_item->>'startDate' as start_date,\n    ndc_item->>'endDate' as end_date,\n    case when item->>'status' = 'indirect'\n        then item->>'rxcui'\n        end as indirect_rxcui\nfrom datasource.rxnorm_historical\n    cross join lateral json_array_elements(ndcs->'historicalNdcTime') as item\n    cross join lateral json_array_elements(item->'ndcTime') as ndc_item", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_fda_ndc__class": {"database": "sagerx", "schema": "staging", "name": "stg_fda_ndc__class", "resource_type": "model", "package_name": "sagerx", "path": "staging/fda_ndc/stg_fda_ndc__class.sql", "original_file_path": "models/staging/fda_ndc/stg_fda_ndc__class.sql", "unique_id": "model.sagerx.stg_fda_ndc__class", "fqn": ["sagerx", "staging", "fda_ndc", "stg_fda_ndc__class"], "alias": "stg_fda_ndc__class", "checksum": {"name": "sha256", "checksum": "dd60deda1d5e0a3ea0a5ee8ef8f19ffb305ac65bbc526fa4c2000a354e9a343e"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "Product-level class information", "columns": {"productid": {"name": "productid", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "class_line": {"name": "class_line", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "class_name": {"name": "class_name", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "class_type": {"name": "class_type", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/staging/fda_ndc/_fda_ndc__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192135.2032163, "relation_name": "\"sagerx\".\"staging\".\"stg_fda_ndc__class\"", "raw_code": "-- stg_fda_ndc__class.sql\n\nselect\n\tz.productid\n\t,row_number() over (partition by z.productid order by z.token desc) as class_line\n\t,left(z.token, position('[' in z.token) -1 ) as class_name\n    ,substring(z.token, '\\[(.+)\\]') as class_type\nfrom (select distinct t.productid\n\t,t.pharm_classes\n\t, s.token\n\tfrom   datasource.fda_ndc_product t, unnest(string_to_array(t.pharm_classes, ',')) s(token)) z", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/fda_ndc/stg_fda_ndc__class.sql", "compiled": true, "compiled_code": "-- stg_fda_ndc__class.sql\n\nselect\n\tz.productid\n\t,row_number() over (partition by z.productid order by z.token desc) as class_line\n\t,left(z.token, position('[' in z.token) -1 ) as class_name\n    ,substring(z.token, '\\[(.+)\\]') as class_type\nfrom (select distinct t.productid\n\t,t.pharm_classes\n\t, s.token\n\tfrom   datasource.fda_ndc_product t, unnest(string_to_array(t.pharm_classes, ',')) s(token)) z", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_fda_ndc__substance": {"database": "sagerx", "schema": "staging", "name": "stg_fda_ndc__substance", "resource_type": "model", "package_name": "sagerx", "path": "staging/fda_ndc/stg_fda_ndc__substance.sql", "original_file_path": "models/staging/fda_ndc/stg_fda_ndc__substance.sql", "unique_id": "model.sagerx.stg_fda_ndc__substance", "fqn": ["sagerx", "staging", "fda_ndc", "stg_fda_ndc__substance"], "alias": "stg_fda_ndc__substance", "checksum": {"name": "sha256", "checksum": "9ae19f3b8baa715b8ae8bd09ba7e921592365255a34a6191b0e959dd391adf75"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "Product-level substance information", "columns": {"productid": {"name": "productid", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "substance_line": {"name": "substance_line", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "substancename": {"name": "substancename", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active_numerator_strength": {"name": "active_numerator_strength", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active_ingred_unit": {"name": "active_ingred_unit", "description": "", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/staging/fda_ndc/_fda_ndc__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192135.2052937, "relation_name": "\"sagerx\".\"staging\".\"stg_fda_ndc__substance\"", "raw_code": "-- stg_fda_ndc__substance.sql\n\nselect distinct\n\tprod.productid\n\t, row_number() over (partition by prod.productid) as substance_line\n\t, arr.*\nfrom datasource.fda_ndc_product prod\n\t, unnest(string_to_array(prod.substancename, '; ')\n\t\t,string_to_array(prod.active_numerator_strength, '; ')\n\t\t,string_to_array(prod.active_ingred_unit, '; ')\n\t) arr(substancename,active_numerator_strength,active_ingred_unit)", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/staging/fda_ndc/stg_fda_ndc__substance.sql", "compiled": true, "compiled_code": "-- stg_fda_ndc__substance.sql\n\nselect distinct\n\tprod.productid\n\t, row_number() over (partition by prod.productid) as substance_line\n\t, arr.*\nfrom datasource.fda_ndc_product prod\n\t, unnest(string_to_array(prod.substancename, '; ')\n\t\t,string_to_array(prod.active_numerator_strength, '; ')\n\t\t,string_to_array(prod.active_ingred_unit, '; ')\n\t) arr(substancename,active_numerator_strength,active_ingred_unit)", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.stg_fda_ndc__ndc": {"database": "sagerx", "schema": "staging", "name": "stg_fda_ndc__ndc", "resource_type": "model", "package_name": "sagerx", "path": "staging/fda_ndc/stg_fda_ndc__ndc.sql", "original_file_path": "models/staging/fda_ndc/stg_fda_ndc__ndc.sql", "unique_id": "model.sagerx.stg_fda_ndc__ndc", "fqn": ["sagerx", "staging", "fda_ndc", "stg_fda_ndc__ndc"], "alias": "stg_fda_ndc__ndc", "checksum": {"name": "sha256", "checksum": "e87388ce4827fbb63434d992cebeaeaf6835ef975ca2a8ab1e0fcff7ad33ae1c"}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "FDA NDC Directory", "columns": {"ndc11": {"name": "ndc11", "description": "The ndcpackagecode field, normalized to a NDC11 format.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "productid": {"name": "productid", "description": "ProductID is a concatenation of the NDCproduct code and SPL documentID. It is included to help prevent duplicate rows from appearing when joining the product and package files together. It has no regulatory value or significance.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "productndc": {"name": "productndc", "description": "The labeler code and product code segments of the National Drug Code number, separated by a hyphen. Asterisks are no longer used or included within the product code segment to indicate certain configurations of the NDC.  www.fda.gov/edrls under Structured Product Labeling Resources.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "producttypename": {"name": "producttypename", "description": "Indicates the type of product, such as Human Prescription Drug or Human OTC Drug. This data element corresponds to the Document Type of the SPL submission for the listing.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "proprietaryname": {"name": "proprietaryname", "description": "Also known as the trade name. It is the name of the product chosen by the labeler.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "proprietarynamesuffix": {"name": "proprietarynamesuffix", "description": "A suffix to the proprietary name, a value here should be appended to the ProprietaryName field to obtain the complete name of the product. This suffix is often used to distinguish characteristics of a product such as extended release (XR) or sleep aid (PM). Although many companies follow certain naming conventions for suffices, there is no recognized standard", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "nonproprietaryname": {"name": "nonproprietaryname", "description": "Sometimes called the generic name, this is usually the active ingredient(s) of the product.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "dosageformname": {"name": "dosageformname", "description": "The translation of the DosageForm Code submitted by the firm. The complete list of codes and translations can be found www.fda.gov/edrls under Structured Product Labeling Resources.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "routename": {"name": "routename", "description": "The translation of the Route Code submitted by the firm, indicating route of administration. The complete list of codes and translations can be found at www.fda.gov/edrls under Structured Product Labeling Resources.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "product_startmarketingdate": {"name": "product_startmarketingdate", "description": "This is the date that the labeler indicates was the start of its marketing of the drug product.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "product_endmarketingdate": {"name": "product_endmarketingdate", "description": "This is the date the product will no longer be available on the market. If a product is no longer being manufactured, in most cases, the FDA recommends firms use the expiration date of the last lot produced as the EndMarketingDate, to reflect the potential for drug product to remain available after manufacturing has ceased. Products that are the subject of ongoing manufacturing will not ordinarily have any EndMarketingDate. Products with a value in the EndMarketingDate will be removed from the NDC Directory when the EndMarketingDate is reached.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "marketingcategoryname": {"name": "marketingcategoryname", "description": "Product types are broken down into several potential Marketing Categories, such as NDA/ANDA/BLA, OTC Monograph, or Unapproved Drug. One and only one Marketing Category may be chosen for a product, not all marketing categories are available to all product types. Currently, only final marketed product categories are included. The complete list of codes and translations can be found at www.fda.gov/edrls under Structured Product Labeling Resources.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "applicationnumber": {"name": "applicationnumber", "description": "This corresponds to the NDA, ANDA, or BLA number reported by the labeler for products which have the corresponding Marketing Category designated. If the designated Marketing Category is OTC Monograph Final or OTC Monograph Not Final, then the Application number will be the CFR citation corresponding to the appropriate Monograph (e.g. \u201cpart 341\u201d). For unapproved drugs, this field will be null.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "labelername": {"name": "labelername", "description": "Name of Company corresponding to the labeler code segment of the ProductNDC.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "substancename": {"name": "substancename", "description": "This is the active ingredient list. Each ingredient name is the preferred term of the UNII code submitted.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active_numerator_strength": {"name": "active_numerator_strength", "description": "These are the strength values (to be used with units below) of each active ingredient, listed in the same order as the SubstanceName field above.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "active_ingred_unit": {"name": "active_ingred_unit", "description": "These are the units to be used with the strength values above, listed in the same order as the SubstanceName and SubstanceNumber (ActiveNumeratorStrength).", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "pharm_classes": {"name": "pharm_classes", "description": "These are the reported pharmacological class categories corresponding to the SubstanceNames listed above.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "deaschedule": {"name": "deaschedule", "description": "This is the assigned DEA Schedule number as reported by the labeler. Values are CI, CII, CIII, CIV, and CV.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "product_ndc_exclude_flag": {"name": "product_ndc_exclude_flag", "description": "Values = Y, N, E, or I. This indicates whether the product has been removed/excluded from the NDC Directory for failure to respond to FDA's requests for correction to deficient or non-compliant submissions (Y), or because the listing certification is expired (E), or because the listing data was inactivated by FDA (I). The PRODUCT.XLS and PRODUCT.TXT files only contain listing records where NDC_EXCLUDE_FLAG=N. The PRODUCTS_EXCLUDED.XLS and PRODUCTS_EXCLUDED.TXT file contains all listing records with an NDC_EXCLUDE_FLAG of Y, E, and I.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "listing_record_certified_through": {"name": "listing_record_certified_through", "description": "This is the date when the listing record will expire if not updated or certified by the firm.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "ndcpackagecode": {"name": "ndcpackagecode", "description": "The labeler code, product code, and package code segments of the National Drug Code number, separated by hyphens. Asterisks are no longer used or included within the product and package code segments to indicate certain configurations of the NDC.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "packagedescription": {"name": "packagedescription", "description": "A description of the size and type of packaging in sentence form. Multilevel packages will have the descriptions concatenated together. For example: 4 BOTTLES in 1 CARTON/100 TABLETS in 1 BOTTLE.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "package_startmarketingdate": {"name": "package_startmarketingdate", "description": "This is the date that the labeler indicates was the start of its marketing of the drug product.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "package_endmarketingdate": {"name": "package_endmarketingdate", "description": "This is the date the product will no longer be available on the market. If a product is no longer being manufactured, in most cases, the FDA recommends firms use the expiration date of the last lot produced as the EndMarketingDate, to reflect the potential for drug product to remain available after manufacturing has ceased. Products that are the subject of ongoing manufacturing will not ordinarily have any EndMarketingDate. Products with a value in the EndMarketingDate will be removed from the NDC Directory when the EndMarketingDate is reached.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "package_ndc_exclude_flag": {"name": "package_ndc_exclude_flag", "description": "Values = Y, N, E, or I. This indicates whether the PACKAGE has been removed/excluded from the NDC Directory for failure to respond to FDAs requests for correction to deficient or non-compliant submissions (Y), or because the listing certification is expired (E), or because the listing data was inactivated by FDA (I). The PACKAGE.XLS and PACKAGE.TXT files only contain listing records where NDC_EXCLUDE_FLAG=N. The PACKAGES_EXCLUDED.XLS and PACKAGES_EXCLUDED.TXT file contains all listing records with an NDC_EXCLUDE_FLAG of Y, E, and I.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "sample_package": {"name": "sample_package", "description": "This indicates if the package is to be distributed as a sample package. Values = Y or N.", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": "sagerx://models/staging/fda_ndc/_fda_ndc__models.yml", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1703192135.201528, "relation_name": "\"sagerx\".\"staging\".\"stg_fda_ndc__ndc\"", "raw_code": "-- stg_fda_ndc__ndc.sql\n\nwith\n\nproduct as (\n    \n    select * from {{ source('fda_ndc', 'fda_ndc_product') }}\n\n),\n\npackage as (\n\n    select * from {{ source('fda_ndc', 'fda_ndc_package') }}\n\n)\n\nselect\n\tndc_to_11(ndcpackagecode) as ndc11\n\t, package.productid\n\t, package.productndc\n\t, producttypename\n\t, proprietaryname\n\t, proprietarynamesuffix\n\t, nonproprietaryname\n\t, dosageformname\n\t, routename\n\t, product.startmarketingdate as product_startmarketingdate\n\t, product.endmarketingdate as product_endmarketingdate\n\t, marketingcategoryname\n\t, applicationnumber\n\t, labelername\n\t, substancename\n\t, active_numerator_strength\n\t, active_ingred_unit\n\t, pharm_classes\n\t, deaschedule\n\t, product.ndc_exclude_flag as product_ndc_exclude_flag\n\t, listing_record_certified_through\n\t, ndcpackagecode\n\t, packagedescription\n\t, package.startmarketingdate as package_startmarketingdate\n\t, package.endmarketingdate as package_endmarketingdate\n\t, package.ndc_exclude_flag as package_ndc_exclude_flag\n\t, sample_package\nfrom package\nleft join product\n\ton package.productid = product.productid", "language": "sql", "refs": [], "sources": [["fda_ndc", "fda_ndc_product"], ["fda_ndc", "fda_ndc_package"]], "metrics": [], "depends_on": {"macros": [], "nodes": ["source.sagerx.fda_ndc.fda_ndc_product", "source.sagerx.fda_ndc.fda_ndc_package"]}, "compiled_path": "target/compiled/sagerx/models/staging/fda_ndc/stg_fda_ndc__ndc.sql", "compiled": true, "compiled_code": "-- stg_fda_ndc__ndc.sql\n\nwith\n\nproduct as (\n    \n    select * from \"sagerx\".\"datasource\".\"fda_ndc_product\"\n\n),\n\npackage as (\n\n    select * from \"sagerx\".\"datasource\".\"fda_ndc_package\"\n\n)\n\nselect\n\tndc_to_11(ndcpackagecode) as ndc11\n\t, package.productid\n\t, package.productndc\n\t, producttypename\n\t, proprietaryname\n\t, proprietarynamesuffix\n\t, nonproprietaryname\n\t, dosageformname\n\t, routename\n\t, product.startmarketingdate as product_startmarketingdate\n\t, product.endmarketingdate as product_endmarketingdate\n\t, marketingcategoryname\n\t, applicationnumber\n\t, labelername\n\t, substancename\n\t, active_numerator_strength\n\t, active_ingred_unit\n\t, pharm_classes\n\t, deaschedule\n\t, product.ndc_exclude_flag as product_ndc_exclude_flag\n\t, listing_record_certified_through\n\t, ndcpackagecode\n\t, packagedescription\n\t, package.startmarketingdate as package_startmarketingdate\n\t, package.endmarketingdate as package_endmarketingdate\n\t, package.ndc_exclude_flag as package_ndc_exclude_flag\n\t, sample_package\nfrom package\nleft join product\n\ton package.productid = product.productid", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.sagerx_product_classification": {"database": "sagerx", "schema": "marts", "name": "sagerx_product_classification", "resource_type": "model", "package_name": "sagerx", "path": "marts/sagerx/sagerx_product_classification.sql", "original_file_path": "models/marts/sagerx/sagerx_product_classification.sql", "unique_id": "model.sagerx.sagerx_product_classification", "fqn": ["sagerx", "marts", "sagerx", "sagerx_product_classification"], "alias": "sagerx_product_classification", "checksum": {"name": "sha256", "checksum": "a546fb940c2b2a9db057153cbb782629067f9242ce7d8936497a51b8c839f443"}, "config": {"enabled": true, "alias": null, "schema": "marts", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "marts", "materialized": "view"}, "created_at": 1703192134.9793127, "relation_name": "\"sagerx\".\"marts\".\"sagerx_product_classification\"", "raw_code": "with clinical_products_to_ingredient_strengths as (\n\tselect *\n\tfrom intermediate.int_rxnorm_clinical_products_to_ingredient_strengths\n\torder by ingredient_component_name asc\n    -- NOTE: would it be more stable to sort each component by rxcui asc?\n)\n\n, cte as (\n\tselect\n\t\tclinical_product_rxcui\n\t\t, clinical_product_name\n\t\t, string_agg(ingredient_component_name, ' / ') as ingredient_name\n\t\t, string_agg(coalesce(precise_ingredient_name, ingredient_component_name), ' / ') as precise_ingredient_name\n\t\t, string_agg(distinct dose_form_name, ' / ') as dose_form_name\n\t\t, string_agg(strength_text, ' / ') as strength_name\n\tfrom clinical_products_to_ingredient_strengths\n\tgroup by\n\t\tclinical_product_rxcui\n\t\t, clinical_product_name\n)\n\nselect distinct\n    atc_1_name\n    , atc_2_name\n    , atc_3_name\n    , atc_4_name\n\t, clinical_product_rxcui\n\t, clinical_product_name\n\t, cte.ingredient_name as ingredient\n\t, precise_ingredient_name as precise_ingredient\n    , concat(\n            precise_ingredient_name\n            , ' '\n            , dose_form_name\n        ) as dose_form\n    , concat(\n            precise_ingredient_name\n            , ' '\n            , dose_form_name\n            , ' '\n            , strength_name\n        ) as strength\nfrom cte\nleft join intermediate.int_atc_codes_to_product_rxcuis atc\n    on atc.rxcui::varchar = cte.clinical_product_rxcui\norder by clinical_product_rxcui", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/sagerx/models/marts/sagerx/sagerx_product_classification.sql", "compiled": true, "compiled_code": "with clinical_products_to_ingredient_strengths as (\n\tselect *\n\tfrom intermediate.int_rxnorm_clinical_products_to_ingredient_strengths\n\torder by ingredient_component_name asc\n    -- NOTE: would it be more stable to sort each component by rxcui asc?\n)\n\n, cte as (\n\tselect\n\t\tclinical_product_rxcui\n\t\t, clinical_product_name\n\t\t, string_agg(ingredient_component_name, ' / ') as ingredient_name\n\t\t, string_agg(coalesce(precise_ingredient_name, ingredient_component_name), ' / ') as precise_ingredient_name\n\t\t, string_agg(distinct dose_form_name, ' / ') as dose_form_name\n\t\t, string_agg(strength_text, ' / ') as strength_name\n\tfrom clinical_products_to_ingredient_strengths\n\tgroup by\n\t\tclinical_product_rxcui\n\t\t, clinical_product_name\n)\n\nselect distinct\n    atc_1_name\n    , atc_2_name\n    , atc_3_name\n    , atc_4_name\n\t, clinical_product_rxcui\n\t, clinical_product_name\n\t, cte.ingredient_name as ingredient\n\t, precise_ingredient_name as precise_ingredient\n    , concat(\n            precise_ingredient_name\n            , ' '\n            , dose_form_name\n        ) as dose_form\n    , concat(\n            precise_ingredient_name\n            , ' '\n            , dose_form_name\n            , ' '\n            , strength_name\n        ) as strength\nfrom cte\nleft join intermediate.int_atc_codes_to_product_rxcuis atc\n    on atc.rxcui::varchar = cte.clinical_product_rxcui\norder by clinical_product_rxcui", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "model.sagerx.scorecard_data": {"database": "sagerx", "schema": "marts", "name": "scorecard_data", "resource_type": "model", "package_name": "sagerx", "path": "marts/purdue/scorecard_data.sql", "original_file_path": "models/marts/purdue/scorecard_data.sql", "unique_id": "model.sagerx.scorecard_data", "fqn": ["sagerx", "marts", "purdue", "scorecard_data"], "alias": "scorecard_data", "checksum": {"name": "sha256", "checksum": "ae306ca879ec1bac2b251c65594a323c5ec1378bc3b0f8c0e80fa3bb1cfdbc31"}, "config": {"enabled": true, "alias": null, "schema": "marts", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false}, "post-hook": [], "pre-hook": []}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "marts", "materialized": "view"}, "created_at": 1703192134.9822812, "relation_name": "\"sagerx\".\"marts\".\"scorecard_data\"", "raw_code": "with\n\ning_to_report as (\n\n    select * from {{ ref('int_inactive_ingredients_to_fda_enforcement_reports') }}\n\n)\n\nselect * from ing_to_report\nwhere active_ingredient_name in (\n    'risperidone'\n    , 'adalimumab'\n    , 'lidocaine'\n    , 'carbamazepine'\n    , 'phenytoin'\n    , 'midazolam'\n    , 'valproate'\n    , 'tacrolimus'\n    , 'amoxicillin'\n    , 'hydrocortisone'\n    , 'cetirizine'\n    , 'pertuzumab'\n    , 'methylphenidate'\n    , 'erythromycin'\n    , 'gabapentin'\n    , 'lopinavir / ritonavir'\n    , 'levothyroxine'\n    , 'albuterol'\n    )", "language": "sql", "refs": [{"name": "int_inactive_ingredients_to_fda_enforcement_reports", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.sagerx.int_inactive_ingredients_to_fda_enforcement_reports"]}, "compiled_path": "target/compiled/sagerx/models/marts/purdue/scorecard_data.sql", "compiled": true, "compiled_code": "with\n\ning_to_report as (\n\n    select * from \"sagerx\".\"intermediate\".\"int_inactive_ingredients_to_fda_enforcement_reports\"\n\n)\n\nselect * from ing_to_report\nwhere active_ingredient_name in (\n    'risperidone'\n    , 'adalimumab'\n    , 'lidocaine'\n    , 'carbamazepine'\n    , 'phenytoin'\n    , 'midazolam'\n    , 'valproate'\n    , 'tacrolimus'\n    , 'amoxicillin'\n    , 'hydrocortisone'\n    , 'cetirizine'\n    , 'pertuzumab'\n    , 'methylphenidate'\n    , 'erythromycin'\n    , 'gabapentin'\n    , 'lopinavir / ritonavir'\n    , 'levothyroxine'\n    , 'albuterol'\n    )", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null}, "test.sagerx.unique_stg_rxnorm__ndcs_ndc.9929df0b31": {"test_metadata": {"name": "unique", "kwargs": {"column_name": "ndc", "model": "{{ get_where_subquery(ref('stg_rxnorm__ndcs')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "unique_stg_rxnorm__ndcs_ndc", "resource_type": "test", "package_name": "sagerx", "path": "unique_stg_rxnorm__ndcs_ndc.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.unique_stg_rxnorm__ndcs_ndc.9929df0b31", "fqn": ["sagerx", "staging", "rxnorm", "unique_stg_rxnorm__ndcs_ndc"], "alias": "unique_stg_rxnorm__ndcs_ndc", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.0924773, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_rxnorm__ndcs", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__ndcs"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/unique_stg_rxnorm__ndcs_ndc.sql", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ndc as unique_field,\n    count(*) as n_records\n\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__ndcs\"\nwhere ndc is not null\ngroup by ndc\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "ndc", "file_key_name": "models.stg_rxnorm__ndcs", "attached_node": "model.sagerx.stg_rxnorm__ndcs"}, "test.sagerx.not_null_stg_rxnorm__ndcs_ndc.4db0f5b5df": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "ndc", "model": "{{ get_where_subquery(ref('stg_rxnorm__ndcs')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "not_null_stg_rxnorm__ndcs_ndc", "resource_type": "test", "package_name": "sagerx", "path": "not_null_stg_rxnorm__ndcs_ndc.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.not_null_stg_rxnorm__ndcs_ndc.4db0f5b5df", "fqn": ["sagerx", "staging", "rxnorm", "not_null_stg_rxnorm__ndcs_ndc"], "alias": "not_null_stg_rxnorm__ndcs_ndc", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.0946002, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_rxnorm__ndcs", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__ndcs"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/not_null_stg_rxnorm__ndcs_ndc.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ndc\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__ndcs\"\nwhere ndc is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "ndc", "file_key_name": "models.stg_rxnorm__ndcs", "attached_node": "model.sagerx.stg_rxnorm__ndcs"}, "test.sagerx.unique_stg_rxnorm__clinical_products_rxcui.0bac3cbe9c": {"test_metadata": {"name": "unique", "kwargs": {"column_name": "rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__clinical_products')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "unique_stg_rxnorm__clinical_products_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "unique_stg_rxnorm__clinical_products_rxcui.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.unique_stg_rxnorm__clinical_products_rxcui.0bac3cbe9c", "fqn": ["sagerx", "staging", "rxnorm", "unique_stg_rxnorm__clinical_products_rxcui"], "alias": "unique_stg_rxnorm__clinical_products_rxcui", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.0966122, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_rxnorm__clinical_products", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__clinical_products"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/unique_stg_rxnorm__clinical_products_rxcui.sql", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    rxcui as unique_field,\n    count(*) as n_records\n\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__clinical_products\"\nwhere rxcui is not null\ngroup by rxcui\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "rxcui", "file_key_name": "models.stg_rxnorm__clinical_products", "attached_node": "model.sagerx.stg_rxnorm__clinical_products"}, "test.sagerx.not_null_stg_rxnorm__clinical_products_rxcui.5dd04a1235": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__clinical_products')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "not_null_stg_rxnorm__clinical_products_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "not_null_stg_rxnorm__clinical_products_rxcui.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.not_null_stg_rxnorm__clinical_products_rxcui.5dd04a1235", "fqn": ["sagerx", "staging", "rxnorm", "not_null_stg_rxnorm__clinical_products_rxcui"], "alias": "not_null_stg_rxnorm__clinical_products_rxcui", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.0986037, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_rxnorm__clinical_products", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__clinical_products"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/not_null_stg_rxnorm__clinical_products_rxcui.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rxcui\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__clinical_products\"\nwhere rxcui is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "rxcui", "file_key_name": "models.stg_rxnorm__clinical_products", "attached_node": "model.sagerx.stg_rxnorm__clinical_products"}, "test.sagerx.not_null_stg_rxnorm__clinical_product_component_links_clinical_product_rxcui.94c75bf656": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "clinical_product_rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__clinical_product_component_links')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "not_null_stg_rxnorm__clinical_product_component_links_clinical_product_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "not_null_stg_rxnorm__clinical__19f6fb5bcaae5ebccd694c1e44d2aa93.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.not_null_stg_rxnorm__clinical_product_component_links_clinical_product_rxcui.94c75bf656", "fqn": ["sagerx", "staging", "rxnorm", "not_null_stg_rxnorm__clinical_product_component_links_clinical_product_rxcui"], "alias": "not_null_stg_rxnorm__clinical__19f6fb5bcaae5ebccd694c1e44d2aa93", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "not_null_stg_rxnorm__clinical__19f6fb5bcaae5ebccd694c1e44d2aa93", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"alias": "not_null_stg_rxnorm__clinical__19f6fb5bcaae5ebccd694c1e44d2aa93"}, "created_at": 1703192135.1008642, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}{{ config(alias=\"not_null_stg_rxnorm__clinical__19f6fb5bcaae5ebccd694c1e44d2aa93\") }}", "language": "sql", "refs": [{"name": "stg_rxnorm__clinical_product_component_links", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__clinical_product_component_links"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/not_null_stg_rxnorm__clinical__19f6fb5bcaae5ebccd694c1e44d2aa93.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect clinical_product_rxcui\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__clinical_product_component_links\"\nwhere clinical_product_rxcui is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "clinical_product_rxcui", "file_key_name": "models.stg_rxnorm__clinical_product_component_links", "attached_node": "model.sagerx.stg_rxnorm__clinical_product_component_links"}, "test.sagerx.not_null_stg_rxnorm__clinical_product_component_links_clinical_product_component_rxcui.869196279f": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "clinical_product_component_rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__clinical_product_component_links')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "not_null_stg_rxnorm__clinical_product_component_links_clinical_product_component_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "not_null_stg_rxnorm__clinical__fd69d791502479297cb519f2232d296b.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.not_null_stg_rxnorm__clinical_product_component_links_clinical_product_component_rxcui.869196279f", "fqn": ["sagerx", "staging", "rxnorm", "not_null_stg_rxnorm__clinical_product_component_links_clinical_product_component_rxcui"], "alias": "not_null_stg_rxnorm__clinical__fd69d791502479297cb519f2232d296b", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "not_null_stg_rxnorm__clinical__fd69d791502479297cb519f2232d296b", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"alias": "not_null_stg_rxnorm__clinical__fd69d791502479297cb519f2232d296b"}, "created_at": 1703192135.1028583, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}{{ config(alias=\"not_null_stg_rxnorm__clinical__fd69d791502479297cb519f2232d296b\") }}", "language": "sql", "refs": [{"name": "stg_rxnorm__clinical_product_component_links", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__clinical_product_component_links"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/not_null_stg_rxnorm__clinical__fd69d791502479297cb519f2232d296b.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect clinical_product_component_rxcui\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__clinical_product_component_links\"\nwhere clinical_product_component_rxcui is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "clinical_product_component_rxcui", "file_key_name": "models.stg_rxnorm__clinical_product_component_links", "attached_node": "model.sagerx.stg_rxnorm__clinical_product_component_links"}, "test.sagerx.unique_stg_rxnorm__clinical_product_components_rxcui.2705e1f418": {"test_metadata": {"name": "unique", "kwargs": {"column_name": "rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__clinical_product_components')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "unique_stg_rxnorm__clinical_product_components_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "unique_stg_rxnorm__clinical_product_components_rxcui.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.unique_stg_rxnorm__clinical_product_components_rxcui.2705e1f418", "fqn": ["sagerx", "staging", "rxnorm", "unique_stg_rxnorm__clinical_product_components_rxcui"], "alias": "unique_stg_rxnorm__clinical_product_components_rxcui", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.1048524, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_rxnorm__clinical_product_components", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__clinical_product_components"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/unique_stg_rxnorm__clinical_product_components_rxcui.sql", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    rxcui as unique_field,\n    count(*) as n_records\n\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__clinical_product_components\"\nwhere rxcui is not null\ngroup by rxcui\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "rxcui", "file_key_name": "models.stg_rxnorm__clinical_product_components", "attached_node": "model.sagerx.stg_rxnorm__clinical_product_components"}, "test.sagerx.not_null_stg_rxnorm__clinical_product_components_rxcui.0b9c81f7ae": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__clinical_product_components')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "not_null_stg_rxnorm__clinical_product_components_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "not_null_stg_rxnorm__clinical_product_components_rxcui.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.not_null_stg_rxnorm__clinical_product_components_rxcui.0b9c81f7ae", "fqn": ["sagerx", "staging", "rxnorm", "not_null_stg_rxnorm__clinical_product_components_rxcui"], "alias": "not_null_stg_rxnorm__clinical_product_components_rxcui", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.106866, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_rxnorm__clinical_product_components", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__clinical_product_components"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/not_null_stg_rxnorm__clinical_product_components_rxcui.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rxcui\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__clinical_product_components\"\nwhere rxcui is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "rxcui", "file_key_name": "models.stg_rxnorm__clinical_product_components", "attached_node": "model.sagerx.stg_rxnorm__clinical_product_components"}, "test.sagerx.unique_stg_rxnorm__dose_forms_rxcui.c7fb3a8da2": {"test_metadata": {"name": "unique", "kwargs": {"column_name": "rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__dose_forms')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "unique_stg_rxnorm__dose_forms_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "unique_stg_rxnorm__dose_forms_rxcui.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.unique_stg_rxnorm__dose_forms_rxcui.c7fb3a8da2", "fqn": ["sagerx", "staging", "rxnorm", "unique_stg_rxnorm__dose_forms_rxcui"], "alias": "unique_stg_rxnorm__dose_forms_rxcui", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.108978, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_rxnorm__dose_forms", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__dose_forms"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/unique_stg_rxnorm__dose_forms_rxcui.sql", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    rxcui as unique_field,\n    count(*) as n_records\n\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__dose_forms\"\nwhere rxcui is not null\ngroup by rxcui\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "rxcui", "file_key_name": "models.stg_rxnorm__dose_forms", "attached_node": "model.sagerx.stg_rxnorm__dose_forms"}, "test.sagerx.not_null_stg_rxnorm__dose_forms_rxcui.a06bc0be08": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__dose_forms')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "not_null_stg_rxnorm__dose_forms_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "not_null_stg_rxnorm__dose_forms_rxcui.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.not_null_stg_rxnorm__dose_forms_rxcui.a06bc0be08", "fqn": ["sagerx", "staging", "rxnorm", "not_null_stg_rxnorm__dose_forms_rxcui"], "alias": "not_null_stg_rxnorm__dose_forms_rxcui", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.1112177, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_rxnorm__dose_forms", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__dose_forms"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/not_null_stg_rxnorm__dose_forms_rxcui.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rxcui\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__dose_forms\"\nwhere rxcui is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "rxcui", "file_key_name": "models.stg_rxnorm__dose_forms", "attached_node": "model.sagerx.stg_rxnorm__dose_forms"}, "test.sagerx.not_null_stg_rxnorm__dose_form_group_links_dose_form_rxcui.3fdd0d4bb1": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "dose_form_rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__dose_form_group_links')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "not_null_stg_rxnorm__dose_form_group_links_dose_form_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "not_null_stg_rxnorm__dose_form_group_links_dose_form_rxcui.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.not_null_stg_rxnorm__dose_form_group_links_dose_form_rxcui.3fdd0d4bb1", "fqn": ["sagerx", "staging", "rxnorm", "not_null_stg_rxnorm__dose_form_group_links_dose_form_rxcui"], "alias": "not_null_stg_rxnorm__dose_form_group_links_dose_form_rxcui", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.1131752, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_rxnorm__dose_form_group_links", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__dose_form_group_links"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/not_null_stg_rxnorm__dose_form_group_links_dose_form_rxcui.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dose_form_rxcui\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__dose_form_group_links\"\nwhere dose_form_rxcui is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "dose_form_rxcui", "file_key_name": "models.stg_rxnorm__dose_form_group_links", "attached_node": "model.sagerx.stg_rxnorm__dose_form_group_links"}, "test.sagerx.not_null_stg_rxnorm__dose_form_group_links_dose_form_group_rxcui.f4fde7102f": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "dose_form_group_rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__dose_form_group_links')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "not_null_stg_rxnorm__dose_form_group_links_dose_form_group_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "not_null_stg_rxnorm__dose_form_1c7459a2a0be5b5a7b3016f225e0146f.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.not_null_stg_rxnorm__dose_form_group_links_dose_form_group_rxcui.f4fde7102f", "fqn": ["sagerx", "staging", "rxnorm", "not_null_stg_rxnorm__dose_form_group_links_dose_form_group_rxcui"], "alias": "not_null_stg_rxnorm__dose_form_1c7459a2a0be5b5a7b3016f225e0146f", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "not_null_stg_rxnorm__dose_form_1c7459a2a0be5b5a7b3016f225e0146f", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"alias": "not_null_stg_rxnorm__dose_form_1c7459a2a0be5b5a7b3016f225e0146f"}, "created_at": 1703192135.115179, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}{{ config(alias=\"not_null_stg_rxnorm__dose_form_1c7459a2a0be5b5a7b3016f225e0146f\") }}", "language": "sql", "refs": [{"name": "stg_rxnorm__dose_form_group_links", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__dose_form_group_links"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/not_null_stg_rxnorm__dose_form_1c7459a2a0be5b5a7b3016f225e0146f.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dose_form_group_rxcui\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__dose_form_group_links\"\nwhere dose_form_group_rxcui is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "dose_form_group_rxcui", "file_key_name": "models.stg_rxnorm__dose_form_group_links", "attached_node": "model.sagerx.stg_rxnorm__dose_form_group_links"}, "test.sagerx.unique_stg_rxnorm__dose_form_groups_rxcui.b2e6200e1b": {"test_metadata": {"name": "unique", "kwargs": {"column_name": "rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__dose_form_groups')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "unique_stg_rxnorm__dose_form_groups_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "unique_stg_rxnorm__dose_form_groups_rxcui.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.unique_stg_rxnorm__dose_form_groups_rxcui.b2e6200e1b", "fqn": ["sagerx", "staging", "rxnorm", "unique_stg_rxnorm__dose_form_groups_rxcui"], "alias": "unique_stg_rxnorm__dose_form_groups_rxcui", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.1171834, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_rxnorm__dose_form_groups", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__dose_form_groups"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/unique_stg_rxnorm__dose_form_groups_rxcui.sql", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    rxcui as unique_field,\n    count(*) as n_records\n\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__dose_form_groups\"\nwhere rxcui is not null\ngroup by rxcui\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "rxcui", "file_key_name": "models.stg_rxnorm__dose_form_groups", "attached_node": "model.sagerx.stg_rxnorm__dose_form_groups"}, "test.sagerx.not_null_stg_rxnorm__dose_form_groups_rxcui.eca504df20": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__dose_form_groups')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "not_null_stg_rxnorm__dose_form_groups_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "not_null_stg_rxnorm__dose_form_groups_rxcui.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.not_null_stg_rxnorm__dose_form_groups_rxcui.eca504df20", "fqn": ["sagerx", "staging", "rxnorm", "not_null_stg_rxnorm__dose_form_groups_rxcui"], "alias": "not_null_stg_rxnorm__dose_form_groups_rxcui", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.119348, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_rxnorm__dose_form_groups", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__dose_form_groups"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/not_null_stg_rxnorm__dose_form_groups_rxcui.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rxcui\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__dose_form_groups\"\nwhere rxcui is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "rxcui", "file_key_name": "models.stg_rxnorm__dose_form_groups", "attached_node": "model.sagerx.stg_rxnorm__dose_form_groups"}, "test.sagerx.unique_stg_rxnorm__ingredients_rxcui.c6b139419f": {"test_metadata": {"name": "unique", "kwargs": {"column_name": "rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__ingredients')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "unique_stg_rxnorm__ingredients_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "unique_stg_rxnorm__ingredients_rxcui.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.unique_stg_rxnorm__ingredients_rxcui.c6b139419f", "fqn": ["sagerx", "staging", "rxnorm", "unique_stg_rxnorm__ingredients_rxcui"], "alias": "unique_stg_rxnorm__ingredients_rxcui", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.1213074, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_rxnorm__ingredients", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__ingredients"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/unique_stg_rxnorm__ingredients_rxcui.sql", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    rxcui as unique_field,\n    count(*) as n_records\n\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__ingredients\"\nwhere rxcui is not null\ngroup by rxcui\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "rxcui", "file_key_name": "models.stg_rxnorm__ingredients", "attached_node": "model.sagerx.stg_rxnorm__ingredients"}, "test.sagerx.not_null_stg_rxnorm__ingredients_rxcui.24a1dca332": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__ingredients')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "not_null_stg_rxnorm__ingredients_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "not_null_stg_rxnorm__ingredients_rxcui.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.not_null_stg_rxnorm__ingredients_rxcui.24a1dca332", "fqn": ["sagerx", "staging", "rxnorm", "not_null_stg_rxnorm__ingredients_rxcui"], "alias": "not_null_stg_rxnorm__ingredients_rxcui", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.1235874, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_rxnorm__ingredients", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__ingredients"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/not_null_stg_rxnorm__ingredients_rxcui.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rxcui\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__ingredients\"\nwhere rxcui is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "rxcui", "file_key_name": "models.stg_rxnorm__ingredients", "attached_node": "model.sagerx.stg_rxnorm__ingredients"}, "test.sagerx.not_null_stg_rxnorm__ingredient_component_links_ingredient_rxcui.303404889c": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "ingredient_rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__ingredient_component_links')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "not_null_stg_rxnorm__ingredient_component_links_ingredient_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "not_null_stg_rxnorm__ingredien_256eebaa59b47fbaab47776df0dd4303.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.not_null_stg_rxnorm__ingredient_component_links_ingredient_rxcui.303404889c", "fqn": ["sagerx", "staging", "rxnorm", "not_null_stg_rxnorm__ingredient_component_links_ingredient_rxcui"], "alias": "not_null_stg_rxnorm__ingredien_256eebaa59b47fbaab47776df0dd4303", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "not_null_stg_rxnorm__ingredien_256eebaa59b47fbaab47776df0dd4303", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"alias": "not_null_stg_rxnorm__ingredien_256eebaa59b47fbaab47776df0dd4303"}, "created_at": 1703192135.125626, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}{{ config(alias=\"not_null_stg_rxnorm__ingredien_256eebaa59b47fbaab47776df0dd4303\") }}", "language": "sql", "refs": [{"name": "stg_rxnorm__ingredient_component_links", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__ingredient_component_links"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/not_null_stg_rxnorm__ingredien_256eebaa59b47fbaab47776df0dd4303.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingredient_rxcui\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__ingredient_component_links\"\nwhere ingredient_rxcui is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "ingredient_rxcui", "file_key_name": "models.stg_rxnorm__ingredient_component_links", "attached_node": "model.sagerx.stg_rxnorm__ingredient_component_links"}, "test.sagerx.not_null_stg_rxnorm__ingredient_component_links_ingredient_component_rxcui.a6923961b3": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "ingredient_component_rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__ingredient_component_links')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "not_null_stg_rxnorm__ingredient_component_links_ingredient_component_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "not_null_stg_rxnorm__ingredien_73ff0c892ffceac004b1c3fd063eb63f.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.not_null_stg_rxnorm__ingredient_component_links_ingredient_component_rxcui.a6923961b3", "fqn": ["sagerx", "staging", "rxnorm", "not_null_stg_rxnorm__ingredient_component_links_ingredient_component_rxcui"], "alias": "not_null_stg_rxnorm__ingredien_73ff0c892ffceac004b1c3fd063eb63f", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "not_null_stg_rxnorm__ingredien_73ff0c892ffceac004b1c3fd063eb63f", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"alias": "not_null_stg_rxnorm__ingredien_73ff0c892ffceac004b1c3fd063eb63f"}, "created_at": 1703192135.1278281, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}{{ config(alias=\"not_null_stg_rxnorm__ingredien_73ff0c892ffceac004b1c3fd063eb63f\") }}", "language": "sql", "refs": [{"name": "stg_rxnorm__ingredient_component_links", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__ingredient_component_links"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/not_null_stg_rxnorm__ingredien_73ff0c892ffceac004b1c3fd063eb63f.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingredient_component_rxcui\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__ingredient_component_links\"\nwhere ingredient_component_rxcui is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "ingredient_component_rxcui", "file_key_name": "models.stg_rxnorm__ingredient_component_links", "attached_node": "model.sagerx.stg_rxnorm__ingredient_component_links"}, "test.sagerx.unique_stg_rxnorm__ingredient_components_rxcui.75f7804348": {"test_metadata": {"name": "unique", "kwargs": {"column_name": "rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__ingredient_components')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "unique_stg_rxnorm__ingredient_components_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "unique_stg_rxnorm__ingredient_components_rxcui.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.unique_stg_rxnorm__ingredient_components_rxcui.75f7804348", "fqn": ["sagerx", "staging", "rxnorm", "unique_stg_rxnorm__ingredient_components_rxcui"], "alias": "unique_stg_rxnorm__ingredient_components_rxcui", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.1297956, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_rxnorm__ingredient_components", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__ingredient_components"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/unique_stg_rxnorm__ingredient_components_rxcui.sql", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    rxcui as unique_field,\n    count(*) as n_records\n\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__ingredient_components\"\nwhere rxcui is not null\ngroup by rxcui\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "rxcui", "file_key_name": "models.stg_rxnorm__ingredient_components", "attached_node": "model.sagerx.stg_rxnorm__ingredient_components"}, "test.sagerx.not_null_stg_rxnorm__ingredient_components_rxcui.aed8b0d4c5": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__ingredient_components')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "not_null_stg_rxnorm__ingredient_components_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "not_null_stg_rxnorm__ingredient_components_rxcui.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.not_null_stg_rxnorm__ingredient_components_rxcui.aed8b0d4c5", "fqn": ["sagerx", "staging", "rxnorm", "not_null_stg_rxnorm__ingredient_components_rxcui"], "alias": "not_null_stg_rxnorm__ingredient_components_rxcui", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.1317494, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_rxnorm__ingredient_components", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__ingredient_components"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/not_null_stg_rxnorm__ingredient_components_rxcui.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rxcui\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__ingredient_components\"\nwhere rxcui is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "rxcui", "file_key_name": "models.stg_rxnorm__ingredient_components", "attached_node": "model.sagerx.stg_rxnorm__ingredient_components"}, "test.sagerx.accepted_values_stg_rxnorm__ingredient_components_tty__IN.5d941aec74": {"test_metadata": {"name": "accepted_values", "kwargs": {"values": ["IN"], "column_name": "tty", "model": "{{ get_where_subquery(ref('stg_rxnorm__ingredient_components')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "accepted_values_stg_rxnorm__ingredient_components_tty__IN", "resource_type": "test", "package_name": "sagerx", "path": "accepted_values_stg_rxnorm__ingredient_components_tty__IN.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.accepted_values_stg_rxnorm__ingredient_components_tty__IN.5d941aec74", "fqn": ["sagerx", "staging", "rxnorm", "accepted_values_stg_rxnorm__ingredient_components_tty__IN"], "alias": "accepted_values_stg_rxnorm__ingredient_components_tty__IN", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.133726, "relation_name": null, "raw_code": "{{ test_accepted_values(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_rxnorm__ingredient_components", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__ingredient_components"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/accepted_values_stg_rxnorm__ingredient_components_tty__IN.sql", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        tty as value_field,\n        count(*) as n_records\n\n    from \"sagerx\".\"staging\".\"stg_rxnorm__ingredient_components\"\n    group by tty\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'IN'\n)\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "tty", "file_key_name": "models.stg_rxnorm__ingredient_components", "attached_node": "model.sagerx.stg_rxnorm__ingredient_components"}, "test.sagerx.not_null_stg_rxnorm__ingredient_strength_links_clinical_product_component_rxcui.6be28272b5": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "clinical_product_component_rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__ingredient_strength_links')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "not_null_stg_rxnorm__ingredient_strength_links_clinical_product_component_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "not_null_stg_rxnorm__ingredien_0e136dc1bf3f46708433b0712fc4d257.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.not_null_stg_rxnorm__ingredient_strength_links_clinical_product_component_rxcui.6be28272b5", "fqn": ["sagerx", "staging", "rxnorm", "not_null_stg_rxnorm__ingredient_strength_links_clinical_product_component_rxcui"], "alias": "not_null_stg_rxnorm__ingredien_0e136dc1bf3f46708433b0712fc4d257", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "not_null_stg_rxnorm__ingredien_0e136dc1bf3f46708433b0712fc4d257", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"alias": "not_null_stg_rxnorm__ingredien_0e136dc1bf3f46708433b0712fc4d257"}, "created_at": 1703192135.1434968, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}{{ config(alias=\"not_null_stg_rxnorm__ingredien_0e136dc1bf3f46708433b0712fc4d257\") }}", "language": "sql", "refs": [{"name": "stg_rxnorm__ingredient_strength_links", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__ingredient_strength_links"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/not_null_stg_rxnorm__ingredien_0e136dc1bf3f46708433b0712fc4d257.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect clinical_product_component_rxcui\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__ingredient_strength_links\"\nwhere clinical_product_component_rxcui is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "clinical_product_component_rxcui", "file_key_name": "models.stg_rxnorm__ingredient_strength_links", "attached_node": "model.sagerx.stg_rxnorm__ingredient_strength_links"}, "test.sagerx.not_null_stg_rxnorm__ingredient_strength_links_ingredient_component_rxcui.fec66d7333": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "ingredient_component_rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__ingredient_strength_links')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "not_null_stg_rxnorm__ingredient_strength_links_ingredient_component_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "not_null_stg_rxnorm__ingredien_3109d8d3c477102b98c75251c8f54b7f.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.not_null_stg_rxnorm__ingredient_strength_links_ingredient_component_rxcui.fec66d7333", "fqn": ["sagerx", "staging", "rxnorm", "not_null_stg_rxnorm__ingredient_strength_links_ingredient_component_rxcui"], "alias": "not_null_stg_rxnorm__ingredien_3109d8d3c477102b98c75251c8f54b7f", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "not_null_stg_rxnorm__ingredien_3109d8d3c477102b98c75251c8f54b7f", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"alias": "not_null_stg_rxnorm__ingredien_3109d8d3c477102b98c75251c8f54b7f"}, "created_at": 1703192135.1454787, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}{{ config(alias=\"not_null_stg_rxnorm__ingredien_3109d8d3c477102b98c75251c8f54b7f\") }}", "language": "sql", "refs": [{"name": "stg_rxnorm__ingredient_strength_links", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__ingredient_strength_links"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/not_null_stg_rxnorm__ingredien_3109d8d3c477102b98c75251c8f54b7f.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingredient_component_rxcui\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__ingredient_strength_links\"\nwhere ingredient_component_rxcui is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "ingredient_component_rxcui", "file_key_name": "models.stg_rxnorm__ingredient_strength_links", "attached_node": "model.sagerx.stg_rxnorm__ingredient_strength_links"}, "test.sagerx.not_null_stg_rxnorm__ingredient_strength_links_ingredient_strength_rxcui.3527b30bda": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "ingredient_strength_rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__ingredient_strength_links')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "not_null_stg_rxnorm__ingredient_strength_links_ingredient_strength_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "not_null_stg_rxnorm__ingredien_f117a3323fa2904438079e55ee840b9c.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.not_null_stg_rxnorm__ingredient_strength_links_ingredient_strength_rxcui.3527b30bda", "fqn": ["sagerx", "staging", "rxnorm", "not_null_stg_rxnorm__ingredient_strength_links_ingredient_strength_rxcui"], "alias": "not_null_stg_rxnorm__ingredien_f117a3323fa2904438079e55ee840b9c", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "not_null_stg_rxnorm__ingredien_f117a3323fa2904438079e55ee840b9c", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"alias": "not_null_stg_rxnorm__ingredien_f117a3323fa2904438079e55ee840b9c"}, "created_at": 1703192135.147605, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}{{ config(alias=\"not_null_stg_rxnorm__ingredien_f117a3323fa2904438079e55ee840b9c\") }}", "language": "sql", "refs": [{"name": "stg_rxnorm__ingredient_strength_links", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__ingredient_strength_links"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/not_null_stg_rxnorm__ingredien_f117a3323fa2904438079e55ee840b9c.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingredient_strength_rxcui\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__ingredient_strength_links\"\nwhere ingredient_strength_rxcui is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "ingredient_strength_rxcui", "file_key_name": "models.stg_rxnorm__ingredient_strength_links", "attached_node": "model.sagerx.stg_rxnorm__ingredient_strength_links"}, "test.sagerx.unique_stg_rxnorm__ingredient_strengths_rxcui.716f558a6b": {"test_metadata": {"name": "unique", "kwargs": {"column_name": "rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__ingredient_strengths')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "unique_stg_rxnorm__ingredient_strengths_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "unique_stg_rxnorm__ingredient_strengths_rxcui.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.unique_stg_rxnorm__ingredient_strengths_rxcui.716f558a6b", "fqn": ["sagerx", "staging", "rxnorm", "unique_stg_rxnorm__ingredient_strengths_rxcui"], "alias": "unique_stg_rxnorm__ingredient_strengths_rxcui", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.1495798, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_rxnorm__ingredient_strengths", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__ingredient_strengths"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/unique_stg_rxnorm__ingredient_strengths_rxcui.sql", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    rxcui as unique_field,\n    count(*) as n_records\n\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__ingredient_strengths\"\nwhere rxcui is not null\ngroup by rxcui\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "rxcui", "file_key_name": "models.stg_rxnorm__ingredient_strengths", "attached_node": "model.sagerx.stg_rxnorm__ingredient_strengths"}, "test.sagerx.not_null_stg_rxnorm__ingredient_strengths_rxcui.d4a27e753c": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__ingredient_strengths')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "not_null_stg_rxnorm__ingredient_strengths_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "not_null_stg_rxnorm__ingredient_strengths_rxcui.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.not_null_stg_rxnorm__ingredient_strengths_rxcui.d4a27e753c", "fqn": ["sagerx", "staging", "rxnorm", "not_null_stg_rxnorm__ingredient_strengths_rxcui"], "alias": "not_null_stg_rxnorm__ingredient_strengths_rxcui", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.151535, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_rxnorm__ingredient_strengths", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__ingredient_strengths"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/not_null_stg_rxnorm__ingredient_strengths_rxcui.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rxcui\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__ingredient_strengths\"\nwhere rxcui is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "rxcui", "file_key_name": "models.stg_rxnorm__ingredient_strengths", "attached_node": "model.sagerx.stg_rxnorm__ingredient_strengths"}, "test.sagerx.not_null_stg_rxnorm__mthspl_products_rxcui.21eb3d19b0": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__mthspl_products')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "not_null_stg_rxnorm__mthspl_products_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "not_null_stg_rxnorm__mthspl_products_rxcui.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.not_null_stg_rxnorm__mthspl_products_rxcui.21eb3d19b0", "fqn": ["sagerx", "staging", "rxnorm", "not_null_stg_rxnorm__mthspl_products_rxcui"], "alias": "not_null_stg_rxnorm__mthspl_products_rxcui", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.1535194, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_rxnorm__mthspl_products", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__mthspl_products"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/not_null_stg_rxnorm__mthspl_products_rxcui.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rxcui\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__mthspl_products\"\nwhere rxcui is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "rxcui", "file_key_name": "models.stg_rxnorm__mthspl_products", "attached_node": "model.sagerx.stg_rxnorm__mthspl_products"}, "test.sagerx.not_null_stg_rxnorm__mthspl_substances_rxcui.1b38748ca6": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__mthspl_substances')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "not_null_stg_rxnorm__mthspl_substances_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "not_null_stg_rxnorm__mthspl_substances_rxcui.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.not_null_stg_rxnorm__mthspl_substances_rxcui.1b38748ca6", "fqn": ["sagerx", "staging", "rxnorm", "not_null_stg_rxnorm__mthspl_substances_rxcui"], "alias": "not_null_stg_rxnorm__mthspl_substances_rxcui", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.155721, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_rxnorm__mthspl_substances", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__mthspl_substances"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/not_null_stg_rxnorm__mthspl_substances_rxcui.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rxcui\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__mthspl_substances\"\nwhere rxcui is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "rxcui", "file_key_name": "models.stg_rxnorm__mthspl_substances", "attached_node": "model.sagerx.stg_rxnorm__mthspl_substances"}, "test.sagerx.unique_stg_rxnorm__brand_products_rxcui.da77867bbd": {"test_metadata": {"name": "unique", "kwargs": {"column_name": "rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__brand_products')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "unique_stg_rxnorm__brand_products_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "unique_stg_rxnorm__brand_products_rxcui.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.unique_stg_rxnorm__brand_products_rxcui.da77867bbd", "fqn": ["sagerx", "staging", "rxnorm", "unique_stg_rxnorm__brand_products_rxcui"], "alias": "unique_stg_rxnorm__brand_products_rxcui", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.1576927, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_rxnorm__brand_products", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__brand_products"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/unique_stg_rxnorm__brand_products_rxcui.sql", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    rxcui as unique_field,\n    count(*) as n_records\n\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__brand_products\"\nwhere rxcui is not null\ngroup by rxcui\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "rxcui", "file_key_name": "models.stg_rxnorm__brand_products", "attached_node": "model.sagerx.stg_rxnorm__brand_products"}, "test.sagerx.not_null_stg_rxnorm__brand_products_rxcui.634ef0c2ff": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__brand_products')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "not_null_stg_rxnorm__brand_products_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "not_null_stg_rxnorm__brand_products_rxcui.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.not_null_stg_rxnorm__brand_products_rxcui.634ef0c2ff", "fqn": ["sagerx", "staging", "rxnorm", "not_null_stg_rxnorm__brand_products_rxcui"], "alias": "not_null_stg_rxnorm__brand_products_rxcui", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.1596375, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_rxnorm__brand_products", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__brand_products"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/not_null_stg_rxnorm__brand_products_rxcui.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rxcui\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__brand_products\"\nwhere rxcui is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "rxcui", "file_key_name": "models.stg_rxnorm__brand_products", "attached_node": "model.sagerx.stg_rxnorm__brand_products"}, "test.sagerx.not_null_stg_rxnorm__brand_product_component_links_brand_product_rxcui.6135a1fa50": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "brand_product_rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__brand_product_component_links')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "not_null_stg_rxnorm__brand_product_component_links_brand_product_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "not_null_stg_rxnorm__brand_pro_a0455471671e7fb10ea436b1ff7c98e3.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.not_null_stg_rxnorm__brand_product_component_links_brand_product_rxcui.6135a1fa50", "fqn": ["sagerx", "staging", "rxnorm", "not_null_stg_rxnorm__brand_product_component_links_brand_product_rxcui"], "alias": "not_null_stg_rxnorm__brand_pro_a0455471671e7fb10ea436b1ff7c98e3", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "not_null_stg_rxnorm__brand_pro_a0455471671e7fb10ea436b1ff7c98e3", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"alias": "not_null_stg_rxnorm__brand_pro_a0455471671e7fb10ea436b1ff7c98e3"}, "created_at": 1703192135.1616142, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}{{ config(alias=\"not_null_stg_rxnorm__brand_pro_a0455471671e7fb10ea436b1ff7c98e3\") }}", "language": "sql", "refs": [{"name": "stg_rxnorm__brand_product_component_links", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__brand_product_component_links"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/not_null_stg_rxnorm__brand_pro_a0455471671e7fb10ea436b1ff7c98e3.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect brand_product_rxcui\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__brand_product_component_links\"\nwhere brand_product_rxcui is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "brand_product_rxcui", "file_key_name": "models.stg_rxnorm__brand_product_component_links", "attached_node": "model.sagerx.stg_rxnorm__brand_product_component_links"}, "test.sagerx.not_null_stg_rxnorm__brand_product_component_links_brand_product_component_rxcui.9f497ef16e": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "brand_product_component_rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__brand_product_component_links')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "not_null_stg_rxnorm__brand_product_component_links_brand_product_component_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "not_null_stg_rxnorm__brand_pro_23ac4adf78100fbcdcd277bae35c9e46.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.not_null_stg_rxnorm__brand_product_component_links_brand_product_component_rxcui.9f497ef16e", "fqn": ["sagerx", "staging", "rxnorm", "not_null_stg_rxnorm__brand_product_component_links_brand_product_component_rxcui"], "alias": "not_null_stg_rxnorm__brand_pro_23ac4adf78100fbcdcd277bae35c9e46", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "not_null_stg_rxnorm__brand_pro_23ac4adf78100fbcdcd277bae35c9e46", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"alias": "not_null_stg_rxnorm__brand_pro_23ac4adf78100fbcdcd277bae35c9e46"}, "created_at": 1703192135.1640656, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}{{ config(alias=\"not_null_stg_rxnorm__brand_pro_23ac4adf78100fbcdcd277bae35c9e46\") }}", "language": "sql", "refs": [{"name": "stg_rxnorm__brand_product_component_links", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__brand_product_component_links"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/not_null_stg_rxnorm__brand_pro_23ac4adf78100fbcdcd277bae35c9e46.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect brand_product_component_rxcui\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__brand_product_component_links\"\nwhere brand_product_component_rxcui is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "brand_product_component_rxcui", "file_key_name": "models.stg_rxnorm__brand_product_component_links", "attached_node": "model.sagerx.stg_rxnorm__brand_product_component_links"}, "test.sagerx.unique_stg_rxnorm__brand_product_components_rxcui.cd3b918573": {"test_metadata": {"name": "unique", "kwargs": {"column_name": "rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__brand_product_components')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "unique_stg_rxnorm__brand_product_components_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "unique_stg_rxnorm__brand_product_components_rxcui.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.unique_stg_rxnorm__brand_product_components_rxcui.cd3b918573", "fqn": ["sagerx", "staging", "rxnorm", "unique_stg_rxnorm__brand_product_components_rxcui"], "alias": "unique_stg_rxnorm__brand_product_components_rxcui", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.1660624, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_rxnorm__brand_product_components", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__brand_product_components"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/unique_stg_rxnorm__brand_product_components_rxcui.sql", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    rxcui as unique_field,\n    count(*) as n_records\n\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__brand_product_components\"\nwhere rxcui is not null\ngroup by rxcui\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "rxcui", "file_key_name": "models.stg_rxnorm__brand_product_components", "attached_node": "model.sagerx.stg_rxnorm__brand_product_components"}, "test.sagerx.not_null_stg_rxnorm__brand_product_components_rxcui.4917a3f0ca": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__brand_product_components')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "not_null_stg_rxnorm__brand_product_components_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "not_null_stg_rxnorm__brand_product_components_rxcui.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.not_null_stg_rxnorm__brand_product_components_rxcui.4917a3f0ca", "fqn": ["sagerx", "staging", "rxnorm", "not_null_stg_rxnorm__brand_product_components_rxcui"], "alias": "not_null_stg_rxnorm__brand_product_components_rxcui", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.1680226, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_rxnorm__brand_product_components", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__brand_product_components"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/not_null_stg_rxnorm__brand_product_components_rxcui.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rxcui\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__brand_product_components\"\nwhere rxcui is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "rxcui", "file_key_name": "models.stg_rxnorm__brand_product_components", "attached_node": "model.sagerx.stg_rxnorm__brand_product_components"}, "test.sagerx.not_null_stg_rxnorm__brand_product_components_clinical_product_component_rxcui.25fdaf356b": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "clinical_product_component_rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__brand_product_components')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "not_null_stg_rxnorm__brand_product_components_clinical_product_component_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "not_null_stg_rxnorm__brand_pro_8a3c0a2a6e5d51cf23cd68cab747c324.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.not_null_stg_rxnorm__brand_product_components_clinical_product_component_rxcui.25fdaf356b", "fqn": ["sagerx", "staging", "rxnorm", "not_null_stg_rxnorm__brand_product_components_clinical_product_component_rxcui"], "alias": "not_null_stg_rxnorm__brand_pro_8a3c0a2a6e5d51cf23cd68cab747c324", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": "not_null_stg_rxnorm__brand_pro_8a3c0a2a6e5d51cf23cd68cab747c324", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {"alias": "not_null_stg_rxnorm__brand_pro_8a3c0a2a6e5d51cf23cd68cab747c324"}, "created_at": 1703192135.170012, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}{{ config(alias=\"not_null_stg_rxnorm__brand_pro_8a3c0a2a6e5d51cf23cd68cab747c324\") }}", "language": "sql", "refs": [{"name": "stg_rxnorm__brand_product_components", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__brand_product_components"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/not_null_stg_rxnorm__brand_pro_8a3c0a2a6e5d51cf23cd68cab747c324.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect clinical_product_component_rxcui\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__brand_product_components\"\nwhere clinical_product_component_rxcui is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "clinical_product_component_rxcui", "file_key_name": "models.stg_rxnorm__brand_product_components", "attached_node": "model.sagerx.stg_rxnorm__brand_product_components"}, "test.sagerx.unique_stg_rxnorm__brands_rxcui.a2c8cd0cd0": {"test_metadata": {"name": "unique", "kwargs": {"column_name": "rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__brands')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "unique_stg_rxnorm__brands_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "unique_stg_rxnorm__brands_rxcui.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.unique_stg_rxnorm__brands_rxcui.a2c8cd0cd0", "fqn": ["sagerx", "staging", "rxnorm", "unique_stg_rxnorm__brands_rxcui"], "alias": "unique_stg_rxnorm__brands_rxcui", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.1721432, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_rxnorm__brands", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__brands"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/unique_stg_rxnorm__brands_rxcui.sql", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    rxcui as unique_field,\n    count(*) as n_records\n\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__brands\"\nwhere rxcui is not null\ngroup by rxcui\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "rxcui", "file_key_name": "models.stg_rxnorm__brands", "attached_node": "model.sagerx.stg_rxnorm__brands"}, "test.sagerx.not_null_stg_rxnorm__brands_rxcui.d067686860": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "rxcui", "model": "{{ get_where_subquery(ref('stg_rxnorm__brands')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "not_null_stg_rxnorm__brands_rxcui", "resource_type": "test", "package_name": "sagerx", "path": "not_null_stg_rxnorm__brands_rxcui.sql", "original_file_path": "models/staging/rxnorm/_rxnorm__models.yml", "unique_id": "test.sagerx.not_null_stg_rxnorm__brands_rxcui.d067686860", "fqn": ["sagerx", "staging", "rxnorm", "not_null_stg_rxnorm__brands_rxcui"], "alias": "not_null_stg_rxnorm__brands_rxcui", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.1741743, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_rxnorm__brands", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_rxnorm__brands"]}, "compiled_path": "target/compiled/sagerx/models/staging/rxnorm/_rxnorm__models.yml/not_null_stg_rxnorm__brands_rxcui.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rxcui\nfrom \"sagerx\".\"staging\".\"stg_rxnorm__brands\"\nwhere rxcui is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "rxcui", "file_key_name": "models.stg_rxnorm__brands", "attached_node": "model.sagerx.stg_rxnorm__brands"}, "test.sagerx.unique_stg_fda_ndc__ndc_ndc11.60276e520c": {"test_metadata": {"name": "unique", "kwargs": {"column_name": "ndc11", "model": "{{ get_where_subquery(ref('stg_fda_ndc__ndc')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "unique_stg_fda_ndc__ndc_ndc11", "resource_type": "test", "package_name": "sagerx", "path": "unique_stg_fda_ndc__ndc_ndc11.sql", "original_file_path": "models/staging/fda_ndc/_fda_ndc__models.yml", "unique_id": "test.sagerx.unique_stg_fda_ndc__ndc_ndc11.60276e520c", "fqn": ["sagerx", "staging", "fda_ndc", "unique_stg_fda_ndc__ndc_ndc11"], "alias": "unique_stg_fda_ndc__ndc_ndc11", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.2065883, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_fda_ndc__ndc", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_fda_ndc__ndc"]}, "compiled_path": "target/compiled/sagerx/models/staging/fda_ndc/_fda_ndc__models.yml/unique_stg_fda_ndc__ndc_ndc11.sql", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ndc11 as unique_field,\n    count(*) as n_records\n\nfrom \"sagerx\".\"staging\".\"stg_fda_ndc__ndc\"\nwhere ndc11 is not null\ngroup by ndc11\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "ndc11", "file_key_name": "models.stg_fda_ndc__ndc", "attached_node": "model.sagerx.stg_fda_ndc__ndc"}, "test.sagerx.not_null_stg_fda_ndc__ndc_ndc11.c94b597c0b": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "ndc11", "model": "{{ get_where_subquery(ref('stg_fda_ndc__ndc')) }}"}, "namespace": null}, "database": "sagerx", "schema": "dbt_test__audit", "name": "not_null_stg_fda_ndc__ndc_ndc11", "resource_type": "test", "package_name": "sagerx", "path": "not_null_stg_fda_ndc__ndc_ndc11.sql", "original_file_path": "models/staging/fda_ndc/_fda_ndc__models.yml", "unique_id": "test.sagerx.not_null_stg_fda_ndc__ndc_ndc11.c94b597c0b", "fqn": ["sagerx", "staging", "fda_ndc", "not_null_stg_fda_ndc__ndc_ndc11"], "alias": "not_null_stg_fda_ndc__ndc_ndc11", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1703192135.2086346, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [{"name": "stg_fda_ndc__ndc", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.sagerx.stg_fda_ndc__ndc"]}, "compiled_path": "target/compiled/sagerx/models/staging/fda_ndc/_fda_ndc__models.yml/not_null_stg_fda_ndc__ndc_ndc11.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ndc11\nfrom \"sagerx\".\"staging\".\"stg_fda_ndc__ndc\"\nwhere ndc11 is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "checksum": null}, "column_name": "ndc11", "file_key_name": "models.stg_fda_ndc__ndc", "attached_node": "model.sagerx.stg_fda_ndc__ndc"}}, "sources": {"source.sagerx.rxnorm.rxnorm_rxnatomarchive": {"database": "sagerx", "schema": "datasource", "name": "rxnorm_rxnatomarchive", "resource_type": "source", "package_name": "sagerx", "path": "models/staging/rxnorm/_rxnorm__sources.yml", "original_file_path": "models/staging/rxnorm/_rxnorm__sources.yml", "unique_id": "source.sagerx.rxnorm.rxnorm_rxnatomarchive", "fqn": ["sagerx", "staging", "rxnorm", "rxnorm", "rxnorm_rxnatomarchive"], "source_name": "rxnorm", "source_description": "", "loader": "", "identifier": "rxnorm_rxnatomarchive", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"sagerx\".\"datasource\".\"rxnorm_rxnatomarchive\"", "created_at": 1703192135.210164}, "source.sagerx.rxnorm.rxnorm_rxnconso": {"database": "sagerx", "schema": "datasource", "name": "rxnorm_rxnconso", "resource_type": "source", "package_name": "sagerx", "path": "models/staging/rxnorm/_rxnorm__sources.yml", "original_file_path": "models/staging/rxnorm/_rxnorm__sources.yml", "unique_id": "source.sagerx.rxnorm.rxnorm_rxnconso", "fqn": ["sagerx", "staging", "rxnorm", "rxnorm", "rxnorm_rxnconso"], "source_name": "rxnorm", "source_description": "", "loader": "", "identifier": "rxnorm_rxnconso", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"sagerx\".\"datasource\".\"rxnorm_rxnconso\"", "created_at": 1703192135.2103693}, "source.sagerx.rxnorm.rxnorm_rxncui": {"database": "sagerx", "schema": "datasource", "name": "rxnorm_rxncui", "resource_type": "source", "package_name": "sagerx", "path": "models/staging/rxnorm/_rxnorm__sources.yml", "original_file_path": "models/staging/rxnorm/_rxnorm__sources.yml", "unique_id": "source.sagerx.rxnorm.rxnorm_rxncui", "fqn": ["sagerx", "staging", "rxnorm", "rxnorm", "rxnorm_rxncui"], "source_name": "rxnorm", "source_description": "", "loader": "", "identifier": "rxnorm_rxncui", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"sagerx\".\"datasource\".\"rxnorm_rxncui\"", "created_at": 1703192135.2105384}, "source.sagerx.rxnorm.rxnorm_rxncuichanges": {"database": "sagerx", "schema": "datasource", "name": "rxnorm_rxncuichanges", "resource_type": "source", "package_name": "sagerx", "path": "models/staging/rxnorm/_rxnorm__sources.yml", "original_file_path": "models/staging/rxnorm/_rxnorm__sources.yml", "unique_id": "source.sagerx.rxnorm.rxnorm_rxncuichanges", "fqn": ["sagerx", "staging", "rxnorm", "rxnorm", "rxnorm_rxncuichanges"], "source_name": "rxnorm", "source_description": "", "loader": "", "identifier": "rxnorm_rxncuichanges", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"sagerx\".\"datasource\".\"rxnorm_rxncuichanges\"", "created_at": 1703192135.210702}, "source.sagerx.rxnorm.rxnorm_rxndoc": {"database": "sagerx", "schema": "datasource", "name": "rxnorm_rxndoc", "resource_type": "source", "package_name": "sagerx", "path": "models/staging/rxnorm/_rxnorm__sources.yml", "original_file_path": "models/staging/rxnorm/_rxnorm__sources.yml", "unique_id": "source.sagerx.rxnorm.rxnorm_rxndoc", "fqn": ["sagerx", "staging", "rxnorm", "rxnorm", "rxnorm_rxndoc"], "source_name": "rxnorm", "source_description": "", "loader": "", "identifier": "rxnorm_rxndoc", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"sagerx\".\"datasource\".\"rxnorm_rxndoc\"", "created_at": 1703192135.2108607}, "source.sagerx.rxnorm.rxnorm_rxnrel": {"database": "sagerx", "schema": "datasource", "name": "rxnorm_rxnrel", "resource_type": "source", "package_name": "sagerx", "path": "models/staging/rxnorm/_rxnorm__sources.yml", "original_file_path": "models/staging/rxnorm/_rxnorm__sources.yml", "unique_id": "source.sagerx.rxnorm.rxnorm_rxnrel", "fqn": ["sagerx", "staging", "rxnorm", "rxnorm", "rxnorm_rxnrel"], "source_name": "rxnorm", "source_description": "", "loader": "", "identifier": "rxnorm_rxnrel", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"sagerx\".\"datasource\".\"rxnorm_rxnrel\"", "created_at": 1703192135.2110164}, "source.sagerx.rxnorm.rxnorm_rxnsab": {"database": "sagerx", "schema": "datasource", "name": "rxnorm_rxnsab", "resource_type": "source", "package_name": "sagerx", "path": "models/staging/rxnorm/_rxnorm__sources.yml", "original_file_path": "models/staging/rxnorm/_rxnorm__sources.yml", "unique_id": "source.sagerx.rxnorm.rxnorm_rxnsab", "fqn": ["sagerx", "staging", "rxnorm", "rxnorm", "rxnorm_rxnsab"], "source_name": "rxnorm", "source_description": "", "loader": "", "identifier": "rxnorm_rxnsab", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"sagerx\".\"datasource\".\"rxnorm_rxnsab\"", "created_at": 1703192135.2111742}, "source.sagerx.rxnorm.rxnorm_rxnsat": {"database": "sagerx", "schema": "datasource", "name": "rxnorm_rxnsat", "resource_type": "source", "package_name": "sagerx", "path": "models/staging/rxnorm/_rxnorm__sources.yml", "original_file_path": "models/staging/rxnorm/_rxnorm__sources.yml", "unique_id": "source.sagerx.rxnorm.rxnorm_rxnsat", "fqn": ["sagerx", "staging", "rxnorm", "rxnorm", "rxnorm_rxnsat"], "source_name": "rxnorm", "source_description": "", "loader": "", "identifier": "rxnorm_rxnsat", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"sagerx\".\"datasource\".\"rxnorm_rxnsat\"", "created_at": 1703192135.2113366}, "source.sagerx.rxnorm.rxnorm_rxnsty": {"database": "sagerx", "schema": "datasource", "name": "rxnorm_rxnsty", "resource_type": "source", "package_name": "sagerx", "path": "models/staging/rxnorm/_rxnorm__sources.yml", "original_file_path": "models/staging/rxnorm/_rxnorm__sources.yml", "unique_id": "source.sagerx.rxnorm.rxnorm_rxnsty", "fqn": ["sagerx", "staging", "rxnorm", "rxnorm", "rxnorm_rxnsty"], "source_name": "rxnorm", "source_description": "", "loader": "", "identifier": "rxnorm_rxnsty", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"sagerx\".\"datasource\".\"rxnorm_rxnsty\"", "created_at": 1703192135.2114887}, "source.sagerx.fda_enforcement.fda_enforcement": {"database": "sagerx", "schema": "datasource", "name": "fda_enforcement", "resource_type": "source", "package_name": "sagerx", "path": "models/staging/fda_enforcement/_fda_enforcement__sources.yml", "original_file_path": "models/staging/fda_enforcement/_fda_enforcement__sources.yml", "unique_id": "source.sagerx.fda_enforcement.fda_enforcement", "fqn": ["sagerx", "staging", "fda_enforcement", "fda_enforcement", "fda_enforcement"], "source_name": "fda_enforcement", "source_description": "", "loader": "", "identifier": "fda_enforcement", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"sagerx\".\"datasource\".\"fda_enforcement\"", "created_at": 1703192135.2116349}, "source.sagerx.rxnorm_historical.rxnorm_historical": {"database": "sagerx", "schema": "datasource", "name": "rxnorm_historical", "resource_type": "source", "package_name": "sagerx", "path": "models/staging/rxnorm_historical/_rxnorm_historical__sources.yml", "original_file_path": "models/staging/rxnorm_historical/_rxnorm_historical__sources.yml", "unique_id": "source.sagerx.rxnorm_historical.rxnorm_historical", "fqn": ["sagerx", "staging", "rxnorm_historical", "rxnorm_historical", "rxnorm_historical"], "source_name": "rxnorm_historical", "source_description": "", "loader": "", "identifier": "rxnorm_historical", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"sagerx\".\"datasource\".\"rxnorm_historical\"", "created_at": 1703192135.2117808}, "source.sagerx.fda_ndc.fda_ndc_product": {"database": "sagerx", "schema": "datasource", "name": "fda_ndc_product", "resource_type": "source", "package_name": "sagerx", "path": "models/staging/fda_ndc/_fda_ndc__sources.yml", "original_file_path": "models/staging/fda_ndc/_fda_ndc__sources.yml", "unique_id": "source.sagerx.fda_ndc.fda_ndc_product", "fqn": ["sagerx", "staging", "fda_ndc", "fda_ndc", "fda_ndc_product"], "source_name": "fda_ndc", "source_description": "", "loader": "", "identifier": "fda_ndc_product", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"sagerx\".\"datasource\".\"fda_ndc_product\"", "created_at": 1703192135.2119243}, "source.sagerx.fda_ndc.fda_ndc_package": {"database": "sagerx", "schema": "datasource", "name": "fda_ndc_package", "resource_type": "source", "package_name": "sagerx", "path": "models/staging/fda_ndc/_fda_ndc__sources.yml", "original_file_path": "models/staging/fda_ndc/_fda_ndc__sources.yml", "unique_id": "source.sagerx.fda_ndc.fda_ndc_package", "fqn": ["sagerx", "staging", "fda_ndc", "fda_ndc", "fda_ndc_package"], "source_name": "fda_ndc", "source_description": "", "loader": "", "identifier": "fda_ndc_package", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"sagerx\".\"datasource\".\"fda_ndc_package\"", "created_at": 1703192135.212067}}, "macros": {"macro.sagerx.generate_schema_name": {"name": "generate_schema_name", "resource_type": "macro", "package_name": "sagerx", "path": "macros/get_custom_schema.sql", "original_file_path": "macros/get_custom_schema.sql", "unique_id": "macro.sagerx.generate_schema_name", "macro_sql": "{% macro generate_schema_name(custom_schema_name, node) -%}\n\n    {%- set default_schema = target.schema -%}\n    {%- if custom_schema_name is none -%}\n\n        {{ default_schema }}\n\n    {%- else -%}\n\n        {{ custom_schema_name | trim }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4093177, "supported_languages": null}, "macro.dbt_postgres.postgres_get_relations": {"name": "postgres_get_relations", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/relations.sql", "original_file_path": "macros/relations.sql", "unique_id": "macro.dbt_postgres.postgres_get_relations", "macro_sql": "{% macro postgres_get_relations () -%}\n\n  {#\n      -- in pg_depend, objid is the dependent, refobjid is the referenced object\n      --  > a pg_depend entry indicates that the referenced object cannot be\n      --  > dropped without also dropping the dependent object.\n  #}\n\n  {%- call statement('relations', fetch_result=True) -%}\n    with relation as (\n        select\n            pg_rewrite.ev_class as class,\n            pg_rewrite.oid as id\n        from pg_rewrite\n    ),\n    class as (\n        select\n            oid as id,\n            relname as name,\n            relnamespace as schema,\n            relkind as kind\n        from pg_class\n    ),\n    dependency as (\n        select distinct\n            pg_depend.objid as id,\n            pg_depend.refobjid as ref\n        from pg_depend\n    ),\n    schema as (\n        select\n            pg_namespace.oid as id,\n            pg_namespace.nspname as name\n        from pg_namespace\n        where nspname != 'information_schema' and nspname not like 'pg\\_%'\n    ),\n    referenced as (\n        select\n            relation.id AS id,\n            referenced_class.name ,\n            referenced_class.schema ,\n            referenced_class.kind\n        from relation\n        join class as referenced_class on relation.class=referenced_class.id\n        where referenced_class.kind in ('r', 'v')\n    ),\n    relationships as (\n        select\n            referenced.name as referenced_name,\n            referenced.schema as referenced_schema_id,\n            dependent_class.name as dependent_name,\n            dependent_class.schema as dependent_schema_id,\n            referenced.kind as kind\n        from referenced\n        join dependency on referenced.id=dependency.id\n        join class as dependent_class on dependency.ref=dependent_class.id\n        where\n            (referenced.name != dependent_class.name or\n             referenced.schema != dependent_class.schema)\n    )\n\n    select\n        referenced_schema.name as referenced_schema,\n        relationships.referenced_name as referenced_name,\n        dependent_schema.name as dependent_schema,\n        relationships.dependent_name as dependent_name\n    from relationships\n    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id\n    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id\n    group by referenced_schema, referenced_name, dependent_schema, dependent_name\n    order by referenced_schema, referenced_name, dependent_schema, dependent_name;\n\n  {%- endcall -%}\n\n  {{ return(load_result('relations').table) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4115205, "supported_languages": null}, "macro.dbt_postgres.postgres__get_catalog": {"name": "postgres__get_catalog", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/catalog.sql", "original_file_path": "macros/catalog.sql", "unique_id": "macro.dbt_postgres.postgres__get_catalog", "macro_sql": "{% macro postgres__get_catalog(information_schema, schemas) -%}\n\n  {%- call statement('catalog', fetch_result=True) -%}\n    {#\n      If the user has multiple databases set and the first one is wrong, this will fail.\n      But we won't fail in the case where there are multiple quoting-difference-only dbs, which is better.\n    #}\n    {% set database = information_schema.database %}\n    {{ adapter.verify_database(database) }}\n\n    select\n        '{{ database }}' as table_database,\n        sch.nspname as table_schema,\n        tbl.relname as table_name,\n        case tbl.relkind\n            when 'v' then 'VIEW'\n            else 'BASE TABLE'\n        end as table_type,\n        tbl_desc.description as table_comment,\n        col.attname as column_name,\n        col.attnum as column_index,\n        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,\n        col_desc.description as column_comment,\n        pg_get_userbyid(tbl.relowner) as table_owner\n\n    from pg_catalog.pg_namespace sch\n    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid\n    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid\n    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)\n    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)\n\n    where (\n        {%- for schema in schemas -%}\n          upper(sch.nspname) = upper('{{ schema }}'){%- if not loop.last %} or {% endif -%}\n        {%- endfor -%}\n      )\n      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session\n      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables\n      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view\n      and col.attnum > 0 -- negative numbers are used for system columns such as oid\n      and not col.attisdropped -- column as not been dropped\n\n    order by\n        sch.nspname,\n        tbl.relname,\n        col.attnum\n\n  {%- endcall -%}\n\n  {{ return(load_result('catalog').table) }}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.413073, "supported_languages": null}, "macro.dbt_postgres.postgres__create_table_as": {"name": "postgres__create_table_as", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__create_table_as", "macro_sql": "{% macro postgres__create_table_as(temporary, relation, sql) -%}\n  {%- set unlogged = config.get('unlogged', default=false) -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {{ sql_header if sql_header is not none }}\n\n  create {% if temporary -%}\n    temporary\n  {%- elif unlogged -%}\n    unlogged\n  {%- endif %} table {{ relation }}\n  {% set contract_config = config.get('contract') %}\n  {% if contract_config.enforced %}\n    {{ get_assert_columns_equivalent(sql) }}\n    {{ get_table_columns_and_constraints() }} ;\n    insert into {{ relation }} {{ get_column_names() }}\n    {%- set sql = get_select_subquery(sql) %}\n  {% else %}\n    as\n  {% endif %}\n  (\n    {{ sql }}\n  );\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.get_assert_columns_equivalent", "macro.dbt.get_table_columns_and_constraints", "macro.dbt_postgres.get_column_names", "macro.dbt.get_select_subquery"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4274263, "supported_languages": null}, "macro.dbt_postgres.postgres__get_create_index_sql": {"name": "postgres__get_create_index_sql", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__get_create_index_sql", "macro_sql": "{% macro postgres__get_create_index_sql(relation, index_dict) -%}\n  {%- set index_config = adapter.parse_index(index_dict) -%}\n  {%- set comma_separated_columns = \", \".join(index_config.columns) -%}\n  {%- set index_name = index_config.render(relation) -%}\n\n  create {% if index_config.unique -%}\n    unique\n  {%- endif %} index if not exists\n  \"{{ index_name }}\"\n  on {{ relation }} {% if index_config.type -%}\n    using {{ index_config.type }}\n  {%- endif %}\n  ({{ comma_separated_columns }});\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.428183, "supported_languages": null}, "macro.dbt_postgres.postgres__create_schema": {"name": "postgres__create_schema", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__create_schema", "macro_sql": "{% macro postgres__create_schema(relation) -%}\n  {% if relation.database -%}\n    {{ adapter.verify_database(relation.database) }}\n  {%- endif -%}\n  {%- call statement('create_schema') -%}\n    create schema if not exists {{ relation.without_identifier().include(database=False) }}\n  {%- endcall -%}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4286902, "supported_languages": null}, "macro.dbt_postgres.postgres__drop_schema": {"name": "postgres__drop_schema", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__drop_schema", "macro_sql": "{% macro postgres__drop_schema(relation) -%}\n  {% if relation.database -%}\n    {{ adapter.verify_database(relation.database) }}\n  {%- endif -%}\n  {%- call statement('drop_schema') -%}\n    drop schema if exists {{ relation.without_identifier().include(database=False) }} cascade\n  {%- endcall -%}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4291768, "supported_languages": null}, "macro.dbt_postgres.postgres__get_columns_in_relation": {"name": "postgres__get_columns_in_relation", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__get_columns_in_relation", "macro_sql": "{% macro postgres__get_columns_in_relation(relation) -%}\n  {% call statement('get_columns_in_relation', fetch_result=True) %}\n      select\n          column_name,\n          data_type,\n          character_maximum_length,\n          numeric_precision,\n          numeric_scale\n\n      from {{ relation.information_schema('columns') }}\n      where table_name = '{{ relation.identifier }}'\n        {% if relation.schema %}\n        and table_schema = '{{ relation.schema }}'\n        {% endif %}\n      order by ordinal_position\n\n  {% endcall %}\n  {% set table = load_result('get_columns_in_relation').table %}\n  {{ return(sql_convert_columns_in_relation(table)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt.sql_convert_columns_in_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.429888, "supported_languages": null}, "macro.dbt_postgres.postgres__list_relations_without_caching": {"name": "postgres__list_relations_without_caching", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__list_relations_without_caching", "macro_sql": "{% macro postgres__list_relations_without_caching(schema_relation) %}\n  {% call statement('list_relations_without_caching', fetch_result=True) -%}\n    select\n      '{{ schema_relation.database }}' as database,\n      tablename as name,\n      schemaname as schema,\n      'table' as type\n    from pg_tables\n    where schemaname ilike '{{ schema_relation.schema }}'\n    union all\n    select\n      '{{ schema_relation.database }}' as database,\n      viewname as name,\n      schemaname as schema,\n      'view' as type\n    from pg_views\n    where schemaname ilike '{{ schema_relation.schema }}'\n  {% endcall %}\n  {{ return(load_result('list_relations_without_caching').table) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.430448, "supported_languages": null}, "macro.dbt_postgres.postgres__information_schema_name": {"name": "postgres__information_schema_name", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__information_schema_name", "macro_sql": "{% macro postgres__information_schema_name(database) -%}\n  {% if database_name -%}\n    {{ adapter.verify_database(database_name) }}\n  {%- endif -%}\n  information_schema\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4307144, "supported_languages": null}, "macro.dbt_postgres.postgres__list_schemas": {"name": "postgres__list_schemas", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__list_schemas", "macro_sql": "{% macro postgres__list_schemas(database) %}\n  {% if database -%}\n    {{ adapter.verify_database(database) }}\n  {%- endif -%}\n  {% call statement('list_schemas', fetch_result=True, auto_begin=False) %}\n    select distinct nspname from pg_namespace\n  {% endcall %}\n  {{ return(load_result('list_schemas').table) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4312346, "supported_languages": null}, "macro.dbt_postgres.postgres__check_schema_exists": {"name": "postgres__check_schema_exists", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__check_schema_exists", "macro_sql": "{% macro postgres__check_schema_exists(information_schema, schema) -%}\n  {% if information_schema.database -%}\n    {{ adapter.verify_database(information_schema.database) }}\n  {%- endif -%}\n  {% call statement('check_schema_exists', fetch_result=True, auto_begin=False) %}\n    select count(*) from pg_namespace where nspname = '{{ schema }}'\n  {% endcall %}\n  {{ return(load_result('check_schema_exists').table) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4318151, "supported_languages": null}, "macro.dbt_postgres.postgres__make_relation_with_suffix": {"name": "postgres__make_relation_with_suffix", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__make_relation_with_suffix", "macro_sql": "{% macro postgres__make_relation_with_suffix(base_relation, suffix, dstring) %}\n    {% if dstring %}\n      {% set dt = modules.datetime.datetime.now() %}\n      {% set dtstring = dt.strftime(\"%H%M%S%f\") %}\n      {% set suffix = suffix ~ dtstring %}\n    {% endif %}\n    {% set suffix_length = suffix|length %}\n    {% set relation_max_name_length = base_relation.relation_max_name_length() %}\n    {% if suffix_length > relation_max_name_length %}\n        {% do exceptions.raise_compiler_error('Relation suffix is too long (' ~ suffix_length ~ ' characters). Maximum length is ' ~ relation_max_name_length ~ ' characters.') %}\n    {% endif %}\n    {% set identifier = base_relation.identifier[:relation_max_name_length - suffix_length] ~ suffix %}\n\n    {{ return(base_relation.incorporate(path={\"identifier\": identifier })) }}\n\n  {% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4330792, "supported_languages": null}, "macro.dbt_postgres.postgres__make_intermediate_relation": {"name": "postgres__make_intermediate_relation", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__make_intermediate_relation", "macro_sql": "{% macro postgres__make_intermediate_relation(base_relation, suffix) %}\n    {{ return(postgres__make_relation_with_suffix(base_relation, suffix, dstring=False)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__make_relation_with_suffix"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.433377, "supported_languages": null}, "macro.dbt_postgres.postgres__make_temp_relation": {"name": "postgres__make_temp_relation", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__make_temp_relation", "macro_sql": "{% macro postgres__make_temp_relation(base_relation, suffix) %}\n    {% set temp_relation = postgres__make_relation_with_suffix(base_relation, suffix, dstring=True) %}\n    {{ return(temp_relation.incorporate(path={\"schema\": none,\n                                              \"database\": none})) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__make_relation_with_suffix"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.433854, "supported_languages": null}, "macro.dbt_postgres.postgres__make_backup_relation": {"name": "postgres__make_backup_relation", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__make_backup_relation", "macro_sql": "{% macro postgres__make_backup_relation(base_relation, backup_relation_type, suffix) %}\n    {% set backup_relation = postgres__make_relation_with_suffix(base_relation, suffix, dstring=False) %}\n    {{ return(backup_relation.incorporate(type=backup_relation_type)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__make_relation_with_suffix"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4342632, "supported_languages": null}, "macro.dbt_postgres.postgres_escape_comment": {"name": "postgres_escape_comment", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres_escape_comment", "macro_sql": "{% macro postgres_escape_comment(comment) -%}\n  {% if comment is not string %}\n    {% do exceptions.raise_compiler_error('cannot escape a non-string: ' ~ comment) %}\n  {% endif %}\n  {%- set magic = '$dbt_comment_literal_block$' -%}\n  {%- if magic in comment -%}\n    {%- do exceptions.raise_compiler_error('The string ' ~ magic ~ ' is not allowed in comments.') -%}\n  {%- endif -%}\n  {{ magic }}{{ comment }}{{ magic }}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4349122, "supported_languages": null}, "macro.dbt_postgres.postgres__alter_relation_comment": {"name": "postgres__alter_relation_comment", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__alter_relation_comment", "macro_sql": "{% macro postgres__alter_relation_comment(relation, comment) %}\n  {% set escaped_comment = postgres_escape_comment(comment) %}\n  comment on {{ relation.type }} {{ relation }} is {{ escaped_comment }};\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres_escape_comment"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.435252, "supported_languages": null}, "macro.dbt_postgres.postgres__alter_column_comment": {"name": "postgres__alter_column_comment", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__alter_column_comment", "macro_sql": "{% macro postgres__alter_column_comment(relation, column_dict) %}\n  {% set existing_columns = adapter.get_columns_in_relation(relation) | map(attribute=\"name\") | list %}\n  {% for column_name in column_dict if (column_name in existing_columns) %}\n    {% set comment = column_dict[column_name]['description'] %}\n    {% set escaped_comment = postgres_escape_comment(comment) %}\n    comment on column {{ relation }}.{{ adapter.quote(column_name) if column_dict[column_name]['quote'] else column_name }} is {{ escaped_comment }};\n  {% endfor %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres_escape_comment"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4361348, "supported_languages": null}, "macro.dbt_postgres.postgres__get_show_grant_sql": {"name": "postgres__get_show_grant_sql", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__get_show_grant_sql", "macro_sql": "\n\n{%- macro postgres__get_show_grant_sql(relation) -%}\n  select grantee, privilege_type\n  from {{ relation.information_schema('role_table_grants') }}\n      where grantor = current_role\n        and grantee != current_role\n        and table_schema = '{{ relation.schema }}'\n        and table_name = '{{ relation.identifier }}'\n{%- endmacro -%}\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4364605, "supported_languages": null}, "macro.dbt_postgres.postgres__copy_grants": {"name": "postgres__copy_grants", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__copy_grants", "macro_sql": "{% macro postgres__copy_grants() %}\n    {{ return(False) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4366474, "supported_languages": null}, "macro.dbt_postgres.postgres__current_timestamp": {"name": "postgres__current_timestamp", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/timestamps.sql", "original_file_path": "macros/timestamps.sql", "unique_id": "macro.dbt_postgres.postgres__current_timestamp", "macro_sql": "{% macro postgres__current_timestamp() -%}\n    now()\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4370492, "supported_languages": null}, "macro.dbt_postgres.postgres__snapshot_string_as_time": {"name": "postgres__snapshot_string_as_time", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/timestamps.sql", "original_file_path": "macros/timestamps.sql", "unique_id": "macro.dbt_postgres.postgres__snapshot_string_as_time", "macro_sql": "{% macro postgres__snapshot_string_as_time(timestamp) -%}\n    {%- set result = \"'\" ~ timestamp ~ \"'::timestamp without time zone\" -%}\n    {{ return(result) }}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4373326, "supported_languages": null}, "macro.dbt_postgres.postgres__snapshot_get_time": {"name": "postgres__snapshot_get_time", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/timestamps.sql", "original_file_path": "macros/timestamps.sql", "unique_id": "macro.dbt_postgres.postgres__snapshot_get_time", "macro_sql": "{% macro postgres__snapshot_get_time() -%}\n  {{ current_timestamp() }}::timestamp without time zone\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4375052, "supported_languages": null}, "macro.dbt_postgres.postgres__current_timestamp_backcompat": {"name": "postgres__current_timestamp_backcompat", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/timestamps.sql", "original_file_path": "macros/timestamps.sql", "unique_id": "macro.dbt_postgres.postgres__current_timestamp_backcompat", "macro_sql": "{% macro postgres__current_timestamp_backcompat() %}\n    current_timestamp::{{ type_timestamp() }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4376779, "supported_languages": null}, "macro.dbt_postgres.postgres__current_timestamp_in_utc_backcompat": {"name": "postgres__current_timestamp_in_utc_backcompat", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/timestamps.sql", "original_file_path": "macros/timestamps.sql", "unique_id": "macro.dbt_postgres.postgres__current_timestamp_in_utc_backcompat", "macro_sql": "{% macro postgres__current_timestamp_in_utc_backcompat() %}\n    (current_timestamp at time zone 'utc')::{{ type_timestamp() }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4380705, "supported_languages": null}, "macro.dbt_postgres.postgres__listagg": {"name": "postgres__listagg", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/utils/listagg.sql", "original_file_path": "macros/utils/listagg.sql", "unique_id": "macro.dbt_postgres.postgres__listagg", "macro_sql": "{% macro postgres__listagg(measure, delimiter_text, order_by_clause, limit_num) -%}\n\n    {% if limit_num -%}\n    array_to_string(\n        (array_agg(\n            {{ measure }}\n            {% if order_by_clause -%}\n            {{ order_by_clause }}\n            {%- endif %}\n        ))[1:{{ limit_num }}],\n        {{ delimiter_text }}\n        )\n    {%- else %}\n    string_agg(\n        {{ measure }},\n        {{ delimiter_text }}\n        {% if order_by_clause -%}\n        {{ order_by_clause }}\n        {%- endif %}\n        )\n    {%- endif %}\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4389684, "supported_languages": null}, "macro.dbt_postgres.get_column_names": {"name": "get_column_names", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/utils/columns_spec_ddl.sql", "original_file_path": "macros/utils/columns_spec_ddl.sql", "unique_id": "macro.dbt_postgres.get_column_names", "macro_sql": "{% macro get_column_names() %}\n  {# loop through user_provided_columns to get column names #}\n    {%- set user_provided_columns = model['columns'] -%}\n    (\n    {% for i in user_provided_columns %}\n      {% set col = user_provided_columns[i] %}\n      {{ col['name'] }} {{ \",\" if not loop.last }}\n    {% endfor %}\n  )\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4396474, "supported_languages": null}, "macro.dbt_postgres.postgres__dateadd": {"name": "postgres__dateadd", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/utils/dateadd.sql", "original_file_path": "macros/utils/dateadd.sql", "unique_id": "macro.dbt_postgres.postgres__dateadd", "macro_sql": "{% macro postgres__dateadd(datepart, interval, from_date_or_timestamp) %}\n\n    {{ from_date_or_timestamp }} + ((interval '1 {{ datepart }}') * ({{ interval }}))\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.439979, "supported_languages": null}, "macro.dbt_postgres.postgres__split_part": {"name": "postgres__split_part", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/utils/split_part.sql", "original_file_path": "macros/utils/split_part.sql", "unique_id": "macro.dbt_postgres.postgres__split_part", "macro_sql": "{% macro postgres__split_part(string_text, delimiter_text, part_number) %}\n\n  {% if part_number >= 0 %}\n    {{ dbt.default__split_part(string_text, delimiter_text, part_number) }}\n  {% else %}\n    {{ dbt._split_part_negative(string_text, delimiter_text, part_number) }}\n  {% endif %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__split_part", "macro.dbt._split_part_negative"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.440584, "supported_languages": null}, "macro.dbt_postgres.postgres__datediff": {"name": "postgres__datediff", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/utils/datediff.sql", "original_file_path": "macros/utils/datediff.sql", "unique_id": "macro.dbt_postgres.postgres__datediff", "macro_sql": "{% macro postgres__datediff(first_date, second_date, datepart) -%}\n\n    {% if datepart == 'year' %}\n        (date_part('year', ({{second_date}})::date) - date_part('year', ({{first_date}})::date))\n    {% elif datepart == 'quarter' %}\n        ({{ datediff(first_date, second_date, 'year') }} * 4 + date_part('quarter', ({{second_date}})::date) - date_part('quarter', ({{first_date}})::date))\n    {% elif datepart == 'month' %}\n        ({{ datediff(first_date, second_date, 'year') }} * 12 + date_part('month', ({{second_date}})::date) - date_part('month', ({{first_date}})::date))\n    {% elif datepart == 'day' %}\n        (({{second_date}})::date - ({{first_date}})::date)\n    {% elif datepart == 'week' %}\n        ({{ datediff(first_date, second_date, 'day') }} / 7 + case\n            when date_part('dow', ({{first_date}})::timestamp) <= date_part('dow', ({{second_date}})::timestamp) then\n                case when {{first_date}} <= {{second_date}} then 0 else -1 end\n            else\n                case when {{first_date}} <= {{second_date}} then 1 else 0 end\n        end)\n    {% elif datepart == 'hour' %}\n        ({{ datediff(first_date, second_date, 'day') }} * 24 + date_part('hour', ({{second_date}})::timestamp) - date_part('hour', ({{first_date}})::timestamp))\n    {% elif datepart == 'minute' %}\n        ({{ datediff(first_date, second_date, 'hour') }} * 60 + date_part('minute', ({{second_date}})::timestamp) - date_part('minute', ({{first_date}})::timestamp))\n    {% elif datepart == 'second' %}\n        ({{ datediff(first_date, second_date, 'minute') }} * 60 + floor(date_part('second', ({{second_date}})::timestamp)) - floor(date_part('second', ({{first_date}})::timestamp)))\n    {% elif datepart == 'millisecond' %}\n        ({{ datediff(first_date, second_date, 'minute') }} * 60000 + floor(date_part('millisecond', ({{second_date}})::timestamp)) - floor(date_part('millisecond', ({{first_date}})::timestamp)))\n    {% elif datepart == 'microsecond' %}\n        ({{ datediff(first_date, second_date, 'minute') }} * 60000000 + floor(date_part('microsecond', ({{second_date}})::timestamp)) - floor(date_part('microsecond', ({{first_date}})::timestamp)))\n    {% else %}\n        {{ exceptions.raise_compiler_error(\"Unsupported datepart for macro datediff in postgres: {!r}\".format(datepart)) }}\n    {% endif %}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.datediff"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4449549, "supported_languages": null}, "macro.dbt_postgres.postgres__any_value": {"name": "postgres__any_value", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/utils/any_value.sql", "original_file_path": "macros/utils/any_value.sql", "unique_id": "macro.dbt_postgres.postgres__any_value", "macro_sql": "{% macro postgres__any_value(expression) -%}\n\n    min({{ expression }})\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4452012, "supported_languages": null}, "macro.dbt_postgres.postgres__last_day": {"name": "postgres__last_day", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/utils/last_day.sql", "original_file_path": "macros/utils/last_day.sql", "unique_id": "macro.dbt_postgres.postgres__last_day", "macro_sql": "{% macro postgres__last_day(date, datepart) -%}\n\n    {%- if datepart == 'quarter' -%}\n    -- postgres dateadd does not support quarter interval.\n    cast(\n        {{dbt.dateadd('day', '-1',\n        dbt.dateadd('month', '3', dbt.date_trunc(datepart, date))\n        )}}\n        as date)\n    {%- else -%}\n    {{dbt.default_last_day(date, datepart)}}\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.dateadd", "macro.dbt.date_trunc", "macro.dbt.default_last_day"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4459305, "supported_languages": null}, "macro.dbt_postgres.postgres__snapshot_merge_sql": {"name": "postgres__snapshot_merge_sql", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/materializations/snapshot_merge.sql", "original_file_path": "macros/materializations/snapshot_merge.sql", "unique_id": "macro.dbt_postgres.postgres__snapshot_merge_sql", "macro_sql": "{% macro postgres__snapshot_merge_sql(target, source, insert_cols) -%}\n    {%- set insert_cols_csv = insert_cols | join(', ') -%}\n\n    update {{ target }}\n    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to\n    from {{ source }} as DBT_INTERNAL_SOURCE\n    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = {{ target }}.dbt_scd_id::text\n      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)\n      and {{ target }}.dbt_valid_to is null;\n\n    insert into {{ target }} ({{ insert_cols_csv }})\n    select {% for column in insert_cols -%}\n        DBT_INTERNAL_SOURCE.{{ column }} {%- if not loop.last %}, {%- endif %}\n    {%- endfor %}\n    from {{ source }} as DBT_INTERNAL_SOURCE\n    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4469543, "supported_languages": null}, "macro.dbt_postgres.postgres__get_incremental_default_sql": {"name": "postgres__get_incremental_default_sql", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/materializations/incremental_strategies.sql", "original_file_path": "macros/materializations/incremental_strategies.sql", "unique_id": "macro.dbt_postgres.postgres__get_incremental_default_sql", "macro_sql": "{% macro postgres__get_incremental_default_sql(arg_dict) %}\n\n  {% if arg_dict[\"unique_key\"] %}\n    {% do return(get_incremental_delete_insert_sql(arg_dict)) %}\n  {% else %}\n    {% do return(get_incremental_append_sql(arg_dict)) %}\n  {% endif %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_incremental_delete_insert_sql", "macro.dbt.get_incremental_append_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4475172, "supported_languages": null}, "macro.dbt.collect_freshness": {"name": "collect_freshness", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/freshness.sql", "original_file_path": "macros/adapters/freshness.sql", "unique_id": "macro.dbt.collect_freshness", "macro_sql": "{% macro collect_freshness(source, loaded_at_field, filter) %}\n  {{ return(adapter.dispatch('collect_freshness', 'dbt')(source, loaded_at_field, filter))}}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__collect_freshness"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4481268, "supported_languages": null}, "macro.dbt.default__collect_freshness": {"name": "default__collect_freshness", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/freshness.sql", "original_file_path": "macros/adapters/freshness.sql", "unique_id": "macro.dbt.default__collect_freshness", "macro_sql": "{% macro default__collect_freshness(source, loaded_at_field, filter) %}\n  {% call statement('collect_freshness', fetch_result=True, auto_begin=False) -%}\n    select\n      max({{ loaded_at_field }}) as max_loaded_at,\n      {{ current_timestamp() }} as snapshotted_at\n    from {{ source }}\n    {% if filter %}\n    where {{ filter }}\n    {% endif %}\n  {% endcall %}\n  {{ return(load_result('collect_freshness')) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.448747, "supported_languages": null}, "macro.dbt.alter_column_comment": {"name": "alter_column_comment", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "unique_id": "macro.dbt.alter_column_comment", "macro_sql": "{% macro alter_column_comment(relation, column_dict) -%}\n  {{ return(adapter.dispatch('alter_column_comment', 'dbt')(relation, column_dict)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__alter_column_comment"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4496627, "supported_languages": null}, "macro.dbt.default__alter_column_comment": {"name": "default__alter_column_comment", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "unique_id": "macro.dbt.default__alter_column_comment", "macro_sql": "{% macro default__alter_column_comment(relation, column_dict) -%}\n  {{ exceptions.raise_not_implemented(\n    'alter_column_comment macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4499338, "supported_languages": null}, "macro.dbt.alter_relation_comment": {"name": "alter_relation_comment", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "unique_id": "macro.dbt.alter_relation_comment", "macro_sql": "{% macro alter_relation_comment(relation, relation_comment) -%}\n  {{ return(adapter.dispatch('alter_relation_comment', 'dbt')(relation, relation_comment)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__alter_relation_comment"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4502428, "supported_languages": null}, "macro.dbt.default__alter_relation_comment": {"name": "default__alter_relation_comment", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "unique_id": "macro.dbt.default__alter_relation_comment", "macro_sql": "{% macro default__alter_relation_comment(relation, relation_comment) -%}\n  {{ exceptions.raise_not_implemented(\n    'alter_relation_comment macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4505036, "supported_languages": null}, "macro.dbt.persist_docs": {"name": "persist_docs", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "unique_id": "macro.dbt.persist_docs", "macro_sql": "{% macro persist_docs(relation, model, for_relation=true, for_columns=true) -%}\n  {{ return(adapter.dispatch('persist_docs', 'dbt')(relation, model, for_relation, for_columns)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4509022, "supported_languages": null}, "macro.dbt.default__persist_docs": {"name": "default__persist_docs", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "unique_id": "macro.dbt.default__persist_docs", "macro_sql": "{% macro default__persist_docs(relation, model, for_relation, for_columns) -%}\n  {% if for_relation and config.persist_relation_docs() and model.description %}\n    {% do run_query(alter_relation_comment(relation, model.description)) %}\n  {% endif %}\n\n  {% if for_columns and config.persist_column_docs() and model.columns %}\n    {% do run_query(alter_column_comment(relation, model.columns)) %}\n  {% endif %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.run_query", "macro.dbt.alter_relation_comment", "macro.dbt.alter_column_comment"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4516153, "supported_languages": null}, "macro.dbt.make_intermediate_relation": {"name": "make_intermediate_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.make_intermediate_relation", "macro_sql": "{% macro make_intermediate_relation(base_relation, suffix='__dbt_tmp') %}\n  {{ return(adapter.dispatch('make_intermediate_relation', 'dbt')(base_relation, suffix)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__make_intermediate_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4557772, "supported_languages": null}, "macro.dbt.default__make_intermediate_relation": {"name": "default__make_intermediate_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.default__make_intermediate_relation", "macro_sql": "{% macro default__make_intermediate_relation(base_relation, suffix) %}\n    {{ return(default__make_temp_relation(base_relation, suffix)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__make_temp_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.456034, "supported_languages": null}, "macro.dbt.make_temp_relation": {"name": "make_temp_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.make_temp_relation", "macro_sql": "{% macro make_temp_relation(base_relation, suffix='__dbt_tmp') %}\n  {{ return(adapter.dispatch('make_temp_relation', 'dbt')(base_relation, suffix)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__make_temp_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.456369, "supported_languages": null}, "macro.dbt.default__make_temp_relation": {"name": "default__make_temp_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.default__make_temp_relation", "macro_sql": "{% macro default__make_temp_relation(base_relation, suffix) %}\n    {%- set temp_identifier = base_relation.identifier ~ suffix -%}\n    {%- set temp_relation = base_relation.incorporate(\n                                path={\"identifier\": temp_identifier}) -%}\n\n    {{ return(temp_relation) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4568136, "supported_languages": null}, "macro.dbt.make_backup_relation": {"name": "make_backup_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.make_backup_relation", "macro_sql": "{% macro make_backup_relation(base_relation, backup_relation_type, suffix='__dbt_backup') %}\n    {{ return(adapter.dispatch('make_backup_relation', 'dbt')(base_relation, backup_relation_type, suffix)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__make_backup_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4571788, "supported_languages": null}, "macro.dbt.default__make_backup_relation": {"name": "default__make_backup_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.default__make_backup_relation", "macro_sql": "{% macro default__make_backup_relation(base_relation, backup_relation_type, suffix) %}\n    {%- set backup_identifier = base_relation.identifier ~ suffix -%}\n    {%- set backup_relation = base_relation.incorporate(\n                                  path={\"identifier\": backup_identifier},\n                                  type=backup_relation_type\n    ) -%}\n    {{ return(backup_relation) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4576595, "supported_languages": null}, "macro.dbt.drop_relation": {"name": "drop_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.drop_relation", "macro_sql": "{% macro drop_relation(relation) -%}\n  {{ return(adapter.dispatch('drop_relation', 'dbt')(relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__drop_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4579377, "supported_languages": null}, "macro.dbt.default__drop_relation": {"name": "default__drop_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.default__drop_relation", "macro_sql": "{% macro default__drop_relation(relation) -%}\n  {% call statement('drop_relation', auto_begin=False) -%}\n    drop {{ relation.type }} if exists {{ relation }} cascade\n  {%- endcall %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4582648, "supported_languages": null}, "macro.dbt.truncate_relation": {"name": "truncate_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.truncate_relation", "macro_sql": "{% macro truncate_relation(relation) -%}\n  {{ return(adapter.dispatch('truncate_relation', 'dbt')(relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__truncate_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4586468, "supported_languages": null}, "macro.dbt.default__truncate_relation": {"name": "default__truncate_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.default__truncate_relation", "macro_sql": "{% macro default__truncate_relation(relation) -%}\n  {% call statement('truncate_relation') -%}\n    truncate table {{ relation }}\n  {%- endcall %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4589055, "supported_languages": null}, "macro.dbt.rename_relation": {"name": "rename_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.rename_relation", "macro_sql": "{% macro rename_relation(from_relation, to_relation) -%}\n  {{ return(adapter.dispatch('rename_relation', 'dbt')(from_relation, to_relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__rename_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4592125, "supported_languages": null}, "macro.dbt.default__rename_relation": {"name": "default__rename_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.default__rename_relation", "macro_sql": "{% macro default__rename_relation(from_relation, to_relation) -%}\n  {% set target_name = adapter.quote_as_configured(to_relation.identifier, 'identifier') %}\n  {% call statement('rename_relation') -%}\n    alter table {{ from_relation }} rename to {{ target_name }}\n  {%- endcall %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4596438, "supported_languages": null}, "macro.dbt.get_or_create_relation": {"name": "get_or_create_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.get_or_create_relation", "macro_sql": "{% macro get_or_create_relation(database, schema, identifier, type) -%}\n  {{ return(adapter.dispatch('get_or_create_relation', 'dbt')(database, schema, identifier, type)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_or_create_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4600124, "supported_languages": null}, "macro.dbt.default__get_or_create_relation": {"name": "default__get_or_create_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.default__get_or_create_relation", "macro_sql": "{% macro default__get_or_create_relation(database, schema, identifier, type) %}\n  {%- set target_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) %}\n\n  {% if target_relation %}\n    {% do return([true, target_relation]) %}\n  {% endif %}\n\n  {%- set new_relation = api.Relation.create(\n      database=database,\n      schema=schema,\n      identifier=identifier,\n      type=type\n  ) -%}\n  {% do return([false, new_relation]) %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4608383, "supported_languages": null}, "macro.dbt.load_cached_relation": {"name": "load_cached_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.load_cached_relation", "macro_sql": "{% macro load_cached_relation(relation) %}\n  {% do return(adapter.get_relation(\n    database=relation.database,\n    schema=relation.schema,\n    identifier=relation.identifier\n  )) -%}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.461185, "supported_languages": null}, "macro.dbt.load_relation": {"name": "load_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.load_relation", "macro_sql": "{% macro load_relation(relation) %}\n    {{ return(load_cached_relation(relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.load_cached_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4614072, "supported_languages": null}, "macro.dbt.drop_relation_if_exists": {"name": "drop_relation_if_exists", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.drop_relation_if_exists", "macro_sql": "{% macro drop_relation_if_exists(relation) %}\n  {% if relation is not none %}\n    {{ adapter.drop_relation(relation) }}\n  {% endif %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4617064, "supported_languages": null}, "macro.dbt.get_catalog": {"name": "get_catalog", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.get_catalog", "macro_sql": "{% macro get_catalog(information_schema, schemas) -%}\n  {{ return(adapter.dispatch('get_catalog', 'dbt')(information_schema, schemas)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_catalog"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4636176, "supported_languages": null}, "macro.dbt.default__get_catalog": {"name": "default__get_catalog", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.default__get_catalog", "macro_sql": "{% macro default__get_catalog(information_schema, schemas) -%}\n\n  {% set typename = adapter.type() %}\n  {% set msg -%}\n    get_catalog not implemented for {{ typename }}\n  {%- endset %}\n\n  {{ exceptions.raise_compiler_error(msg) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.46402, "supported_languages": null}, "macro.dbt.information_schema_name": {"name": "information_schema_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.information_schema_name", "macro_sql": "{% macro information_schema_name(database) %}\n  {{ return(adapter.dispatch('information_schema_name', 'dbt')(database)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__information_schema_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.464304, "supported_languages": null}, "macro.dbt.default__information_schema_name": {"name": "default__information_schema_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.default__information_schema_name", "macro_sql": "{% macro default__information_schema_name(database) -%}\n  {%- if database -%}\n    {{ database }}.INFORMATION_SCHEMA\n  {%- else -%}\n    INFORMATION_SCHEMA\n  {%- endif -%}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4645584, "supported_languages": null}, "macro.dbt.list_schemas": {"name": "list_schemas", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.list_schemas", "macro_sql": "{% macro list_schemas(database) -%}\n  {{ return(adapter.dispatch('list_schemas', 'dbt')(database)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__list_schemas"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4648337, "supported_languages": null}, "macro.dbt.default__list_schemas": {"name": "default__list_schemas", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.default__list_schemas", "macro_sql": "{% macro default__list_schemas(database) -%}\n  {% set sql %}\n    select distinct schema_name\n    from {{ information_schema_name(database) }}.SCHEMATA\n    where catalog_name ilike '{{ database }}'\n  {% endset %}\n  {{ return(run_query(sql)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.information_schema_name", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4652054, "supported_languages": null}, "macro.dbt.check_schema_exists": {"name": "check_schema_exists", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.check_schema_exists", "macro_sql": "{% macro check_schema_exists(information_schema, schema) -%}\n  {{ return(adapter.dispatch('check_schema_exists', 'dbt')(information_schema, schema)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__check_schema_exists"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4655125, "supported_languages": null}, "macro.dbt.default__check_schema_exists": {"name": "default__check_schema_exists", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.default__check_schema_exists", "macro_sql": "{% macro default__check_schema_exists(information_schema, schema) -%}\n  {% set sql -%}\n        select count(*)\n        from {{ information_schema.replace(information_schema_view='SCHEMATA') }}\n        where catalog_name='{{ information_schema.database }}'\n          and schema_name='{{ schema }}'\n  {%- endset %}\n  {{ return(run_query(sql)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.replace", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4659681, "supported_languages": null}, "macro.dbt.list_relations_without_caching": {"name": "list_relations_without_caching", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.list_relations_without_caching", "macro_sql": "{% macro list_relations_without_caching(schema_relation) %}\n  {{ return(adapter.dispatch('list_relations_without_caching', 'dbt')(schema_relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__list_relations_without_caching"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4662504, "supported_languages": null}, "macro.dbt.default__list_relations_without_caching": {"name": "default__list_relations_without_caching", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.default__list_relations_without_caching", "macro_sql": "{% macro default__list_relations_without_caching(schema_relation) %}\n  {{ exceptions.raise_not_implemented(\n    'list_relations_without_caching macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4665058, "supported_languages": null}, "macro.dbt.copy_grants": {"name": "copy_grants", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.copy_grants", "macro_sql": "{% macro copy_grants() %}\n    {{ return(adapter.dispatch('copy_grants', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__copy_grants"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4686918, "supported_languages": null}, "macro.dbt.default__copy_grants": {"name": "default__copy_grants", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.default__copy_grants", "macro_sql": "{% macro default__copy_grants() %}\n    {{ return(True) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.46888, "supported_languages": null}, "macro.dbt.support_multiple_grantees_per_dcl_statement": {"name": "support_multiple_grantees_per_dcl_statement", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.support_multiple_grantees_per_dcl_statement", "macro_sql": "{% macro support_multiple_grantees_per_dcl_statement() %}\n    {{ return(adapter.dispatch('support_multiple_grantees_per_dcl_statement', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__support_multiple_grantees_per_dcl_statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.46914, "supported_languages": null}, "macro.dbt.default__support_multiple_grantees_per_dcl_statement": {"name": "default__support_multiple_grantees_per_dcl_statement", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.default__support_multiple_grantees_per_dcl_statement", "macro_sql": "\n\n{%- macro default__support_multiple_grantees_per_dcl_statement() -%}\n    {{ return(True) }}\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4693186, "supported_languages": null}, "macro.dbt.should_revoke": {"name": "should_revoke", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.should_revoke", "macro_sql": "{% macro should_revoke(existing_relation, full_refresh_mode=True) %}\n\n    {% if not existing_relation %}\n        {#-- The table doesn't already exist, so no grants to copy over --#}\n        {{ return(False) }}\n    {% elif full_refresh_mode %}\n        {#-- The object is being REPLACED -- whether grants are copied over depends on the value of user config --#}\n        {{ return(copy_grants()) }}\n    {% else %}\n        {#-- The table is being merged/upserted/inserted -- grants will be carried over --#}\n        {{ return(True) }}\n    {% endif %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.copy_grants"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4698286, "supported_languages": null}, "macro.dbt.get_show_grant_sql": {"name": "get_show_grant_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.get_show_grant_sql", "macro_sql": "{% macro get_show_grant_sql(relation) %}\n    {{ return(adapter.dispatch(\"get_show_grant_sql\", \"dbt\")(relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_show_grant_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.470112, "supported_languages": null}, "macro.dbt.default__get_show_grant_sql": {"name": "default__get_show_grant_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.default__get_show_grant_sql", "macro_sql": "{% macro default__get_show_grant_sql(relation) %}\n    show grants on {{ relation }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4702797, "supported_languages": null}, "macro.dbt.get_grant_sql": {"name": "get_grant_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.get_grant_sql", "macro_sql": "{% macro get_grant_sql(relation, privilege, grantees) %}\n    {{ return(adapter.dispatch('get_grant_sql', 'dbt')(relation, privilege, grantees)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_grant_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4706185, "supported_languages": null}, "macro.dbt.default__get_grant_sql": {"name": "default__get_grant_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.default__get_grant_sql", "macro_sql": "\n\n{%- macro default__get_grant_sql(relation, privilege, grantees) -%}\n    grant {{ privilege }} on {{ relation }} to {{ grantees | join(', ') }}\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4710236, "supported_languages": null}, "macro.dbt.get_revoke_sql": {"name": "get_revoke_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.get_revoke_sql", "macro_sql": "{% macro get_revoke_sql(relation, privilege, grantees) %}\n    {{ return(adapter.dispatch('get_revoke_sql', 'dbt')(relation, privilege, grantees)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_revoke_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4713726, "supported_languages": null}, "macro.dbt.default__get_revoke_sql": {"name": "default__get_revoke_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.default__get_revoke_sql", "macro_sql": "\n\n{%- macro default__get_revoke_sql(relation, privilege, grantees) -%}\n    revoke {{ privilege }} on {{ relation }} from {{ grantees | join(', ') }}\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4716651, "supported_languages": null}, "macro.dbt.get_dcl_statement_list": {"name": "get_dcl_statement_list", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.get_dcl_statement_list", "macro_sql": "{% macro get_dcl_statement_list(relation, grant_config, get_dcl_macro) %}\n    {{ return(adapter.dispatch('get_dcl_statement_list', 'dbt')(relation, grant_config, get_dcl_macro)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_dcl_statement_list"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4720047, "supported_languages": null}, "macro.dbt.default__get_dcl_statement_list": {"name": "default__get_dcl_statement_list", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.default__get_dcl_statement_list", "macro_sql": "\n\n{%- macro default__get_dcl_statement_list(relation, grant_config, get_dcl_macro) -%}\n    {#\n      -- Unpack grant_config into specific privileges and the set of users who need them granted/revoked.\n      -- Depending on whether this database supports multiple grantees per statement, pass in the list of\n      -- all grantees per privilege, or (if not) template one statement per privilege-grantee pair.\n      -- `get_dcl_macro` will be either `get_grant_sql` or `get_revoke_sql`\n    #}\n    {%- set dcl_statements = [] -%}\n    {%- for privilege, grantees in grant_config.items() %}\n        {%- if support_multiple_grantees_per_dcl_statement() and grantees -%}\n          {%- set dcl = get_dcl_macro(relation, privilege, grantees) -%}\n          {%- do dcl_statements.append(dcl) -%}\n        {%- else -%}\n          {%- for grantee in grantees -%}\n              {% set dcl = get_dcl_macro(relation, privilege, [grantee]) %}\n              {%- do dcl_statements.append(dcl) -%}\n          {% endfor -%}\n        {%- endif -%}\n    {%- endfor -%}\n    {{ return(dcl_statements) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.support_multiple_grantees_per_dcl_statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4730086, "supported_languages": null}, "macro.dbt.call_dcl_statements": {"name": "call_dcl_statements", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.call_dcl_statements", "macro_sql": "{% macro call_dcl_statements(dcl_statement_list) %}\n    {{ return(adapter.dispatch(\"call_dcl_statements\", \"dbt\")(dcl_statement_list)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__call_dcl_statements"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.473301, "supported_languages": null}, "macro.dbt.default__call_dcl_statements": {"name": "default__call_dcl_statements", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.default__call_dcl_statements", "macro_sql": "{% macro default__call_dcl_statements(dcl_statement_list) %}\n    {#\n      -- By default, supply all grant + revoke statements in a single semicolon-separated block,\n      -- so that they're all processed together.\n\n      -- Some databases do not support this. Those adapters will need to override this macro\n      -- to run each statement individually.\n    #}\n    {% call statement('grants') %}\n        {% for dcl_statement in dcl_statement_list %}\n            {{ dcl_statement }};\n        {% endfor %}\n    {% endcall %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4736867, "supported_languages": null}, "macro.dbt.apply_grants": {"name": "apply_grants", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.apply_grants", "macro_sql": "{% macro apply_grants(relation, grant_config, should_revoke) %}\n    {{ return(adapter.dispatch(\"apply_grants\", \"dbt\")(relation, grant_config, should_revoke)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__apply_grants"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4740295, "supported_languages": null}, "macro.dbt.default__apply_grants": {"name": "default__apply_grants", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.default__apply_grants", "macro_sql": "{% macro default__apply_grants(relation, grant_config, should_revoke=True) %}\n    {#-- If grant_config is {} or None, this is a no-op --#}\n    {% if grant_config %}\n        {% if should_revoke %}\n            {#-- We think previous grants may have carried over --#}\n            {#-- Show current grants and calculate diffs --#}\n            {% set current_grants_table = run_query(get_show_grant_sql(relation)) %}\n            {% set current_grants_dict = adapter.standardize_grants_dict(current_grants_table) %}\n            {% set needs_granting = diff_of_two_dicts(grant_config, current_grants_dict) %}\n            {% set needs_revoking = diff_of_two_dicts(current_grants_dict, grant_config) %}\n            {% if not (needs_granting or needs_revoking) %}\n                {{ log('On ' ~ relation ~': All grants are in place, no revocation or granting needed.')}}\n            {% endif %}\n        {% else %}\n            {#-- We don't think there's any chance of previous grants having carried over. --#}\n            {#-- Jump straight to granting what the user has configured. --#}\n            {% set needs_revoking = {} %}\n            {% set needs_granting = grant_config %}\n        {% endif %}\n        {% if needs_granting or needs_revoking %}\n            {% set revoke_statement_list = get_dcl_statement_list(relation, needs_revoking, get_revoke_sql) %}\n            {% set grant_statement_list = get_dcl_statement_list(relation, needs_granting, get_grant_sql) %}\n            {% set dcl_statement_list = revoke_statement_list + grant_statement_list %}\n            {% if dcl_statement_list %}\n                {{ call_dcl_statements(dcl_statement_list) }}\n            {% endif %}\n        {% endif %}\n    {% endif %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.run_query", "macro.dbt.get_show_grant_sql", "macro.dbt.get_dcl_statement_list", "macro.dbt.call_dcl_statements"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4756856, "supported_languages": null}, "macro.dbt.get_create_index_sql": {"name": "get_create_index_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "unique_id": "macro.dbt.get_create_index_sql", "macro_sql": "{% macro get_create_index_sql(relation, index_dict) -%}\n  {{ return(adapter.dispatch('get_create_index_sql', 'dbt')(relation, index_dict)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_create_index_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.476339, "supported_languages": null}, "macro.dbt.default__get_create_index_sql": {"name": "default__get_create_index_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "unique_id": "macro.dbt.default__get_create_index_sql", "macro_sql": "{% macro default__get_create_index_sql(relation, index_dict) -%}\n  {% do return(None) %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4765565, "supported_languages": null}, "macro.dbt.create_indexes": {"name": "create_indexes", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "unique_id": "macro.dbt.create_indexes", "macro_sql": "{% macro create_indexes(relation) -%}\n  {{ adapter.dispatch('create_indexes', 'dbt')(relation) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__create_indexes"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4768002, "supported_languages": null}, "macro.dbt.default__create_indexes": {"name": "default__create_indexes", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "unique_id": "macro.dbt.default__create_indexes", "macro_sql": "{% macro default__create_indexes(relation) -%}\n  {%- set _indexes = config.get('indexes', default=[]) -%}\n\n  {% for _index_dict in _indexes %}\n    {% set create_index_sql = get_create_index_sql(relation, _index_dict) %}\n    {% if create_index_sql %}\n      {% do run_query(create_index_sql) %}\n    {% endif %}\n  {% endfor %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_create_index_sql", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.477397, "supported_languages": null}, "macro.dbt.get_columns_in_relation": {"name": "get_columns_in_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.get_columns_in_relation", "macro_sql": "{% macro get_columns_in_relation(relation) -%}\n  {{ return(adapter.dispatch('get_columns_in_relation', 'dbt')(relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_columns_in_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4800358, "supported_languages": null}, "macro.dbt.default__get_columns_in_relation": {"name": "default__get_columns_in_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.default__get_columns_in_relation", "macro_sql": "{% macro default__get_columns_in_relation(relation) -%}\n  {{ exceptions.raise_not_implemented(\n    'get_columns_in_relation macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.480285, "supported_languages": null}, "macro.dbt.sql_convert_columns_in_relation": {"name": "sql_convert_columns_in_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.sql_convert_columns_in_relation", "macro_sql": "{% macro sql_convert_columns_in_relation(table) -%}\n  {% set columns = [] %}\n  {% for row in table %}\n    {% do columns.append(api.Column(*row)) %}\n  {% endfor %}\n  {{ return(columns) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4807556, "supported_languages": null}, "macro.dbt.get_empty_subquery_sql": {"name": "get_empty_subquery_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.get_empty_subquery_sql", "macro_sql": "{% macro get_empty_subquery_sql(select_sql) -%}\n  {{ return(adapter.dispatch('get_empty_subquery_sql', 'dbt')(select_sql)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_empty_subquery_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4810333, "supported_languages": null}, "macro.dbt.default__get_empty_subquery_sql": {"name": "default__get_empty_subquery_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.default__get_empty_subquery_sql", "macro_sql": "{% macro default__get_empty_subquery_sql(select_sql) %}\n    select * from (\n        {{ select_sql }}\n    ) as __dbt_sbq\n    where false\n    limit 0\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.481213, "supported_languages": null}, "macro.dbt.get_empty_schema_sql": {"name": "get_empty_schema_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.get_empty_schema_sql", "macro_sql": "{% macro get_empty_schema_sql(columns) -%}\n  {{ return(adapter.dispatch('get_empty_schema_sql', 'dbt')(columns)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_empty_schema_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4814866, "supported_languages": null}, "macro.dbt.default__get_empty_schema_sql": {"name": "default__get_empty_schema_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.default__get_empty_schema_sql", "macro_sql": "{% macro default__get_empty_schema_sql(columns) %}\n    {%- set col_err = [] -%}\n    select\n    {% for i in columns %}\n      {%- set col = columns[i] -%}\n      {%- if col['data_type'] is not defined -%}\n        {{ col_err.append(col['name']) }}\n      {%- endif -%}\n      cast(null as {{ col['data_type'] }}) as {{ col['name'] }}{{ \", \" if not loop.last }}\n    {%- endfor -%}\n    {%- if (col_err | length) > 0 -%}\n      {{ exceptions.column_type_missing(column_names=col_err) }}\n    {%- endif -%}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.48241, "supported_languages": null}, "macro.dbt.get_column_schema_from_query": {"name": "get_column_schema_from_query", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.get_column_schema_from_query", "macro_sql": "{% macro get_column_schema_from_query(select_sql) -%}\n    {% set columns = [] %}\n    {# -- Using an 'empty subquery' here to get the same schema as the given select_sql statement, without necessitating a data scan.#}\n    {% set sql = get_empty_subquery_sql(select_sql) %}\n    {% set column_schema = adapter.get_column_schema_from_query(sql) %}\n    {{ return(column_schema) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_empty_subquery_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4828768, "supported_languages": null}, "macro.dbt.get_columns_in_query": {"name": "get_columns_in_query", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.get_columns_in_query", "macro_sql": "{% macro get_columns_in_query(select_sql) -%}\n  {{ return(adapter.dispatch('get_columns_in_query', 'dbt')(select_sql)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_columns_in_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4831526, "supported_languages": null}, "macro.dbt.default__get_columns_in_query": {"name": "default__get_columns_in_query", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.default__get_columns_in_query", "macro_sql": "{% macro default__get_columns_in_query(select_sql) %}\n    {% call statement('get_columns_in_query', fetch_result=True, auto_begin=False) -%}\n        {{ get_empty_subquery_sql(select_sql) }}\n    {% endcall %}\n    {{ return(load_result('get_columns_in_query').table.columns | map(attribute='name') | list) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt.get_empty_subquery_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.483669, "supported_languages": null}, "macro.dbt.alter_column_type": {"name": "alter_column_type", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.alter_column_type", "macro_sql": "{% macro alter_column_type(relation, column_name, new_column_type) -%}\n  {{ return(adapter.dispatch('alter_column_type', 'dbt')(relation, column_name, new_column_type)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__alter_column_type"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4840088, "supported_languages": null}, "macro.dbt.default__alter_column_type": {"name": "default__alter_column_type", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.default__alter_column_type", "macro_sql": "{% macro default__alter_column_type(relation, column_name, new_column_type) -%}\n  {#\n    1. Create a new column (w/ temp name and correct type)\n    2. Copy data over to it\n    3. Drop the existing column (cascade!)\n    4. Rename the new column to existing column\n  #}\n  {%- set tmp_column = column_name + \"__dbt_alter\" -%}\n\n  {% call statement('alter_column_type') %}\n    alter table {{ relation }} add column {{ adapter.quote(tmp_column) }} {{ new_column_type }};\n    update {{ relation }} set {{ adapter.quote(tmp_column) }} = {{ adapter.quote(column_name) }};\n    alter table {{ relation }} drop column {{ adapter.quote(column_name) }} cascade;\n    alter table {{ relation }} rename column {{ adapter.quote(tmp_column) }} to {{ adapter.quote(column_name) }}\n  {% endcall %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4848917, "supported_languages": null}, "macro.dbt.alter_relation_add_remove_columns": {"name": "alter_relation_add_remove_columns", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.alter_relation_add_remove_columns", "macro_sql": "{% macro alter_relation_add_remove_columns(relation, add_columns = none, remove_columns = none) -%}\n  {{ return(adapter.dispatch('alter_relation_add_remove_columns', 'dbt')(relation, add_columns, remove_columns)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__alter_relation_add_remove_columns"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4853857, "supported_languages": null}, "macro.dbt.default__alter_relation_add_remove_columns": {"name": "default__alter_relation_add_remove_columns", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.default__alter_relation_add_remove_columns", "macro_sql": "{% macro default__alter_relation_add_remove_columns(relation, add_columns, remove_columns) %}\n\n  {% if add_columns is none %}\n    {% set add_columns = [] %}\n  {% endif %}\n  {% if remove_columns is none %}\n    {% set remove_columns = [] %}\n  {% endif %}\n\n  {% set sql -%}\n\n     alter {{ relation.type }} {{ relation }}\n\n            {% for column in add_columns %}\n               add column {{ column.name }} {{ column.data_type }}{{ ',' if not loop.last }}\n            {% endfor %}{{ ',' if add_columns and remove_columns }}\n\n            {% for column in remove_columns %}\n                drop column {{ column.name }}{{ ',' if not loop.last }}\n            {% endfor %}\n\n  {%- endset -%}\n\n  {% do run_query(sql) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4865456, "supported_languages": null}, "macro.dbt.create_schema": {"name": "create_schema", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/schema.sql", "original_file_path": "macros/adapters/schema.sql", "unique_id": "macro.dbt.create_schema", "macro_sql": "{% macro create_schema(relation) -%}\n  {{ adapter.dispatch('create_schema', 'dbt')(relation) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__create_schema"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4870872, "supported_languages": null}, "macro.dbt.default__create_schema": {"name": "default__create_schema", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/schema.sql", "original_file_path": "macros/adapters/schema.sql", "unique_id": "macro.dbt.default__create_schema", "macro_sql": "{% macro default__create_schema(relation) -%}\n  {%- call statement('create_schema') -%}\n    create schema if not exists {{ relation.without_identifier() }}\n  {% endcall %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.487371, "supported_languages": null}, "macro.dbt.drop_schema": {"name": "drop_schema", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/schema.sql", "original_file_path": "macros/adapters/schema.sql", "unique_id": "macro.dbt.drop_schema", "macro_sql": "{% macro drop_schema(relation) -%}\n  {{ adapter.dispatch('drop_schema', 'dbt')(relation) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__drop_schema"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.487618, "supported_languages": null}, "macro.dbt.default__drop_schema": {"name": "default__drop_schema", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/schema.sql", "original_file_path": "macros/adapters/schema.sql", "unique_id": "macro.dbt.default__drop_schema", "macro_sql": "{% macro default__drop_schema(relation) -%}\n  {%- call statement('drop_schema') -%}\n    drop schema if exists {{ relation.without_identifier() }} cascade\n  {% endcall %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4878988, "supported_languages": null}, "macro.dbt.current_timestamp": {"name": "current_timestamp", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/timestamps.sql", "original_file_path": "macros/adapters/timestamps.sql", "unique_id": "macro.dbt.current_timestamp", "macro_sql": "{%- macro current_timestamp() -%}\n    {{ adapter.dispatch('current_timestamp', 'dbt')() }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_postgres.postgres__current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4885707, "supported_languages": null}, "macro.dbt.default__current_timestamp": {"name": "default__current_timestamp", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/timestamps.sql", "original_file_path": "macros/adapters/timestamps.sql", "unique_id": "macro.dbt.default__current_timestamp", "macro_sql": "{% macro default__current_timestamp() -%}\n  {{ exceptions.raise_not_implemented(\n    'current_timestamp macro not implemented for adapter ' + adapter.type()) }}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4888043, "supported_languages": null}, "macro.dbt.snapshot_get_time": {"name": "snapshot_get_time", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/timestamps.sql", "original_file_path": "macros/adapters/timestamps.sql", "unique_id": "macro.dbt.snapshot_get_time", "macro_sql": "\n\n{%- macro snapshot_get_time() -%}\n    {{ adapter.dispatch('snapshot_get_time', 'dbt')() }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_postgres.postgres__snapshot_get_time"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4890277, "supported_languages": null}, "macro.dbt.default__snapshot_get_time": {"name": "default__snapshot_get_time", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/timestamps.sql", "original_file_path": "macros/adapters/timestamps.sql", "unique_id": "macro.dbt.default__snapshot_get_time", "macro_sql": "{% macro default__snapshot_get_time() %}\n    {{ current_timestamp() }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4891965, "supported_languages": null}, "macro.dbt.current_timestamp_backcompat": {"name": "current_timestamp_backcompat", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/timestamps.sql", "original_file_path": "macros/adapters/timestamps.sql", "unique_id": "macro.dbt.current_timestamp_backcompat", "macro_sql": "{% macro current_timestamp_backcompat() %}\n    {{ return(adapter.dispatch('current_timestamp_backcompat', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__current_timestamp_backcompat"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.489449, "supported_languages": null}, "macro.dbt.default__current_timestamp_backcompat": {"name": "default__current_timestamp_backcompat", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/timestamps.sql", "original_file_path": "macros/adapters/timestamps.sql", "unique_id": "macro.dbt.default__current_timestamp_backcompat", "macro_sql": "{% macro default__current_timestamp_backcompat() %}\n    current_timestamp::timestamp\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4895747, "supported_languages": null}, "macro.dbt.current_timestamp_in_utc_backcompat": {"name": "current_timestamp_in_utc_backcompat", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/timestamps.sql", "original_file_path": "macros/adapters/timestamps.sql", "unique_id": "macro.dbt.current_timestamp_in_utc_backcompat", "macro_sql": "{% macro current_timestamp_in_utc_backcompat() %}\n    {{ return(adapter.dispatch('current_timestamp_in_utc_backcompat', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__current_timestamp_in_utc_backcompat"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4898264, "supported_languages": null}, "macro.dbt.default__current_timestamp_in_utc_backcompat": {"name": "default__current_timestamp_in_utc_backcompat", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/timestamps.sql", "original_file_path": "macros/adapters/timestamps.sql", "unique_id": "macro.dbt.default__current_timestamp_in_utc_backcompat", "macro_sql": "{% macro default__current_timestamp_in_utc_backcompat() %}\n    {{ return(adapter.dispatch('current_timestamp_backcompat', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.current_timestamp_backcompat", "macro.dbt_postgres.postgres__current_timestamp_backcompat"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4900787, "supported_languages": null}, "macro.dbt.default__test_unique": {"name": "default__test_unique", "resource_type": "macro", "package_name": "dbt", "path": "macros/generic_test_sql/unique.sql", "original_file_path": "macros/generic_test_sql/unique.sql", "unique_id": "macro.dbt.default__test_unique", "macro_sql": "{% macro default__test_unique(model, column_name) %}\n\nselect\n    {{ column_name }} as unique_field,\n    count(*) as n_records\n\nfrom {{ model }}\nwhere {{ column_name }} is not null\ngroup by {{ column_name }}\nhaving count(*) > 1\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4904497, "supported_languages": null}, "macro.dbt.default__test_not_null": {"name": "default__test_not_null", "resource_type": "macro", "package_name": "dbt", "path": "macros/generic_test_sql/not_null.sql", "original_file_path": "macros/generic_test_sql/not_null.sql", "unique_id": "macro.dbt.default__test_not_null", "macro_sql": "{% macro default__test_not_null(model, column_name) %}\n\n{% set column_list = '*' if should_store_failures() else column_name %}\n\nselect {{ column_list }}\nfrom {{ model }}\nwhere {{ column_name }} is null\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.should_store_failures"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4908934, "supported_languages": null}, "macro.dbt.default__test_accepted_values": {"name": "default__test_accepted_values", "resource_type": "macro", "package_name": "dbt", "path": "macros/generic_test_sql/accepted_values.sql", "original_file_path": "macros/generic_test_sql/accepted_values.sql", "unique_id": "macro.dbt.default__test_accepted_values", "macro_sql": "{% macro default__test_accepted_values(model, column_name, values, quote=True) %}\n\nwith all_values as (\n\n    select\n        {{ column_name }} as value_field,\n        count(*) as n_records\n\n    from {{ model }}\n    group by {{ column_name }}\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    {% for value in values -%}\n        {% if quote -%}\n        '{{ value }}'\n        {%- else -%}\n        {{ value }}\n        {%- endif -%}\n        {%- if not loop.last -%},{%- endif %}\n    {%- endfor %}\n)\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4917245, "supported_languages": null}, "macro.dbt.default__test_relationships": {"name": "default__test_relationships", "resource_type": "macro", "package_name": "dbt", "path": "macros/generic_test_sql/relationships.sql", "original_file_path": "macros/generic_test_sql/relationships.sql", "unique_id": "macro.dbt.default__test_relationships", "macro_sql": "{% macro default__test_relationships(model, column_name, to, field) %}\n\nwith child as (\n    select {{ column_name }} as from_field\n    from {{ model }}\n    where {{ column_name }} is not null\n),\n\nparent as (\n    select {{ field }} as to_field\n    from {{ to }}\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4922233, "supported_languages": null}, "macro.dbt.replace": {"name": "replace", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/replace.sql", "original_file_path": "macros/utils/replace.sql", "unique_id": "macro.dbt.replace", "macro_sql": "{% macro replace(field, old_chars, new_chars) -%}\n    {{ return(adapter.dispatch('replace', 'dbt') (field, old_chars, new_chars)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__replace"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4927025, "supported_languages": null}, "macro.dbt.default__replace": {"name": "default__replace", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/replace.sql", "original_file_path": "macros/utils/replace.sql", "unique_id": "macro.dbt.default__replace", "macro_sql": "{% macro default__replace(field, old_chars, new_chars) %}\n\n    replace(\n        {{ field }},\n        {{ old_chars }},\n        {{ new_chars }}\n    )\n\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4929624, "supported_languages": null}, "macro.dbt.listagg": {"name": "listagg", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/listagg.sql", "original_file_path": "macros/utils/listagg.sql", "unique_id": "macro.dbt.listagg", "macro_sql": "{% macro listagg(measure, delimiter_text=\"','\", order_by_clause=none, limit_num=none) -%}\n    {{ return(adapter.dispatch('listagg', 'dbt') (measure, delimiter_text, order_by_clause, limit_num)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__listagg"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.49382, "supported_languages": null}, "macro.dbt.default__listagg": {"name": "default__listagg", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/listagg.sql", "original_file_path": "macros/utils/listagg.sql", "unique_id": "macro.dbt.default__listagg", "macro_sql": "{% macro default__listagg(measure, delimiter_text, order_by_clause, limit_num) -%}\n\n    {% if limit_num -%}\n    array_to_string(\n        array_slice(\n            array_agg(\n                {{ measure }}\n            ){% if order_by_clause -%}\n            within group ({{ order_by_clause }})\n            {%- endif %}\n            ,0\n            ,{{ limit_num }}\n        ),\n        {{ delimiter_text }}\n        )\n    {%- else %}\n    listagg(\n        {{ measure }},\n        {{ delimiter_text }}\n        )\n        {% if order_by_clause -%}\n        within group ({{ order_by_clause }})\n        {%- endif %}\n    {%- endif %}\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.494435, "supported_languages": null}, "macro.dbt.right": {"name": "right", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/right.sql", "original_file_path": "macros/utils/right.sql", "unique_id": "macro.dbt.right", "macro_sql": "{% macro right(string_text, length_expression) -%}\n    {{ return(adapter.dispatch('right', 'dbt') (string_text, length_expression)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__right"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4948716, "supported_languages": null}, "macro.dbt.default__right": {"name": "default__right", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/right.sql", "original_file_path": "macros/utils/right.sql", "unique_id": "macro.dbt.default__right", "macro_sql": "{% macro default__right(string_text, length_expression) %}\n\n    right(\n        {{ string_text }},\n        {{ length_expression }}\n    )\n\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4950898, "supported_languages": null}, "macro.dbt.bool_or": {"name": "bool_or", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/bool_or.sql", "original_file_path": "macros/utils/bool_or.sql", "unique_id": "macro.dbt.bool_or", "macro_sql": "{% macro bool_or(expression) -%}\n    {{ return(adapter.dispatch('bool_or', 'dbt') (expression)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__bool_or"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.49546, "supported_languages": null}, "macro.dbt.default__bool_or": {"name": "default__bool_or", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/bool_or.sql", "original_file_path": "macros/utils/bool_or.sql", "unique_id": "macro.dbt.default__bool_or", "macro_sql": "{% macro default__bool_or(expression) -%}\n\n    bool_or({{ expression }})\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4956303, "supported_languages": null}, "macro.dbt.date_trunc": {"name": "date_trunc", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/date_trunc.sql", "original_file_path": "macros/utils/date_trunc.sql", "unique_id": "macro.dbt.date_trunc", "macro_sql": "{% macro date_trunc(datepart, date) -%}\n  {{ return(adapter.dispatch('date_trunc', 'dbt') (datepart, date)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__date_trunc"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.496035, "supported_languages": null}, "macro.dbt.default__date_trunc": {"name": "default__date_trunc", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/date_trunc.sql", "original_file_path": "macros/utils/date_trunc.sql", "unique_id": "macro.dbt.default__date_trunc", "macro_sql": "{% macro default__date_trunc(datepart, date) -%}\n    date_trunc('{{datepart}}', {{date}})\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4962428, "supported_languages": null}, "macro.dbt.hash": {"name": "hash", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/hash.sql", "original_file_path": "macros/utils/hash.sql", "unique_id": "macro.dbt.hash", "macro_sql": "{% macro hash(field) -%}\n  {{ return(adapter.dispatch('hash', 'dbt') (field)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__hash"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4967382, "supported_languages": null}, "macro.dbt.default__hash": {"name": "default__hash", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/hash.sql", "original_file_path": "macros/utils/hash.sql", "unique_id": "macro.dbt.default__hash", "macro_sql": "{% macro default__hash(field) -%}\n    md5(cast({{ field }} as {{ api.Column.translate_type('string') }}))\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4969907, "supported_languages": null}, "macro.dbt.position": {"name": "position", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/position.sql", "original_file_path": "macros/utils/position.sql", "unique_id": "macro.dbt.position", "macro_sql": "{% macro position(substring_text, string_text) -%}\n    {{ return(adapter.dispatch('position', 'dbt') (substring_text, string_text)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__position"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4974167, "supported_languages": null}, "macro.dbt.default__position": {"name": "default__position", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/position.sql", "original_file_path": "macros/utils/position.sql", "unique_id": "macro.dbt.default__position", "macro_sql": "{% macro default__position(substring_text, string_text) %}\n\n    position(\n        {{ substring_text }} in {{ string_text }}\n    )\n\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4976315, "supported_languages": null}, "macro.dbt.concat": {"name": "concat", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/concat.sql", "original_file_path": "macros/utils/concat.sql", "unique_id": "macro.dbt.concat", "macro_sql": "{% macro concat(fields) -%}\n  {{ return(adapter.dispatch('concat', 'dbt')(fields)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__concat"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4979935, "supported_languages": null}, "macro.dbt.default__concat": {"name": "default__concat", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/concat.sql", "original_file_path": "macros/utils/concat.sql", "unique_id": "macro.dbt.default__concat", "macro_sql": "{% macro default__concat(fields) -%}\n    {{ fields|join(' || ') }}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4981902, "supported_languages": null}, "macro.dbt.array_append": {"name": "array_append", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/array_append.sql", "original_file_path": "macros/utils/array_append.sql", "unique_id": "macro.dbt.array_append", "macro_sql": "{% macro array_append(array, new_element) -%}\n  {{ return(adapter.dispatch('array_append', 'dbt')(array, new_element)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__array_append"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4986002, "supported_languages": null}, "macro.dbt.default__array_append": {"name": "default__array_append", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/array_append.sql", "original_file_path": "macros/utils/array_append.sql", "unique_id": "macro.dbt.default__array_append", "macro_sql": "{% macro default__array_append(array, new_element) -%}\n    array_append({{ array }}, {{ new_element }})\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4988086, "supported_languages": null}, "macro.dbt.cast_bool_to_text": {"name": "cast_bool_to_text", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/cast_bool_to_text.sql", "original_file_path": "macros/utils/cast_bool_to_text.sql", "unique_id": "macro.dbt.cast_bool_to_text", "macro_sql": "{% macro cast_bool_to_text(field) %}\n  {{ adapter.dispatch('cast_bool_to_text', 'dbt') (field) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__cast_bool_to_text"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4991727, "supported_languages": null}, "macro.dbt.default__cast_bool_to_text": {"name": "default__cast_bool_to_text", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/cast_bool_to_text.sql", "original_file_path": "macros/utils/cast_bool_to_text.sql", "unique_id": "macro.dbt.default__cast_bool_to_text", "macro_sql": "{% macro default__cast_bool_to_text(field) %}\n    cast({{ field }} as {{ api.Column.translate_type('string') }})\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4994223, "supported_languages": null}, "macro.dbt.except": {"name": "except", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/except.sql", "original_file_path": "macros/utils/except.sql", "unique_id": "macro.dbt.except", "macro_sql": "{% macro except() %}\n  {{ return(adapter.dispatch('except', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__except"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.499758, "supported_languages": null}, "macro.dbt.default__except": {"name": "default__except", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/except.sql", "original_file_path": "macros/utils/except.sql", "unique_id": "macro.dbt.default__except", "macro_sql": "{% macro default__except() %}\n\n    except\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.4998848, "supported_languages": null}, "macro.dbt.dateadd": {"name": "dateadd", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/dateadd.sql", "original_file_path": "macros/utils/dateadd.sql", "unique_id": "macro.dbt.dateadd", "macro_sql": "{% macro dateadd(datepart, interval, from_date_or_timestamp) %}\n  {{ return(adapter.dispatch('dateadd', 'dbt')(datepart, interval, from_date_or_timestamp)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__dateadd"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5003743, "supported_languages": null}, "macro.dbt.default__dateadd": {"name": "default__dateadd", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/dateadd.sql", "original_file_path": "macros/utils/dateadd.sql", "unique_id": "macro.dbt.default__dateadd", "macro_sql": "{% macro default__dateadd(datepart, interval, from_date_or_timestamp) %}\n\n    dateadd(\n        {{ datepart }},\n        {{ interval }},\n        {{ from_date_or_timestamp }}\n        )\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5006328, "supported_languages": null}, "macro.dbt.array_concat": {"name": "array_concat", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/array_concat.sql", "original_file_path": "macros/utils/array_concat.sql", "unique_id": "macro.dbt.array_concat", "macro_sql": "{% macro array_concat(array_1, array_2) -%}\n  {{ return(adapter.dispatch('array_concat', 'dbt')(array_1, array_2)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__array_concat"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5010393, "supported_languages": null}, "macro.dbt.default__array_concat": {"name": "default__array_concat", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/array_concat.sql", "original_file_path": "macros/utils/array_concat.sql", "unique_id": "macro.dbt.default__array_concat", "macro_sql": "{% macro default__array_concat(array_1, array_2) -%}\n    array_cat({{ array_1 }}, {{ array_2 }})\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.50125, "supported_languages": null}, "macro.dbt.split_part": {"name": "split_part", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/split_part.sql", "original_file_path": "macros/utils/split_part.sql", "unique_id": "macro.dbt.split_part", "macro_sql": "{% macro split_part(string_text, delimiter_text, part_number) %}\n  {{ return(adapter.dispatch('split_part', 'dbt') (string_text, delimiter_text, part_number)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__split_part"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5019593, "supported_languages": null}, "macro.dbt.default__split_part": {"name": "default__split_part", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/split_part.sql", "original_file_path": "macros/utils/split_part.sql", "unique_id": "macro.dbt.default__split_part", "macro_sql": "{% macro default__split_part(string_text, delimiter_text, part_number) %}\n\n    split_part(\n        {{ string_text }},\n        {{ delimiter_text }},\n        {{ part_number }}\n        )\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5022178, "supported_languages": null}, "macro.dbt._split_part_negative": {"name": "_split_part_negative", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/split_part.sql", "original_file_path": "macros/utils/split_part.sql", "unique_id": "macro.dbt._split_part_negative", "macro_sql": "{% macro _split_part_negative(string_text, delimiter_text, part_number) %}\n\n    split_part(\n        {{ string_text }},\n        {{ delimiter_text }},\n          length({{ string_text }})\n          - length(\n              replace({{ string_text }},  {{ delimiter_text }}, '')\n          ) + 2 {{ part_number }}\n        )\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.502556, "supported_languages": null}, "macro.dbt.intersect": {"name": "intersect", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/intersect.sql", "original_file_path": "macros/utils/intersect.sql", "unique_id": "macro.dbt.intersect", "macro_sql": "{% macro intersect() %}\n  {{ return(adapter.dispatch('intersect', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__intersect"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5028975, "supported_languages": null}, "macro.dbt.default__intersect": {"name": "default__intersect", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/intersect.sql", "original_file_path": "macros/utils/intersect.sql", "unique_id": "macro.dbt.default__intersect", "macro_sql": "{% macro default__intersect() %}\n\n    intersect\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5030267, "supported_languages": null}, "macro.dbt.array_construct": {"name": "array_construct", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/array_construct.sql", "original_file_path": "macros/utils/array_construct.sql", "unique_id": "macro.dbt.array_construct", "macro_sql": "{% macro array_construct(inputs=[], data_type=api.Column.translate_type('integer')) -%}\n  {{ return(adapter.dispatch('array_construct', 'dbt')(inputs, data_type)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__array_construct"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5035677, "supported_languages": null}, "macro.dbt.default__array_construct": {"name": "default__array_construct", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/array_construct.sql", "original_file_path": "macros/utils/array_construct.sql", "unique_id": "macro.dbt.default__array_construct", "macro_sql": "{% macro default__array_construct(inputs, data_type) -%}\n    {% if inputs|length > 0 %}\n    array[ {{ inputs|join(' , ') }} ]\n    {% else %}\n    array[]::{{data_type}}[]\n    {% endif %}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5039473, "supported_languages": null}, "macro.dbt.datediff": {"name": "datediff", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/datediff.sql", "original_file_path": "macros/utils/datediff.sql", "unique_id": "macro.dbt.datediff", "macro_sql": "{% macro datediff(first_date, second_date, datepart) %}\n  {{ return(adapter.dispatch('datediff', 'dbt')(first_date, second_date, datepart)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__datediff"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.504446, "supported_languages": null}, "macro.dbt.default__datediff": {"name": "default__datediff", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/datediff.sql", "original_file_path": "macros/utils/datediff.sql", "unique_id": "macro.dbt.default__datediff", "macro_sql": "{% macro default__datediff(first_date, second_date, datepart) -%}\n\n    datediff(\n        {{ datepart }},\n        {{ first_date }},\n        {{ second_date }}\n        )\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5047069, "supported_languages": null}, "macro.dbt.safe_cast": {"name": "safe_cast", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/safe_cast.sql", "original_file_path": "macros/utils/safe_cast.sql", "unique_id": "macro.dbt.safe_cast", "macro_sql": "{% macro safe_cast(field, type) %}\n  {{ return(adapter.dispatch('safe_cast', 'dbt') (field, type)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__safe_cast"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5051303, "supported_languages": null}, "macro.dbt.default__safe_cast": {"name": "default__safe_cast", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/safe_cast.sql", "original_file_path": "macros/utils/safe_cast.sql", "unique_id": "macro.dbt.default__safe_cast", "macro_sql": "{% macro default__safe_cast(field, type) %}\n    {# most databases don't support this function yet\n    so we just need to use cast #}\n    cast({{field}} as {{type}})\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5053566, "supported_languages": null}, "macro.dbt.escape_single_quotes": {"name": "escape_single_quotes", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/escape_single_quotes.sql", "original_file_path": "macros/utils/escape_single_quotes.sql", "unique_id": "macro.dbt.escape_single_quotes", "macro_sql": "{% macro escape_single_quotes(expression) %}\n      {{ return(adapter.dispatch('escape_single_quotes', 'dbt') (expression)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__escape_single_quotes"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5057523, "supported_languages": null}, "macro.dbt.default__escape_single_quotes": {"name": "default__escape_single_quotes", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/escape_single_quotes.sql", "original_file_path": "macros/utils/escape_single_quotes.sql", "unique_id": "macro.dbt.default__escape_single_quotes", "macro_sql": "{% macro default__escape_single_quotes(expression) -%}\n{{ expression | replace(\"'\",\"''\") }}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5060823, "supported_languages": null}, "macro.dbt.length": {"name": "length", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/length.sql", "original_file_path": "macros/utils/length.sql", "unique_id": "macro.dbt.length", "macro_sql": "{% macro length(expression) -%}\n    {{ return(adapter.dispatch('length', 'dbt') (expression)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__length"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.506456, "supported_languages": null}, "macro.dbt.default__length": {"name": "default__length", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/length.sql", "original_file_path": "macros/utils/length.sql", "unique_id": "macro.dbt.default__length", "macro_sql": "{% macro default__length(expression) %}\n\n    length(\n        {{ expression }}\n    )\n\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5066261, "supported_languages": null}, "macro.dbt.any_value": {"name": "any_value", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/any_value.sql", "original_file_path": "macros/utils/any_value.sql", "unique_id": "macro.dbt.any_value", "macro_sql": "{% macro any_value(expression) -%}\n    {{ return(adapter.dispatch('any_value', 'dbt') (expression)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__any_value"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.506989, "supported_languages": null}, "macro.dbt.default__any_value": {"name": "default__any_value", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/any_value.sql", "original_file_path": "macros/utils/any_value.sql", "unique_id": "macro.dbt.default__any_value", "macro_sql": "{% macro default__any_value(expression) -%}\n\n    any_value({{ expression }})\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5071557, "supported_languages": null}, "macro.dbt.type_string": {"name": "type_string", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.type_string", "macro_sql": "\n\n{%- macro type_string() -%}\n  {{ return(adapter.dispatch('type_string', 'dbt')()) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__type_string"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5084774, "supported_languages": null}, "macro.dbt.default__type_string": {"name": "default__type_string", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.default__type_string", "macro_sql": "{% macro default__type_string() %}\n    {{ return(api.Column.translate_type(\"string\")) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5087156, "supported_languages": null}, "macro.dbt.type_timestamp": {"name": "type_timestamp", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.type_timestamp", "macro_sql": "\n\n{%- macro type_timestamp() -%}\n  {{ return(adapter.dispatch('type_timestamp', 'dbt')()) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5089645, "supported_languages": null}, "macro.dbt.default__type_timestamp": {"name": "default__type_timestamp", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.default__type_timestamp", "macro_sql": "{% macro default__type_timestamp() %}\n    {{ return(api.Column.translate_type(\"timestamp\")) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5091987, "supported_languages": null}, "macro.dbt.type_float": {"name": "type_float", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.type_float", "macro_sql": "\n\n{%- macro type_float() -%}\n  {{ return(adapter.dispatch('type_float', 'dbt')()) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__type_float"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5094452, "supported_languages": null}, "macro.dbt.default__type_float": {"name": "default__type_float", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.default__type_float", "macro_sql": "{% macro default__type_float() %}\n    {{ return(api.Column.translate_type(\"float\")) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5096784, "supported_languages": null}, "macro.dbt.type_numeric": {"name": "type_numeric", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.type_numeric", "macro_sql": "\n\n{%- macro type_numeric() -%}\n  {{ return(adapter.dispatch('type_numeric', 'dbt')()) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__type_numeric"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5099247, "supported_languages": null}, "macro.dbt.default__type_numeric": {"name": "default__type_numeric", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.default__type_numeric", "macro_sql": "{% macro default__type_numeric() %}\n    {{ return(api.Column.numeric_type(\"numeric\", 28, 6)) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5101933, "supported_languages": null}, "macro.dbt.type_bigint": {"name": "type_bigint", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.type_bigint", "macro_sql": "\n\n{%- macro type_bigint() -%}\n  {{ return(adapter.dispatch('type_bigint', 'dbt')()) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__type_bigint"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5104394, "supported_languages": null}, "macro.dbt.default__type_bigint": {"name": "default__type_bigint", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.default__type_bigint", "macro_sql": "{% macro default__type_bigint() %}\n    {{ return(api.Column.translate_type(\"bigint\")) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.510668, "supported_languages": null}, "macro.dbt.type_int": {"name": "type_int", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.type_int", "macro_sql": "\n\n{%- macro type_int() -%}\n  {{ return(adapter.dispatch('type_int', 'dbt')()) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__type_int"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.510912, "supported_languages": null}, "macro.dbt.default__type_int": {"name": "default__type_int", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.default__type_int", "macro_sql": "{%- macro default__type_int() -%}\n  {{ return(api.Column.translate_type(\"integer\")) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.511136, "supported_languages": null}, "macro.dbt.type_boolean": {"name": "type_boolean", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.type_boolean", "macro_sql": "\n\n{%- macro type_boolean() -%}\n  {{ return(adapter.dispatch('type_boolean', 'dbt')()) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__type_boolean"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5113847, "supported_languages": null}, "macro.dbt.default__type_boolean": {"name": "default__type_boolean", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.default__type_boolean", "macro_sql": "{%- macro default__type_boolean() -%}\n  {{ return(api.Column.translate_type(\"boolean\")) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5116112, "supported_languages": null}, "macro.dbt.string_literal": {"name": "string_literal", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/literal.sql", "original_file_path": "macros/utils/literal.sql", "unique_id": "macro.dbt.string_literal", "macro_sql": "{%- macro string_literal(value) -%}\n  {{ return(adapter.dispatch('string_literal', 'dbt') (value)) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__string_literal"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5119793, "supported_languages": null}, "macro.dbt.default__string_literal": {"name": "default__string_literal", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/literal.sql", "original_file_path": "macros/utils/literal.sql", "unique_id": "macro.dbt.default__string_literal", "macro_sql": "{% macro default__string_literal(value) -%}\n    '{{ value }}'\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.512148, "supported_languages": null}, "macro.dbt.last_day": {"name": "last_day", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/last_day.sql", "original_file_path": "macros/utils/last_day.sql", "unique_id": "macro.dbt.last_day", "macro_sql": "{% macro last_day(date, datepart) %}\n  {{ return(adapter.dispatch('last_day', 'dbt') (date, datepart)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__last_day"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5126653, "supported_languages": null}, "macro.dbt.default_last_day": {"name": "default_last_day", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/last_day.sql", "original_file_path": "macros/utils/last_day.sql", "unique_id": "macro.dbt.default_last_day", "macro_sql": "\n\n{%- macro default_last_day(date, datepart) -%}\n    cast(\n        {{dbt.dateadd('day', '-1',\n        dbt.dateadd(datepart, '1', dbt.date_trunc(datepart, date))\n        )}}\n        as date)\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.dateadd", "macro.dbt.date_trunc"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5130587, "supported_languages": null}, "macro.dbt.default__last_day": {"name": "default__last_day", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/last_day.sql", "original_file_path": "macros/utils/last_day.sql", "unique_id": "macro.dbt.default__last_day", "macro_sql": "{% macro default__last_day(date, datepart) -%}\n    {{dbt.default_last_day(date, datepart)}}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default_last_day"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5132864, "supported_languages": null}, "macro.dbt.resolve_model_name": {"name": "resolve_model_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/python_model/python.sql", "original_file_path": "macros/python_model/python.sql", "unique_id": "macro.dbt.resolve_model_name", "macro_sql": "{% macro resolve_model_name(input_model_name) %}\n    {{ return(adapter.dispatch('resolve_model_name', 'dbt')(input_model_name)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__resolve_model_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.515354, "supported_languages": null}, "macro.dbt.default__resolve_model_name": {"name": "default__resolve_model_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/python_model/python.sql", "original_file_path": "macros/python_model/python.sql", "unique_id": "macro.dbt.default__resolve_model_name", "macro_sql": "\n\n{%- macro default__resolve_model_name(input_model_name) -%}\n    {{  input_model_name | string | replace('\"', '\\\"') }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.515596, "supported_languages": null}, "macro.dbt.build_ref_function": {"name": "build_ref_function", "resource_type": "macro", "package_name": "dbt", "path": "macros/python_model/python.sql", "original_file_path": "macros/python_model/python.sql", "unique_id": "macro.dbt.build_ref_function", "macro_sql": "{% macro build_ref_function(model) %}\n\n    {%- set ref_dict = {} -%}\n    {%- for _ref in model.refs -%}\n        {% set _ref_args = [_ref.get('package'), _ref['name']] if _ref.get('package') else [_ref['name'],] %}\n        {%- set resolved = ref(*_ref_args, v=_ref.get('version')) -%}\n        {%- if _ref.get('version') -%}\n            {% do _ref_args.extend([\"v\" ~ _ref['version']]) %}\n        {%- endif -%}\n       {%- do ref_dict.update({_ref_args | join('.'): resolve_model_name(resolved)}) -%}\n    {%- endfor -%}\n\ndef ref(*args, **kwargs):\n    refs = {{ ref_dict | tojson }}\n    key = '.'.join(args)\n    version = kwargs.get(\"v\") or kwargs.get(\"version\")\n    if version:\n        key += f\".v{version}\"\n    dbt_load_df_function = kwargs.get(\"dbt_load_df_function\")\n    return dbt_load_df_function(refs[key])\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.resolve_model_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5169067, "supported_languages": null}, "macro.dbt.build_source_function": {"name": "build_source_function", "resource_type": "macro", "package_name": "dbt", "path": "macros/python_model/python.sql", "original_file_path": "macros/python_model/python.sql", "unique_id": "macro.dbt.build_source_function", "macro_sql": "{% macro build_source_function(model) %}\n\n    {%- set source_dict = {} -%}\n    {%- for _source in model.sources -%}\n        {%- set resolved = source(*_source) -%}\n        {%- do source_dict.update({_source | join('.'): resolve_model_name(resolved)}) -%}\n    {%- endfor -%}\n\ndef source(*args, dbt_load_df_function):\n    sources = {{ source_dict | tojson }}\n    key = '.'.join(args)\n    return dbt_load_df_function(sources[key])\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.resolve_model_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5175276, "supported_languages": null}, "macro.dbt.build_config_dict": {"name": "build_config_dict", "resource_type": "macro", "package_name": "dbt", "path": "macros/python_model/python.sql", "original_file_path": "macros/python_model/python.sql", "unique_id": "macro.dbt.build_config_dict", "macro_sql": "{% macro build_config_dict(model) %}\n    {%- set config_dict = {} -%}\n    {% set config_dbt_used = zip(model.config.config_keys_used, model.config.config_keys_defaults) | list %}\n    {%- for key, default in config_dbt_used -%}\n        {# weird type testing with enum, would be much easier to write this logic in Python! #}\n        {%- if key == \"language\" -%}\n          {%- set value = \"python\" -%}\n        {%- endif -%}\n        {%- set value = model.config.get(key, default) -%}\n        {%- do config_dict.update({key: value}) -%}\n    {%- endfor -%}\nconfig_dict = {{ config_dict }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5183978, "supported_languages": null}, "macro.dbt.py_script_postfix": {"name": "py_script_postfix", "resource_type": "macro", "package_name": "dbt", "path": "macros/python_model/python.sql", "original_file_path": "macros/python_model/python.sql", "unique_id": "macro.dbt.py_script_postfix", "macro_sql": "{% macro py_script_postfix(model) %}\n# This part is user provided model code\n# you will need to copy the next section to run the code\n# COMMAND ----------\n# this part is dbt logic for get ref work, do not modify\n\n{{ build_ref_function(model ) }}\n{{ build_source_function(model ) }}\n{{ build_config_dict(model) }}\n\nclass config:\n    def __init__(self, *args, **kwargs):\n        pass\n\n    @staticmethod\n    def get(key, default=None):\n        return config_dict.get(key, default)\n\nclass this:\n    \"\"\"dbt.this() or dbt.this.identifier\"\"\"\n    database = \"{{ this.database }}\"\n    schema = \"{{ this.schema }}\"\n    identifier = \"{{ this.identifier }}\"\n    {% set this_relation_name = resolve_model_name(this) %}\n    def __repr__(self):\n        return '{{ this_relation_name  }}'\n\n\nclass dbtObj:\n    def __init__(self, load_df_function) -> None:\n        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)\n        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)\n        self.config = config\n        self.this = this()\n        self.is_incremental = {{ is_incremental() }}\n\n# COMMAND ----------\n{{py_script_comment()}}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.build_ref_function", "macro.dbt.build_source_function", "macro.dbt.build_config_dict", "macro.dbt.resolve_model_name", "macro.dbt.is_incremental", "macro.dbt.py_script_comment"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5191138, "supported_languages": null}, "macro.dbt.py_script_comment": {"name": "py_script_comment", "resource_type": "macro", "package_name": "dbt", "path": "macros/python_model/python.sql", "original_file_path": "macros/python_model/python.sql", "unique_id": "macro.dbt.py_script_comment", "macro_sql": "{%macro py_script_comment()%}\n{%endmacro%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5192385, "supported_languages": null}, "macro.dbt.generate_database_name": {"name": "generate_database_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/get_custom_name/get_custom_database.sql", "original_file_path": "macros/get_custom_name/get_custom_database.sql", "unique_id": "macro.dbt.generate_database_name", "macro_sql": "{% macro generate_database_name(custom_database_name=none, node=none) -%}\n    {% do return(adapter.dispatch('generate_database_name', 'dbt')(custom_database_name, node)) %}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__generate_database_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.519796, "supported_languages": null}, "macro.dbt.default__generate_database_name": {"name": "default__generate_database_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/get_custom_name/get_custom_database.sql", "original_file_path": "macros/get_custom_name/get_custom_database.sql", "unique_id": "macro.dbt.default__generate_database_name", "macro_sql": "{% macro default__generate_database_name(custom_database_name=none, node=none) -%}\n    {%- set default_database = target.database -%}\n    {%- if custom_database_name is none -%}\n\n        {{ default_database }}\n\n    {%- else -%}\n\n        {{ custom_database_name }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5201824, "supported_languages": null}, "macro.dbt.generate_alias_name": {"name": "generate_alias_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/get_custom_name/get_custom_alias.sql", "original_file_path": "macros/get_custom_name/get_custom_alias.sql", "unique_id": "macro.dbt.generate_alias_name", "macro_sql": "{% macro generate_alias_name(custom_alias_name=none, node=none) -%}\n    {% do return(adapter.dispatch('generate_alias_name', 'dbt')(custom_alias_name, node)) %}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__generate_alias_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5207734, "supported_languages": null}, "macro.dbt.default__generate_alias_name": {"name": "default__generate_alias_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/get_custom_name/get_custom_alias.sql", "original_file_path": "macros/get_custom_name/get_custom_alias.sql", "unique_id": "macro.dbt.default__generate_alias_name", "macro_sql": "{% macro default__generate_alias_name(custom_alias_name=none, node=none) -%}\n\n    {%- if custom_alias_name -%}\n\n        {{ custom_alias_name | trim }}\n\n    {%- elif node.version -%}\n\n        {{ return(node.name ~ \"_v\" ~ (node.version | replace(\".\", \"_\"))) }}\n\n    {%- else -%}\n\n        {{ node.name }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5213373, "supported_languages": null}, "macro.dbt.generate_schema_name": {"name": "generate_schema_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/get_custom_name/get_custom_schema.sql", "original_file_path": "macros/get_custom_name/get_custom_schema.sql", "unique_id": "macro.dbt.generate_schema_name", "macro_sql": "{% macro generate_schema_name(custom_schema_name=none, node=none) -%}\n    {{ return(adapter.dispatch('generate_schema_name', 'dbt')(custom_schema_name, node)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__generate_schema_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5220518, "supported_languages": null}, "macro.dbt.default__generate_schema_name": {"name": "default__generate_schema_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/get_custom_name/get_custom_schema.sql", "original_file_path": "macros/get_custom_name/get_custom_schema.sql", "unique_id": "macro.dbt.default__generate_schema_name", "macro_sql": "{% macro default__generate_schema_name(custom_schema_name, node) -%}\n\n    {%- set default_schema = target.schema -%}\n    {%- if custom_schema_name is none -%}\n\n        {{ default_schema }}\n\n    {%- else -%}\n\n        {{ default_schema }}_{{ custom_schema_name | trim }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.522454, "supported_languages": null}, "macro.dbt.generate_schema_name_for_env": {"name": "generate_schema_name_for_env", "resource_type": "macro", "package_name": "dbt", "path": "macros/get_custom_name/get_custom_schema.sql", "original_file_path": "macros/get_custom_name/get_custom_schema.sql", "unique_id": "macro.dbt.generate_schema_name_for_env", "macro_sql": "{% macro generate_schema_name_for_env(custom_schema_name, node) -%}\n\n    {%- set default_schema = target.schema -%}\n    {%- if target.name == 'prod' and custom_schema_name is not none -%}\n\n        {{ custom_schema_name | trim }}\n\n    {%- else -%}\n\n        {{ default_schema }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5228906, "supported_languages": null}, "macro.dbt.statement": {"name": "statement", "resource_type": "macro", "package_name": "dbt", "path": "macros/etc/statement.sql", "original_file_path": "macros/etc/statement.sql", "unique_id": "macro.dbt.statement", "macro_sql": "\n{%- macro statement(name=None, fetch_result=False, auto_begin=True, language='sql') -%}\n  {%- if execute: -%}\n    {%- set compiled_code = caller() -%}\n\n    {%- if name == 'main' -%}\n      {{ log('Writing runtime {} for node \"{}\"'.format(language, model['unique_id'])) }}\n      {{ write(compiled_code) }}\n    {%- endif -%}\n    {%- if language == 'sql'-%}\n      {%- set res, table = adapter.execute(compiled_code, auto_begin=auto_begin, fetch=fetch_result) -%}\n    {%- elif language == 'python' -%}\n      {%- set res = submit_python_job(model, compiled_code) -%}\n      {#-- TODO: What should table be for python models? --#}\n      {%- set table = None -%}\n    {%- else -%}\n      {% do exceptions.raise_compiler_error(\"statement macro didn't get supported language\") %}\n    {%- endif -%}\n\n    {%- if name is not none -%}\n      {{ store_result(name, response=res, agate_table=table) }}\n    {%- endif -%}\n\n  {%- endif -%}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.524943, "supported_languages": null}, "macro.dbt.noop_statement": {"name": "noop_statement", "resource_type": "macro", "package_name": "dbt", "path": "macros/etc/statement.sql", "original_file_path": "macros/etc/statement.sql", "unique_id": "macro.dbt.noop_statement", "macro_sql": "{% macro noop_statement(name=None, message=None, code=None, rows_affected=None, res=None) -%}\n  {%- set sql = caller() -%}\n\n  {%- if name == 'main' -%}\n    {{ log('Writing runtime SQL for node \"{}\"'.format(model['unique_id'])) }}\n    {{ write(sql) }}\n  {%- endif -%}\n\n  {%- if name is not none -%}\n    {{ store_raw_result(name, message=message, code=code, rows_affected=rows_affected, agate_table=res) }}\n  {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5257735, "supported_languages": null}, "macro.dbt.run_query": {"name": "run_query", "resource_type": "macro", "package_name": "dbt", "path": "macros/etc/statement.sql", "original_file_path": "macros/etc/statement.sql", "unique_id": "macro.dbt.run_query", "macro_sql": "{% macro run_query(sql) %}\n  {% call statement(\"run_query_statement\", fetch_result=true, auto_begin=false) %}\n    {{ sql }}\n  {% endcall %}\n\n  {% do return(load_result(\"run_query_statement\").table) %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5262105, "supported_languages": null}, "macro.dbt.convert_datetime": {"name": "convert_datetime", "resource_type": "macro", "package_name": "dbt", "path": "macros/etc/datetime.sql", "original_file_path": "macros/etc/datetime.sql", "unique_id": "macro.dbt.convert_datetime", "macro_sql": "{% macro convert_datetime(date_str, date_fmt) %}\n\n  {% set error_msg -%}\n      The provided partition date '{{ date_str }}' does not match the expected format '{{ date_fmt }}'\n  {%- endset %}\n\n  {% set res = try_or_compiler_error(error_msg, modules.datetime.datetime.strptime, date_str.strip(), date_fmt) %}\n  {{ return(res) }}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5285773, "supported_languages": null}, "macro.dbt.dates_in_range": {"name": "dates_in_range", "resource_type": "macro", "package_name": "dbt", "path": "macros/etc/datetime.sql", "original_file_path": "macros/etc/datetime.sql", "unique_id": "macro.dbt.dates_in_range", "macro_sql": "{% macro dates_in_range(start_date_str, end_date_str=none, in_fmt=\"%Y%m%d\", out_fmt=\"%Y%m%d\") %}\n    {% set end_date_str = start_date_str if end_date_str is none else end_date_str %}\n\n    {% set start_date = convert_datetime(start_date_str, in_fmt) %}\n    {% set end_date = convert_datetime(end_date_str, in_fmt) %}\n\n    {% set day_count = (end_date - start_date).days %}\n    {% if day_count < 0 %}\n        {% set msg -%}\n            Partiton start date is after the end date ({{ start_date }}, {{ end_date }})\n        {%- endset %}\n\n        {{ exceptions.raise_compiler_error(msg, model) }}\n    {% endif %}\n\n    {% set date_list = [] %}\n    {% for i in range(0, day_count + 1) %}\n        {% set the_date = (modules.datetime.timedelta(days=i) + start_date) %}\n        {% if not out_fmt %}\n            {% set _ = date_list.append(the_date) %}\n        {% else %}\n            {% set _ = date_list.append(the_date.strftime(out_fmt)) %}\n        {% endif %}\n    {% endfor %}\n\n    {{ return(date_list) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.convert_datetime"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5303133, "supported_languages": null}, "macro.dbt.partition_range": {"name": "partition_range", "resource_type": "macro", "package_name": "dbt", "path": "macros/etc/datetime.sql", "original_file_path": "macros/etc/datetime.sql", "unique_id": "macro.dbt.partition_range", "macro_sql": "{% macro partition_range(raw_partition_date, date_fmt='%Y%m%d') %}\n    {% set partition_range = (raw_partition_date | string).split(\",\") %}\n\n    {% if (partition_range | length) == 1 %}\n      {% set start_date = partition_range[0] %}\n      {% set end_date = none %}\n    {% elif (partition_range | length) == 2 %}\n      {% set start_date = partition_range[0] %}\n      {% set end_date = partition_range[1] %}\n    {% else %}\n      {{ exceptions.raise_compiler_error(\"Invalid partition time. Expected format: {Start Date}[,{End Date}]. Got: \" ~ raw_partition_date) }}\n    {% endif %}\n\n    {{ return(dates_in_range(start_date, end_date, in_fmt=date_fmt)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.dates_in_range"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5314066, "supported_languages": null}, "macro.dbt.py_current_timestring": {"name": "py_current_timestring", "resource_type": "macro", "package_name": "dbt", "path": "macros/etc/datetime.sql", "original_file_path": "macros/etc/datetime.sql", "unique_id": "macro.dbt.py_current_timestring", "macro_sql": "{% macro py_current_timestring() %}\n    {% set dt = modules.datetime.datetime.now() %}\n    {% do return(dt.strftime(\"%Y%m%d%H%M%S%f\")) %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5317612, "supported_languages": null}, "macro.dbt.run_hooks": {"name": "run_hooks", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/hooks.sql", "original_file_path": "macros/materializations/hooks.sql", "unique_id": "macro.dbt.run_hooks", "macro_sql": "{% macro run_hooks(hooks, inside_transaction=True) %}\n  {% for hook in hooks | selectattr('transaction', 'equalto', inside_transaction)  %}\n    {% if not inside_transaction and loop.first %}\n      {% call statement(auto_begin=inside_transaction) %}\n        commit;\n      {% endcall %}\n    {% endif %}\n    {% set rendered = render(hook.get('sql')) | trim %}\n    {% if (rendered | length) > 0 %}\n      {% call statement(auto_begin=inside_transaction) %}\n        {{ rendered }}\n      {% endcall %}\n    {% endif %}\n  {% endfor %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5332744, "supported_languages": null}, "macro.dbt.make_hook_config": {"name": "make_hook_config", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/hooks.sql", "original_file_path": "macros/materializations/hooks.sql", "unique_id": "macro.dbt.make_hook_config", "macro_sql": "{% macro make_hook_config(sql, inside_transaction) %}\n    {{ tojson({\"sql\": sql, \"transaction\": inside_transaction}) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5335739, "supported_languages": null}, "macro.dbt.before_begin": {"name": "before_begin", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/hooks.sql", "original_file_path": "macros/materializations/hooks.sql", "unique_id": "macro.dbt.before_begin", "macro_sql": "{% macro before_begin(sql) %}\n    {{ make_hook_config(sql, inside_transaction=False) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.make_hook_config"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5338001, "supported_languages": null}, "macro.dbt.in_transaction": {"name": "in_transaction", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/hooks.sql", "original_file_path": "macros/materializations/hooks.sql", "unique_id": "macro.dbt.in_transaction", "macro_sql": "{% macro in_transaction(sql) %}\n    {{ make_hook_config(sql, inside_transaction=True) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.make_hook_config"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5340219, "supported_languages": null}, "macro.dbt.after_commit": {"name": "after_commit", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/hooks.sql", "original_file_path": "macros/materializations/hooks.sql", "unique_id": "macro.dbt.after_commit", "macro_sql": "{% macro after_commit(sql) %}\n    {{ make_hook_config(sql, inside_transaction=False) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.make_hook_config"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5342438, "supported_languages": null}, "macro.dbt.set_sql_header": {"name": "set_sql_header", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/configs.sql", "original_file_path": "macros/materializations/configs.sql", "unique_id": "macro.dbt.set_sql_header", "macro_sql": "{% macro set_sql_header(config) -%}\n  {{ config.set('sql_header', caller()) }}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5347717, "supported_languages": null}, "macro.dbt.should_full_refresh": {"name": "should_full_refresh", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/configs.sql", "original_file_path": "macros/materializations/configs.sql", "unique_id": "macro.dbt.should_full_refresh", "macro_sql": "{% macro should_full_refresh() %}\n  {% set config_full_refresh = config.get('full_refresh') %}\n  {% if config_full_refresh is none %}\n    {% set config_full_refresh = flags.FULL_REFRESH %}\n  {% endif %}\n  {% do return(config_full_refresh) %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5352273, "supported_languages": null}, "macro.dbt.should_store_failures": {"name": "should_store_failures", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/configs.sql", "original_file_path": "macros/materializations/configs.sql", "unique_id": "macro.dbt.should_store_failures", "macro_sql": "{% macro should_store_failures() %}\n  {% set config_store_failures = config.get('store_failures') %}\n  {% if config_store_failures is none %}\n    {% set config_store_failures = flags.STORE_FAILURES %}\n  {% endif %}\n  {% do return(config_store_failures) %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.535683, "supported_languages": null}, "macro.dbt.snapshot_merge_sql": {"name": "snapshot_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/snapshot_merge.sql", "original_file_path": "macros/materializations/snapshots/snapshot_merge.sql", "unique_id": "macro.dbt.snapshot_merge_sql", "macro_sql": "{% macro snapshot_merge_sql(target, source, insert_cols) -%}\n  {{ adapter.dispatch('snapshot_merge_sql', 'dbt')(target, source, insert_cols) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__snapshot_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5362885, "supported_languages": null}, "macro.dbt.default__snapshot_merge_sql": {"name": "default__snapshot_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/snapshot_merge.sql", "original_file_path": "macros/materializations/snapshots/snapshot_merge.sql", "unique_id": "macro.dbt.default__snapshot_merge_sql", "macro_sql": "{% macro default__snapshot_merge_sql(target, source, insert_cols) -%}\n    {%- set insert_cols_csv = insert_cols | join(', ') -%}\n\n    merge into {{ target }} as DBT_INTERNAL_DEST\n    using {{ source }} as DBT_INTERNAL_SOURCE\n    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id\n\n    when matched\n     and DBT_INTERNAL_DEST.dbt_valid_to is null\n     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')\n        then update\n        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to\n\n    when not matched\n     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'\n        then insert ({{ insert_cols_csv }})\n        values ({{ insert_cols_csv }})\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.536715, "supported_languages": null}, "macro.dbt.materialization_snapshot_default": {"name": "materialization_snapshot_default", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/snapshot.sql", "original_file_path": "macros/materializations/snapshots/snapshot.sql", "unique_id": "macro.dbt.materialization_snapshot_default", "macro_sql": "{% materialization snapshot, default %}\n  {%- set config = model['config'] -%}\n\n  {%- set target_table = model.get('alias', model.get('name')) -%}\n\n  {%- set strategy_name = config.get('strategy') -%}\n  {%- set unique_key = config.get('unique_key') %}\n  -- grab current tables grants config for comparision later on\n  {%- set grant_config = config.get('grants') -%}\n\n  {% set target_relation_exists, target_relation = get_or_create_relation(\n          database=model.database,\n          schema=model.schema,\n          identifier=target_table,\n          type='table') -%}\n\n  {%- if not target_relation.is_table -%}\n    {% do exceptions.relation_wrong_type(target_relation, 'table') %}\n  {%- endif -%}\n\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  {% set strategy_macro = strategy_dispatch(strategy_name) %}\n  {% set strategy = strategy_macro(model, \"snapshotted_data\", \"source_data\", config, target_relation_exists) %}\n\n  {% if not target_relation_exists %}\n\n      {% set build_sql = build_snapshot_table(strategy, model['compiled_code']) %}\n      {% set final_sql = create_table_as(False, target_relation, build_sql) %}\n\n  {% else %}\n\n      {{ adapter.valid_snapshot_target(target_relation) }}\n\n      {% set staging_table = build_snapshot_staging_table(strategy, sql, target_relation) %}\n\n      -- this may no-op if the database does not require column expansion\n      {% do adapter.expand_target_column_types(from_relation=staging_table,\n                                               to_relation=target_relation) %}\n\n      {% set missing_columns = adapter.get_missing_columns(staging_table, target_relation)\n                                   | rejectattr('name', 'equalto', 'dbt_change_type')\n                                   | rejectattr('name', 'equalto', 'DBT_CHANGE_TYPE')\n                                   | rejectattr('name', 'equalto', 'dbt_unique_key')\n                                   | rejectattr('name', 'equalto', 'DBT_UNIQUE_KEY')\n                                   | list %}\n\n      {% do create_columns(target_relation, missing_columns) %}\n\n      {% set source_columns = adapter.get_columns_in_relation(staging_table)\n                                   | rejectattr('name', 'equalto', 'dbt_change_type')\n                                   | rejectattr('name', 'equalto', 'DBT_CHANGE_TYPE')\n                                   | rejectattr('name', 'equalto', 'dbt_unique_key')\n                                   | rejectattr('name', 'equalto', 'DBT_UNIQUE_KEY')\n                                   | list %}\n\n      {% set quoted_source_columns = [] %}\n      {% for column in source_columns %}\n        {% do quoted_source_columns.append(adapter.quote(column.name)) %}\n      {% endfor %}\n\n      {% set final_sql = snapshot_merge_sql(\n            target = target_relation,\n            source = staging_table,\n            insert_cols = quoted_source_columns\n         )\n      %}\n\n  {% endif %}\n\n  {% call statement('main') %}\n      {{ final_sql }}\n  {% endcall %}\n\n  {% set should_revoke = should_revoke(target_relation_exists, full_refresh_mode=False) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {% if not target_relation_exists %}\n    {% do create_indexes(target_relation) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {{ adapter.commit() }}\n\n  {% if staging_table is defined %}\n      {% do post_snapshot(staging_table) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmaterialization %}", "depends_on": {"macros": ["macro.dbt.get_or_create_relation", "macro.dbt.run_hooks", "macro.dbt.strategy_dispatch", "macro.dbt.build_snapshot_table", "macro.dbt.create_table_as", "macro.dbt.build_snapshot_staging_table", "macro.dbt.create_columns", "macro.dbt.snapshot_merge_sql", "macro.dbt.statement", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs", "macro.dbt.create_indexes", "macro.dbt.post_snapshot"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5449018, "supported_languages": ["sql"]}, "macro.dbt.create_columns": {"name": "create_columns", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.create_columns", "macro_sql": "{% macro create_columns(relation, columns) %}\n  {{ adapter.dispatch('create_columns', 'dbt')(relation, columns) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__create_columns"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5498643, "supported_languages": null}, "macro.dbt.default__create_columns": {"name": "default__create_columns", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.default__create_columns", "macro_sql": "{% macro default__create_columns(relation, columns) %}\n  {% for column in columns %}\n    {% call statement() %}\n      alter table {{ relation }} add column \"{{ column.name }}\" {{ column.data_type }};\n    {% endcall %}\n  {% endfor %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5502946, "supported_languages": null}, "macro.dbt.post_snapshot": {"name": "post_snapshot", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.post_snapshot", "macro_sql": "{% macro post_snapshot(staging_relation) %}\n  {{ adapter.dispatch('post_snapshot', 'dbt')(staging_relation) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__post_snapshot"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5505524, "supported_languages": null}, "macro.dbt.default__post_snapshot": {"name": "default__post_snapshot", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.default__post_snapshot", "macro_sql": "{% macro default__post_snapshot(staging_relation) %}\n    {# no-op #}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5506978, "supported_languages": null}, "macro.dbt.get_true_sql": {"name": "get_true_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.get_true_sql", "macro_sql": "{% macro get_true_sql() %}\n  {{ adapter.dispatch('get_true_sql', 'dbt')() }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_true_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5509217, "supported_languages": null}, "macro.dbt.default__get_true_sql": {"name": "default__get_true_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.default__get_true_sql", "macro_sql": "{% macro default__get_true_sql() %}\n    {{ return('TRUE') }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5511024, "supported_languages": null}, "macro.dbt.snapshot_staging_table": {"name": "snapshot_staging_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.snapshot_staging_table", "macro_sql": "{% macro snapshot_staging_table(strategy, source_sql, target_relation) -%}\n  {{ adapter.dispatch('snapshot_staging_table', 'dbt')(strategy, source_sql, target_relation) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__snapshot_staging_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.551406, "supported_languages": null}, "macro.dbt.default__snapshot_staging_table": {"name": "default__snapshot_staging_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.default__snapshot_staging_table", "macro_sql": "{% macro default__snapshot_staging_table(strategy, source_sql, target_relation) -%}\n\n    with snapshot_query as (\n\n        {{ source_sql }}\n\n    ),\n\n    snapshotted_data as (\n\n        select *,\n            {{ strategy.unique_key }} as dbt_unique_key\n\n        from {{ target_relation }}\n        where dbt_valid_to is null\n\n    ),\n\n    insertions_source_data as (\n\n        select\n            *,\n            {{ strategy.unique_key }} as dbt_unique_key,\n            {{ strategy.updated_at }} as dbt_updated_at,\n            {{ strategy.updated_at }} as dbt_valid_from,\n            nullif({{ strategy.updated_at }}, {{ strategy.updated_at }}) as dbt_valid_to,\n            {{ strategy.scd_id }} as dbt_scd_id\n\n        from snapshot_query\n    ),\n\n    updates_source_data as (\n\n        select\n            *,\n            {{ strategy.unique_key }} as dbt_unique_key,\n            {{ strategy.updated_at }} as dbt_updated_at,\n            {{ strategy.updated_at }} as dbt_valid_from,\n            {{ strategy.updated_at }} as dbt_valid_to\n\n        from snapshot_query\n    ),\n\n    {%- if strategy.invalidate_hard_deletes %}\n\n    deletes_source_data as (\n\n        select\n            *,\n            {{ strategy.unique_key }} as dbt_unique_key\n        from snapshot_query\n    ),\n    {% endif %}\n\n    insertions as (\n\n        select\n            'insert' as dbt_change_type,\n            source_data.*\n\n        from insertions_source_data as source_data\n        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n        where snapshotted_data.dbt_unique_key is null\n           or (\n                snapshotted_data.dbt_unique_key is not null\n            and (\n                {{ strategy.row_changed }}\n            )\n        )\n\n    ),\n\n    updates as (\n\n        select\n            'update' as dbt_change_type,\n            source_data.*,\n            snapshotted_data.dbt_scd_id\n\n        from updates_source_data as source_data\n        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n        where (\n            {{ strategy.row_changed }}\n        )\n    )\n\n    {%- if strategy.invalidate_hard_deletes -%}\n    ,\n\n    deletes as (\n\n        select\n            'delete' as dbt_change_type,\n            source_data.*,\n            {{ snapshot_get_time() }} as dbt_valid_from,\n            {{ snapshot_get_time() }} as dbt_updated_at,\n            {{ snapshot_get_time() }} as dbt_valid_to,\n            snapshotted_data.dbt_scd_id\n\n        from snapshotted_data\n        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n        where source_data.dbt_unique_key is null\n    )\n    {%- endif %}\n\n    select * from insertions\n    union all\n    select * from updates\n    {%- if strategy.invalidate_hard_deletes %}\n    union all\n    select * from deletes\n    {%- endif %}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.snapshot_get_time"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5527518, "supported_languages": null}, "macro.dbt.build_snapshot_table": {"name": "build_snapshot_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.build_snapshot_table", "macro_sql": "{% macro build_snapshot_table(strategy, sql) -%}\n  {{ adapter.dispatch('build_snapshot_table', 'dbt')(strategy, sql) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__build_snapshot_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5530381, "supported_languages": null}, "macro.dbt.default__build_snapshot_table": {"name": "default__build_snapshot_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.default__build_snapshot_table", "macro_sql": "{% macro default__build_snapshot_table(strategy, sql) %}\n\n    select *,\n        {{ strategy.scd_id }} as dbt_scd_id,\n        {{ strategy.updated_at }} as dbt_updated_at,\n        {{ strategy.updated_at }} as dbt_valid_from,\n        nullif({{ strategy.updated_at }}, {{ strategy.updated_at }}) as dbt_valid_to\n    from (\n        {{ sql }}\n    ) sbq\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5534248, "supported_languages": null}, "macro.dbt.build_snapshot_staging_table": {"name": "build_snapshot_staging_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.build_snapshot_staging_table", "macro_sql": "{% macro build_snapshot_staging_table(strategy, sql, target_relation) %}\n    {% set temp_relation = make_temp_relation(target_relation) %}\n\n    {% set select = snapshot_staging_table(strategy, sql, target_relation) %}\n\n    {% call statement('build_snapshot_staging_relation') %}\n        {{ create_table_as(True, temp_relation, select) }}\n    {% endcall %}\n\n    {% do return(temp_relation) %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.make_temp_relation", "macro.dbt.snapshot_staging_table", "macro.dbt.statement", "macro.dbt.create_table_as"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5540528, "supported_languages": null}, "macro.dbt.strategy_dispatch": {"name": "strategy_dispatch", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "unique_id": "macro.dbt.strategy_dispatch", "macro_sql": "{% macro strategy_dispatch(name) -%}\n{% set original_name = name %}\n  {% if '.' in name %}\n    {% set package_name, name = name.split(\".\", 1) %}\n  {% else %}\n    {% set package_name = none %}\n  {% endif %}\n\n  {% if package_name is none %}\n    {% set package_context = context %}\n  {% elif package_name in context %}\n    {% set package_context = context[package_name] %}\n  {% else %}\n    {% set error_msg %}\n        Could not find package '{{package_name}}', called with '{{original_name}}'\n    {% endset %}\n    {{ exceptions.raise_compiler_error(error_msg | trim) }}\n  {% endif %}\n\n  {%- set search_name = 'snapshot_' ~ name ~ '_strategy' -%}\n\n  {% if search_name not in package_context %}\n    {% set error_msg %}\n        The specified strategy macro '{{name}}' was not found in package '{{ package_name }}'\n    {% endset %}\n    {{ exceptions.raise_compiler_error(error_msg | trim) }}\n  {% endif %}\n  {{ return(package_context[search_name]) }}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5586443, "supported_languages": null}, "macro.dbt.snapshot_hash_arguments": {"name": "snapshot_hash_arguments", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "unique_id": "macro.dbt.snapshot_hash_arguments", "macro_sql": "{% macro snapshot_hash_arguments(args) -%}\n  {{ adapter.dispatch('snapshot_hash_arguments', 'dbt')(args) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__snapshot_hash_arguments"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.558907, "supported_languages": null}, "macro.dbt.default__snapshot_hash_arguments": {"name": "default__snapshot_hash_arguments", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "unique_id": "macro.dbt.default__snapshot_hash_arguments", "macro_sql": "{% macro default__snapshot_hash_arguments(args) -%}\n    md5({%- for arg in args -%}\n        coalesce(cast({{ arg }} as varchar ), '')\n        {% if not loop.last %} || '|' || {% endif %}\n    {%- endfor -%})\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5592527, "supported_languages": null}, "macro.dbt.snapshot_timestamp_strategy": {"name": "snapshot_timestamp_strategy", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "unique_id": "macro.dbt.snapshot_timestamp_strategy", "macro_sql": "{% macro snapshot_timestamp_strategy(node, snapshotted_rel, current_rel, config, target_exists) %}\n    {% set primary_key = config['unique_key'] %}\n    {% set updated_at = config['updated_at'] %}\n    {% set invalidate_hard_deletes = config.get('invalidate_hard_deletes', false) %}\n\n    {#/*\n        The snapshot relation might not have an {{ updated_at }} value if the\n        snapshot strategy is changed from `check` to `timestamp`. We\n        should use a dbt-created column for the comparison in the snapshot\n        table instead of assuming that the user-supplied {{ updated_at }}\n        will be present in the historical data.\n\n        See https://github.com/dbt-labs/dbt-core/issues/2350\n    */ #}\n    {% set row_changed_expr -%}\n        ({{ snapshotted_rel }}.dbt_valid_from < {{ current_rel }}.{{ updated_at }})\n    {%- endset %}\n\n    {% set scd_id_expr = snapshot_hash_arguments([primary_key, updated_at]) %}\n\n    {% do return({\n        \"unique_key\": primary_key,\n        \"updated_at\": updated_at,\n        \"row_changed\": row_changed_expr,\n        \"scd_id\": scd_id_expr,\n        \"invalidate_hard_deletes\": invalidate_hard_deletes\n    }) %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.snapshot_hash_arguments"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5602999, "supported_languages": null}, "macro.dbt.snapshot_string_as_time": {"name": "snapshot_string_as_time", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "unique_id": "macro.dbt.snapshot_string_as_time", "macro_sql": "{% macro snapshot_string_as_time(timestamp) -%}\n    {{ adapter.dispatch('snapshot_string_as_time', 'dbt')(timestamp) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__snapshot_string_as_time"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5605626, "supported_languages": null}, "macro.dbt.default__snapshot_string_as_time": {"name": "default__snapshot_string_as_time", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "unique_id": "macro.dbt.default__snapshot_string_as_time", "macro_sql": "{% macro default__snapshot_string_as_time(timestamp) %}\n    {% do exceptions.raise_not_implemented(\n        'snapshot_string_as_time macro not implemented for adapter '+adapter.type()\n    ) %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5608325, "supported_languages": null}, "macro.dbt.snapshot_check_all_get_existing_columns": {"name": "snapshot_check_all_get_existing_columns", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "unique_id": "macro.dbt.snapshot_check_all_get_existing_columns", "macro_sql": "{% macro snapshot_check_all_get_existing_columns(node, target_exists, check_cols_config) -%}\n    {%- if not target_exists -%}\n        {#-- no table yet -> return whatever the query does --#}\n        {{ return((false, query_columns)) }}\n    {%- endif -%}\n\n    {#-- handle any schema changes --#}\n    {%- set target_relation = adapter.get_relation(database=node.database, schema=node.schema, identifier=node.alias) -%}\n\n    {% if check_cols_config == 'all' %}\n        {%- set query_columns = get_columns_in_query(node['compiled_code']) -%}\n\n    {% elif check_cols_config is iterable and (check_cols_config | length) > 0 %}\n        {#-- query for proper casing/quoting, to support comparison below --#}\n        {%- set select_check_cols_from_target -%}\n            {#-- N.B. The whitespace below is necessary to avoid edge case issue with comments --#}\n            {#-- See: https://github.com/dbt-labs/dbt-core/issues/6781 --#}\n            select {{ check_cols_config | join(', ') }} from (\n                {{ node['compiled_code'] }}\n            ) subq\n        {%- endset -%}\n        {% set query_columns = get_columns_in_query(select_check_cols_from_target) %}\n\n    {% else %}\n        {% do exceptions.raise_compiler_error(\"Invalid value for 'check_cols': \" ~ check_cols_config) %}\n    {% endif %}\n\n    {%- set existing_cols = adapter.get_columns_in_relation(target_relation) | map(attribute = 'name') | list -%}\n    {%- set ns = namespace() -%} {#-- handle for-loop scoping with a namespace --#}\n    {%- set ns.column_added = false -%}\n\n    {%- set intersection = [] -%}\n    {%- for col in query_columns -%}\n        {%- if col in existing_cols -%}\n            {%- do intersection.append(adapter.quote(col)) -%}\n        {%- else -%}\n            {% set ns.column_added = true %}\n        {%- endif -%}\n    {%- endfor -%}\n    {{ return((ns.column_added, intersection)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.get_columns_in_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5628738, "supported_languages": null}, "macro.dbt.snapshot_check_strategy": {"name": "snapshot_check_strategy", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "unique_id": "macro.dbt.snapshot_check_strategy", "macro_sql": "{% macro snapshot_check_strategy(node, snapshotted_rel, current_rel, config, target_exists) %}\n    {% set check_cols_config = config['check_cols'] %}\n    {% set primary_key = config['unique_key'] %}\n    {% set invalidate_hard_deletes = config.get('invalidate_hard_deletes', false) %}\n    {% set updated_at = config.get('updated_at', snapshot_get_time()) %}\n\n    {% set column_added = false %}\n\n    {% set column_added, check_cols = snapshot_check_all_get_existing_columns(node, target_exists, check_cols_config) %}\n\n    {%- set row_changed_expr -%}\n    (\n    {%- if column_added -%}\n        {{ get_true_sql() }}\n    {%- else -%}\n    {%- for col in check_cols -%}\n        {{ snapshotted_rel }}.{{ col }} != {{ current_rel }}.{{ col }}\n        or\n        (\n            (({{ snapshotted_rel }}.{{ col }} is null) and not ({{ current_rel }}.{{ col }} is null))\n            or\n            ((not {{ snapshotted_rel }}.{{ col }} is null) and ({{ current_rel }}.{{ col }} is null))\n        )\n        {%- if not loop.last %} or {% endif -%}\n    {%- endfor -%}\n    {%- endif -%}\n    )\n    {%- endset %}\n\n    {% set scd_id_expr = snapshot_hash_arguments([primary_key, updated_at]) %}\n\n    {% do return({\n        \"unique_key\": primary_key,\n        \"updated_at\": updated_at,\n        \"row_changed\": row_changed_expr,\n        \"scd_id\": scd_id_expr,\n        \"invalidate_hard_deletes\": invalidate_hard_deletes\n    }) %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.snapshot_get_time", "macro.dbt.snapshot_check_all_get_existing_columns", "macro.dbt.get_true_sql", "macro.dbt.snapshot_hash_arguments"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5648944, "supported_languages": null}, "macro.dbt.is_incremental": {"name": "is_incremental", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/is_incremental.sql", "original_file_path": "macros/materializations/models/incremental/is_incremental.sql", "unique_id": "macro.dbt.is_incremental", "macro_sql": "{% macro is_incremental() %}\n    {#-- do not run introspective queries in parsing #}\n    {% if not execute %}\n        {{ return(False) }}\n    {% else %}\n        {% set relation = adapter.get_relation(this.database, this.schema, this.table) %}\n        {{ return(relation is not none\n                  and relation.type == 'table'\n                  and model.config.materialized == 'incremental'\n                  and not should_full_refresh()) }}\n    {% endif %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.should_full_refresh"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5658057, "supported_languages": null}, "macro.dbt.get_quoted_csv": {"name": "get_quoted_csv", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/column_helpers.sql", "original_file_path": "macros/materializations/models/incremental/column_helpers.sql", "unique_id": "macro.dbt.get_quoted_csv", "macro_sql": "{% macro get_quoted_csv(column_names) %}\n\n    {% set quoted = [] %}\n    {% for col in column_names -%}\n        {%- do quoted.append(adapter.quote(col)) -%}\n    {%- endfor %}\n\n    {%- set dest_cols_csv = quoted | join(', ') -%}\n    {{ return(dest_cols_csv) }}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5678847, "supported_languages": null}, "macro.dbt.diff_columns": {"name": "diff_columns", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/column_helpers.sql", "original_file_path": "macros/materializations/models/incremental/column_helpers.sql", "unique_id": "macro.dbt.diff_columns", "macro_sql": "{% macro diff_columns(source_columns, target_columns) %}\n\n  {% set result = [] %}\n  {% set source_names = source_columns | map(attribute = 'column') | list %}\n  {% set target_names = target_columns | map(attribute = 'column') | list %}\n\n   {# --check whether the name attribute exists in the target - this does not perform a data type check #}\n   {% for sc in source_columns %}\n     {% if sc.name not in target_names %}\n        {{ result.append(sc) }}\n     {% endif %}\n   {% endfor %}\n\n  {{ return(result) }}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5687063, "supported_languages": null}, "macro.dbt.diff_column_data_types": {"name": "diff_column_data_types", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/column_helpers.sql", "original_file_path": "macros/materializations/models/incremental/column_helpers.sql", "unique_id": "macro.dbt.diff_column_data_types", "macro_sql": "{% macro diff_column_data_types(source_columns, target_columns) %}\n\n  {% set result = [] %}\n  {% for sc in source_columns %}\n    {% set tc = target_columns | selectattr(\"name\", \"equalto\", sc.name) | list | first %}\n    {% if tc %}\n      {% if sc.data_type != tc.data_type and not sc.can_expand_to(other_column=tc) %}\n        {{ result.append( { 'column_name': tc.name, 'new_type': sc.data_type } ) }}\n      {% endif %}\n    {% endif %}\n  {% endfor %}\n\n  {{ return(result) }}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5696728, "supported_languages": null}, "macro.dbt.get_merge_update_columns": {"name": "get_merge_update_columns", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/column_helpers.sql", "original_file_path": "macros/materializations/models/incremental/column_helpers.sql", "unique_id": "macro.dbt.get_merge_update_columns", "macro_sql": "{% macro get_merge_update_columns(merge_update_columns, merge_exclude_columns, dest_columns) %}\n  {{ return(adapter.dispatch('get_merge_update_columns', 'dbt')(merge_update_columns, merge_exclude_columns, dest_columns)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_merge_update_columns"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5700228, "supported_languages": null}, "macro.dbt.default__get_merge_update_columns": {"name": "default__get_merge_update_columns", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/column_helpers.sql", "original_file_path": "macros/materializations/models/incremental/column_helpers.sql", "unique_id": "macro.dbt.default__get_merge_update_columns", "macro_sql": "{% macro default__get_merge_update_columns(merge_update_columns, merge_exclude_columns, dest_columns) %}\n  {%- set default_cols = dest_columns | map(attribute=\"quoted\") | list -%}\n\n  {%- if merge_update_columns and merge_exclude_columns -%}\n    {{ exceptions.raise_compiler_error(\n        'Model cannot specify merge_update_columns and merge_exclude_columns. Please update model to use only one config'\n    )}}\n  {%- elif merge_update_columns -%}\n    {%- set update_columns = merge_update_columns -%}\n  {%- elif merge_exclude_columns -%}\n    {%- set update_columns = [] -%}\n    {%- for column in dest_columns -%}\n      {% if column.column | lower not in merge_exclude_columns | map(\"lower\") | list %}\n        {%- do update_columns.append(column.quoted) -%}\n      {% endif %}\n    {%- endfor -%}\n  {%- else -%}\n    {%- set update_columns = default_cols -%}\n  {%- endif -%}\n\n  {{ return(update_columns) }}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5710912, "supported_languages": null}, "macro.dbt.incremental_validate_on_schema_change": {"name": "incremental_validate_on_schema_change", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/on_schema_change.sql", "original_file_path": "macros/materializations/models/incremental/on_schema_change.sql", "unique_id": "macro.dbt.incremental_validate_on_schema_change", "macro_sql": "{% macro incremental_validate_on_schema_change(on_schema_change, default='ignore') %}\n\n   {% if on_schema_change not in ['sync_all_columns', 'append_new_columns', 'fail', 'ignore'] %}\n\n     {% set log_message = 'Invalid value for on_schema_change (%s) specified. Setting default value of %s.' % (on_schema_change, default) %}\n     {% do log(log_message) %}\n\n     {{ return(default) }}\n\n   {% else %}\n\n     {{ return(on_schema_change) }}\n\n   {% endif %}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5780082, "supported_languages": null}, "macro.dbt.check_for_schema_changes": {"name": "check_for_schema_changes", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/on_schema_change.sql", "original_file_path": "macros/materializations/models/incremental/on_schema_change.sql", "unique_id": "macro.dbt.check_for_schema_changes", "macro_sql": "{% macro check_for_schema_changes(source_relation, target_relation) %}\n\n  {% set schema_changed = False %}\n\n  {%- set source_columns = adapter.get_columns_in_relation(source_relation) -%}\n  {%- set target_columns = adapter.get_columns_in_relation(target_relation) -%}\n  {%- set source_not_in_target = diff_columns(source_columns, target_columns) -%}\n  {%- set target_not_in_source = diff_columns(target_columns, source_columns) -%}\n\n  {% set new_target_types = diff_column_data_types(source_columns, target_columns) %}\n\n  {% if source_not_in_target != [] %}\n    {% set schema_changed = True %}\n  {% elif target_not_in_source != [] or new_target_types != [] %}\n    {% set schema_changed = True %}\n  {% elif new_target_types != [] %}\n    {% set schema_changed = True %}\n  {% endif %}\n\n  {% set changes_dict = {\n    'schema_changed': schema_changed,\n    'source_not_in_target': source_not_in_target,\n    'target_not_in_source': target_not_in_source,\n    'source_columns': source_columns,\n    'target_columns': target_columns,\n    'new_target_types': new_target_types\n  } %}\n\n  {% set msg %}\n    In {{ target_relation }}:\n        Schema changed: {{ schema_changed }}\n        Source columns not in target: {{ source_not_in_target }}\n        Target columns not in source: {{ target_not_in_source }}\n        New column types: {{ new_target_types }}\n  {% endset %}\n\n  {% do log(msg) %}\n\n  {{ return(changes_dict) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.diff_columns", "macro.dbt.diff_column_data_types"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5797708, "supported_languages": null}, "macro.dbt.sync_column_schemas": {"name": "sync_column_schemas", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/on_schema_change.sql", "original_file_path": "macros/materializations/models/incremental/on_schema_change.sql", "unique_id": "macro.dbt.sync_column_schemas", "macro_sql": "{% macro sync_column_schemas(on_schema_change, target_relation, schema_changes_dict) %}\n\n  {%- set add_to_target_arr = schema_changes_dict['source_not_in_target'] -%}\n\n  {%- if on_schema_change == 'append_new_columns'-%}\n     {%- if add_to_target_arr | length > 0 -%}\n       {%- do alter_relation_add_remove_columns(target_relation, add_to_target_arr, none) -%}\n     {%- endif -%}\n\n  {% elif on_schema_change == 'sync_all_columns' %}\n     {%- set remove_from_target_arr = schema_changes_dict['target_not_in_source'] -%}\n     {%- set new_target_types = schema_changes_dict['new_target_types'] -%}\n\n     {% if add_to_target_arr | length > 0 or remove_from_target_arr | length > 0 %}\n       {%- do alter_relation_add_remove_columns(target_relation, add_to_target_arr, remove_from_target_arr) -%}\n     {% endif %}\n\n     {% if new_target_types != [] %}\n       {% for ntt in new_target_types %}\n         {% set column_name = ntt['column_name'] %}\n         {% set new_type = ntt['new_type'] %}\n         {% do alter_column_type(target_relation, column_name, new_type) %}\n       {% endfor %}\n     {% endif %}\n\n  {% endif %}\n\n  {% set schema_change_message %}\n    In {{ target_relation }}:\n        Schema change approach: {{ on_schema_change }}\n        Columns added: {{ add_to_target_arr }}\n        Columns removed: {{ remove_from_target_arr }}\n        Data types changed: {{ new_target_types }}\n  {% endset %}\n\n  {% do log(schema_change_message) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.alter_relation_add_remove_columns", "macro.dbt.alter_column_type"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5815222, "supported_languages": null}, "macro.dbt.process_schema_changes": {"name": "process_schema_changes", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/on_schema_change.sql", "original_file_path": "macros/materializations/models/incremental/on_schema_change.sql", "unique_id": "macro.dbt.process_schema_changes", "macro_sql": "{% macro process_schema_changes(on_schema_change, source_relation, target_relation) %}\n\n    {% if on_schema_change == 'ignore' %}\n\n     {{ return({}) }}\n\n    {% else %}\n\n      {% set schema_changes_dict = check_for_schema_changes(source_relation, target_relation) %}\n\n      {% if schema_changes_dict['schema_changed'] %}\n\n        {% if on_schema_change == 'fail' %}\n\n          {% set fail_msg %}\n              The source and target schemas on this incremental model are out of sync!\n              They can be reconciled in several ways:\n                - set the `on_schema_change` config to either append_new_columns or sync_all_columns, depending on your situation.\n                - Re-run the incremental model with `full_refresh: True` to update the target schema.\n                - update the schema manually and re-run the process.\n\n              Additional troubleshooting context:\n                 Source columns not in target: {{ schema_changes_dict['source_not_in_target'] }}\n                 Target columns not in source: {{ schema_changes_dict['target_not_in_source'] }}\n                 New column types: {{ schema_changes_dict['new_target_types'] }}\n          {% endset %}\n\n          {% do exceptions.raise_compiler_error(fail_msg) %}\n\n        {# -- unless we ignore, run the sync operation per the config #}\n        {% else %}\n\n          {% do sync_column_schemas(on_schema_change, target_relation, schema_changes_dict) %}\n\n        {% endif %}\n\n      {% endif %}\n\n      {{ return(schema_changes_dict['source_columns']) }}\n\n    {% endif %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.check_for_schema_changes", "macro.dbt.sync_column_schemas"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5827835, "supported_languages": null}, "macro.dbt.get_incremental_append_sql": {"name": "get_incremental_append_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.get_incremental_append_sql", "macro_sql": "{% macro get_incremental_append_sql(arg_dict) %}\n\n  {{ return(adapter.dispatch('get_incremental_append_sql', 'dbt')(arg_dict)) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_incremental_append_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5839677, "supported_languages": null}, "macro.dbt.default__get_incremental_append_sql": {"name": "default__get_incremental_append_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.default__get_incremental_append_sql", "macro_sql": "{% macro default__get_incremental_append_sql(arg_dict) %}\n\n  {% do return(get_insert_into_sql(arg_dict[\"target_relation\"], arg_dict[\"temp_relation\"], arg_dict[\"dest_columns\"])) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_insert_into_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.584323, "supported_languages": null}, "macro.dbt.get_incremental_delete_insert_sql": {"name": "get_incremental_delete_insert_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.get_incremental_delete_insert_sql", "macro_sql": "{% macro get_incremental_delete_insert_sql(arg_dict) %}\n\n  {{ return(adapter.dispatch('get_incremental_delete_insert_sql', 'dbt')(arg_dict)) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_incremental_delete_insert_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5846052, "supported_languages": null}, "macro.dbt.default__get_incremental_delete_insert_sql": {"name": "default__get_incremental_delete_insert_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.default__get_incremental_delete_insert_sql", "macro_sql": "{% macro default__get_incremental_delete_insert_sql(arg_dict) %}\n\n  {% do return(get_delete_insert_merge_sql(arg_dict[\"target_relation\"], arg_dict[\"temp_relation\"], arg_dict[\"unique_key\"], arg_dict[\"dest_columns\"], arg_dict[\"incremental_predicates\"])) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_delete_insert_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5850337, "supported_languages": null}, "macro.dbt.get_incremental_merge_sql": {"name": "get_incremental_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.get_incremental_merge_sql", "macro_sql": "{% macro get_incremental_merge_sql(arg_dict) %}\n\n  {{ return(adapter.dispatch('get_incremental_merge_sql', 'dbt')(arg_dict)) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_incremental_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5853152, "supported_languages": null}, "macro.dbt.default__get_incremental_merge_sql": {"name": "default__get_incremental_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.default__get_incremental_merge_sql", "macro_sql": "{% macro default__get_incremental_merge_sql(arg_dict) %}\n\n  {% do return(get_merge_sql(arg_dict[\"target_relation\"], arg_dict[\"temp_relation\"], arg_dict[\"unique_key\"], arg_dict[\"dest_columns\"], arg_dict[\"incremental_predicates\"])) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5857418, "supported_languages": null}, "macro.dbt.get_incremental_insert_overwrite_sql": {"name": "get_incremental_insert_overwrite_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.get_incremental_insert_overwrite_sql", "macro_sql": "{% macro get_incremental_insert_overwrite_sql(arg_dict) %}\n\n  {{ return(adapter.dispatch('get_incremental_insert_overwrite_sql', 'dbt')(arg_dict)) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_incremental_insert_overwrite_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5860229, "supported_languages": null}, "macro.dbt.default__get_incremental_insert_overwrite_sql": {"name": "default__get_incremental_insert_overwrite_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.default__get_incremental_insert_overwrite_sql", "macro_sql": "{% macro default__get_incremental_insert_overwrite_sql(arg_dict) %}\n\n  {% do return(get_insert_overwrite_merge_sql(arg_dict[\"target_relation\"], arg_dict[\"temp_relation\"], arg_dict[\"dest_columns\"], arg_dict[\"incremental_predicates\"])) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_insert_overwrite_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.586408, "supported_languages": null}, "macro.dbt.get_incremental_default_sql": {"name": "get_incremental_default_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.get_incremental_default_sql", "macro_sql": "{% macro get_incremental_default_sql(arg_dict) %}\n\n  {{ return(adapter.dispatch('get_incremental_default_sql', 'dbt')(arg_dict)) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_incremental_default_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5866897, "supported_languages": null}, "macro.dbt.default__get_incremental_default_sql": {"name": "default__get_incremental_default_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.default__get_incremental_default_sql", "macro_sql": "{% macro default__get_incremental_default_sql(arg_dict) %}\n\n  {% do return(get_incremental_append_sql(arg_dict)) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_incremental_append_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.586922, "supported_languages": null}, "macro.dbt.get_insert_into_sql": {"name": "get_insert_into_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.get_insert_into_sql", "macro_sql": "{% macro get_insert_into_sql(target_relation, temp_relation, dest_columns) %}\n\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n\n    insert into {{ target_relation }} ({{ dest_cols_csv }})\n    (\n        select {{ dest_cols_csv }}\n        from {{ temp_relation }}\n    )\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5873363, "supported_languages": null}, "macro.dbt.get_merge_sql": {"name": "get_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "unique_id": "macro.dbt.get_merge_sql", "macro_sql": "{% macro get_merge_sql(target, source, unique_key, dest_columns, incremental_predicates=none) -%}\n   -- back compat for old kwarg name\n  {% set incremental_predicates = kwargs.get('predicates', incremental_predicates) %}\n  {{ adapter.dispatch('get_merge_sql', 'dbt')(target, source, unique_key, dest_columns, incremental_predicates) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.59506, "supported_languages": null}, "macro.dbt.default__get_merge_sql": {"name": "default__get_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "unique_id": "macro.dbt.default__get_merge_sql", "macro_sql": "{% macro default__get_merge_sql(target, source, unique_key, dest_columns, incremental_predicates=none) -%}\n    {%- set predicates = [] if incremental_predicates is none else [] + incremental_predicates -%}\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n    {%- set merge_update_columns = config.get('merge_update_columns') -%}\n    {%- set merge_exclude_columns = config.get('merge_exclude_columns') -%}\n    {%- set update_columns = get_merge_update_columns(merge_update_columns, merge_exclude_columns, dest_columns) -%}\n    {%- set sql_header = config.get('sql_header', none) -%}\n\n    {% if unique_key %}\n        {% if unique_key is sequence and unique_key is not mapping and unique_key is not string %}\n            {% for key in unique_key %}\n                {% set this_key_match %}\n                    DBT_INTERNAL_SOURCE.{{ key }} = DBT_INTERNAL_DEST.{{ key }}\n                {% endset %}\n                {% do predicates.append(this_key_match) %}\n            {% endfor %}\n        {% else %}\n            {% set unique_key_match %}\n                DBT_INTERNAL_SOURCE.{{ unique_key }} = DBT_INTERNAL_DEST.{{ unique_key }}\n            {% endset %}\n            {% do predicates.append(unique_key_match) %}\n        {% endif %}\n    {% else %}\n        {% do predicates.append('FALSE') %}\n    {% endif %}\n\n    {{ sql_header if sql_header is not none }}\n\n    merge into {{ target }} as DBT_INTERNAL_DEST\n        using {{ source }} as DBT_INTERNAL_SOURCE\n        on {{\"(\" ~ predicates | join(\") and (\") ~ \")\"}}\n\n    {% if unique_key %}\n    when matched then update set\n        {% for column_name in update_columns -%}\n            {{ column_name }} = DBT_INTERNAL_SOURCE.{{ column_name }}\n            {%- if not loop.last %}, {%- endif %}\n        {%- endfor %}\n    {% endif %}\n\n    when not matched then insert\n        ({{ dest_cols_csv }})\n    values\n        ({{ dest_cols_csv }})\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_quoted_csv", "macro.dbt.get_merge_update_columns"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5975485, "supported_languages": null}, "macro.dbt.get_delete_insert_merge_sql": {"name": "get_delete_insert_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "unique_id": "macro.dbt.get_delete_insert_merge_sql", "macro_sql": "{% macro get_delete_insert_merge_sql(target, source, unique_key, dest_columns, incremental_predicates) -%}\n  {{ adapter.dispatch('get_delete_insert_merge_sql', 'dbt')(target, source, unique_key, dest_columns, incremental_predicates) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_delete_insert_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.597934, "supported_languages": null}, "macro.dbt.default__get_delete_insert_merge_sql": {"name": "default__get_delete_insert_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "unique_id": "macro.dbt.default__get_delete_insert_merge_sql", "macro_sql": "{% macro default__get_delete_insert_merge_sql(target, source, unique_key, dest_columns, incremental_predicates) -%}\n\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n\n    {% if unique_key %}\n        {% if unique_key is sequence and unique_key is not string %}\n            delete from {{target }}\n            using {{ source }}\n            where (\n                {% for key in unique_key %}\n                    {{ source }}.{{ key }} = {{ target }}.{{ key }}\n                    {{ \"and \" if not loop.last}}\n                {% endfor %}\n                {% if incremental_predicates %}\n                    {% for predicate in incremental_predicates %}\n                        and {{ predicate }}\n                    {% endfor %}\n                {% endif %}\n            );\n        {% else %}\n            delete from {{ target }}\n            where (\n                {{ unique_key }}) in (\n                select ({{ unique_key }})\n                from {{ source }}\n            )\n            {%- if incremental_predicates %}\n                {% for predicate in incremental_predicates %}\n                    and {{ predicate }}\n                {% endfor %}\n            {%- endif -%};\n\n        {% endif %}\n    {% endif %}\n\n    insert into {{ target }} ({{ dest_cols_csv }})\n    (\n        select {{ dest_cols_csv }}\n        from {{ source }}\n    )\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.get_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5994124, "supported_languages": null}, "macro.dbt.get_insert_overwrite_merge_sql": {"name": "get_insert_overwrite_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "unique_id": "macro.dbt.get_insert_overwrite_merge_sql", "macro_sql": "{% macro get_insert_overwrite_merge_sql(target, source, dest_columns, predicates, include_sql_header=false) -%}\n  {{ adapter.dispatch('get_insert_overwrite_merge_sql', 'dbt')(target, source, dest_columns, predicates, include_sql_header) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_insert_overwrite_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.5998082, "supported_languages": null}, "macro.dbt.default__get_insert_overwrite_merge_sql": {"name": "default__get_insert_overwrite_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "unique_id": "macro.dbt.default__get_insert_overwrite_merge_sql", "macro_sql": "{% macro default__get_insert_overwrite_merge_sql(target, source, dest_columns, predicates, include_sql_header) -%}\n    {#-- The only time include_sql_header is True: --#}\n    {#-- BigQuery + insert_overwrite strategy + \"static\" partitions config --#}\n    {#-- We should consider including the sql header at the materialization level instead --#}\n\n    {%- set predicates = [] if predicates is none else [] + predicates -%}\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n    {%- set sql_header = config.get('sql_header', none) -%}\n\n    {{ sql_header if sql_header is not none and include_sql_header }}\n\n    merge into {{ target }} as DBT_INTERNAL_DEST\n        using {{ source }} as DBT_INTERNAL_SOURCE\n        on FALSE\n\n    when not matched by source\n        {% if predicates %} and {{ predicates | join(' and ') }} {% endif %}\n        then delete\n\n    when not matched then insert\n        ({{ dest_cols_csv }})\n    values\n        ({{ dest_cols_csv }})\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6007664, "supported_languages": null}, "macro.dbt.materialization_incremental_default": {"name": "materialization_incremental_default", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/incremental.sql", "original_file_path": "macros/materializations/models/incremental/incremental.sql", "unique_id": "macro.dbt.materialization_incremental_default", "macro_sql": "{% materialization incremental, default -%}\n\n  -- relations\n  {%- set existing_relation = load_cached_relation(this) -%}\n  {%- set target_relation = this.incorporate(type='table') -%}\n  {%- set temp_relation = make_temp_relation(target_relation)-%}\n  {%- set intermediate_relation = make_intermediate_relation(target_relation)-%}\n  {%- set backup_relation_type = 'table' if existing_relation is none else existing_relation.type -%}\n  {%- set backup_relation = make_backup_relation(target_relation, backup_relation_type) -%}\n\n  -- configs\n  {%- set unique_key = config.get('unique_key') -%}\n  {%- set full_refresh_mode = (should_full_refresh()  or existing_relation.is_view) -%}\n  {%- set on_schema_change = incremental_validate_on_schema_change(config.get('on_schema_change'), default='ignore') -%}\n\n  -- the temp_ and backup_ relations should not already exist in the database; get_relation\n  -- will return None in that case. Otherwise, we get a relation that we can drop\n  -- later, before we try to use this name for the current operation. This has to happen before\n  -- BEGIN, in a separate transaction\n  {%- set preexisting_intermediate_relation = load_cached_relation(intermediate_relation)-%}\n  {%- set preexisting_backup_relation = load_cached_relation(backup_relation) -%}\n   -- grab current tables grants config for comparision later on\n  {% set grant_config = config.get('grants') %}\n  {{ drop_relation_if_exists(preexisting_intermediate_relation) }}\n  {{ drop_relation_if_exists(preexisting_backup_relation) }}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  {% set to_drop = [] %}\n\n  {% if existing_relation is none %}\n      {% set build_sql = get_create_table_as_sql(False, target_relation, sql) %}\n  {% elif full_refresh_mode %}\n      {% set build_sql = get_create_table_as_sql(False, intermediate_relation, sql) %}\n      {% set need_swap = true %}\n  {% else %}\n    {% do run_query(get_create_table_as_sql(True, temp_relation, sql)) %}\n    {% do adapter.expand_target_column_types(\n             from_relation=temp_relation,\n             to_relation=target_relation) %}\n    {#-- Process schema changes. Returns dict of changes if successful. Use source columns for upserting/merging --#}\n    {% set dest_columns = process_schema_changes(on_schema_change, temp_relation, existing_relation) %}\n    {% if not dest_columns %}\n      {% set dest_columns = adapter.get_columns_in_relation(existing_relation) %}\n    {% endif %}\n\n    {#-- Get the incremental_strategy, the macro to use for the strategy, and build the sql --#}\n    {% set incremental_strategy = config.get('incremental_strategy') or 'default' %}\n    {% set incremental_predicates = config.get('predicates', none) or config.get('incremental_predicates', none) %}\n    {% set strategy_sql_macro_func = adapter.get_incremental_strategy_macro(context, incremental_strategy) %}\n    {% set strategy_arg_dict = ({'target_relation': target_relation, 'temp_relation': temp_relation, 'unique_key': unique_key, 'dest_columns': dest_columns, 'incremental_predicates': incremental_predicates }) %}\n    {% set build_sql = strategy_sql_macro_func(strategy_arg_dict) %}\n\n  {% endif %}\n\n  {% call statement(\"main\") %}\n      {{ build_sql }}\n  {% endcall %}\n\n  {% if need_swap %}\n      {% do adapter.rename_relation(target_relation, backup_relation) %}\n      {% do adapter.rename_relation(intermediate_relation, target_relation) %}\n      {% do to_drop.append(backup_relation) %}\n  {% endif %}\n\n  {% set should_revoke = should_revoke(existing_relation, full_refresh_mode) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {% if existing_relation is none or existing_relation.is_view or should_full_refresh() %}\n    {% do create_indexes(target_relation) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  -- `COMMIT` happens here\n  {% do adapter.commit() %}\n\n  {% for rel in to_drop %}\n      {% do adapter.drop_relation(rel) %}\n  {% endfor %}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{%- endmaterialization %}", "depends_on": {"macros": ["macro.dbt.load_cached_relation", "macro.dbt.make_temp_relation", "macro.dbt.make_intermediate_relation", "macro.dbt.make_backup_relation", "macro.dbt.should_full_refresh", "macro.dbt.incremental_validate_on_schema_change", "macro.dbt.drop_relation_if_exists", "macro.dbt.run_hooks", "macro.dbt.get_create_table_as_sql", "macro.dbt.run_query", "macro.dbt.process_schema_changes", "macro.dbt.statement", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs", "macro.dbt.create_indexes"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6075382, "supported_languages": ["sql"]}, "macro.dbt.handle_existing_table": {"name": "handle_existing_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/view/helpers.sql", "original_file_path": "macros/materializations/models/view/helpers.sql", "unique_id": "macro.dbt.handle_existing_table", "macro_sql": "{% macro handle_existing_table(full_refresh, old_relation) %}\n    {{ adapter.dispatch('handle_existing_table', 'dbt')(full_refresh, old_relation) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__handle_existing_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6079977, "supported_languages": null}, "macro.dbt.default__handle_existing_table": {"name": "default__handle_existing_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/view/helpers.sql", "original_file_path": "macros/materializations/models/view/helpers.sql", "unique_id": "macro.dbt.default__handle_existing_table", "macro_sql": "{% macro default__handle_existing_table(full_refresh, old_relation) %}\n    {{ log(\"Dropping relation \" ~ old_relation ~ \" because it is of type \" ~ old_relation.type) }}\n    {{ adapter.drop_relation(old_relation) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6083567, "supported_languages": null}, "macro.dbt.materialization_view_default": {"name": "materialization_view_default", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/view/view.sql", "original_file_path": "macros/materializations/models/view/view.sql", "unique_id": "macro.dbt.materialization_view_default", "macro_sql": "{%- materialization view, default -%}\n\n  {%- set existing_relation = load_cached_relation(this) -%}\n  {%- set target_relation = this.incorporate(type='view') -%}\n  {%- set intermediate_relation =  make_intermediate_relation(target_relation) -%}\n\n  -- the intermediate_relation should not already exist in the database; get_relation\n  -- will return None in that case. Otherwise, we get a relation that we can drop\n  -- later, before we try to use this name for the current operation\n  {%- set preexisting_intermediate_relation = load_cached_relation(intermediate_relation) -%}\n  /*\n     This relation (probably) doesn't exist yet. If it does exist, it's a leftover from\n     a previous run, and we're going to try to drop it immediately. At the end of this\n     materialization, we're going to rename the \"existing_relation\" to this identifier,\n     and then we're going to drop it. In order to make sure we run the correct one of:\n       - drop view ...\n       - drop table ...\n\n     We need to set the type of this relation to be the type of the existing_relation, if it exists,\n     or else \"view\" as a sane default if it does not. Note that if the existing_relation does not\n     exist, then there is nothing to move out of the way and subsequentally drop. In that case,\n     this relation will be effectively unused.\n  */\n  {%- set backup_relation_type = 'view' if existing_relation is none else existing_relation.type -%}\n  {%- set backup_relation = make_backup_relation(target_relation, backup_relation_type) -%}\n  -- as above, the backup_relation should not already exist\n  {%- set preexisting_backup_relation = load_cached_relation(backup_relation) -%}\n  -- grab current tables grants config for comparision later on\n  {% set grant_config = config.get('grants') %}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- drop the temp relations if they exist already in the database\n  {{ drop_relation_if_exists(preexisting_intermediate_relation) }}\n  {{ drop_relation_if_exists(preexisting_backup_relation) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ get_create_view_as_sql(intermediate_relation, sql) }}\n  {%- endcall %}\n\n  -- cleanup\n  -- move the existing view out of the way\n  {% if existing_relation is not none %}\n    {{ adapter.rename_relation(existing_relation, backup_relation) }}\n  {% endif %}\n  {{ adapter.rename_relation(intermediate_relation, target_relation) }}\n\n  {% set should_revoke = should_revoke(existing_relation, full_refresh_mode=True) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {{ adapter.commit() }}\n\n  {{ drop_relation_if_exists(backup_relation) }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{%- endmaterialization -%}", "depends_on": {"macros": ["macro.dbt.load_cached_relation", "macro.dbt.make_intermediate_relation", "macro.dbt.make_backup_relation", "macro.dbt.run_hooks", "macro.dbt.drop_relation_if_exists", "macro.dbt.statement", "macro.dbt.get_create_view_as_sql", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6118727, "supported_languages": ["sql"]}, "macro.dbt.get_create_view_as_sql": {"name": "get_create_view_as_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/view/create_view_as.sql", "original_file_path": "macros/materializations/models/view/create_view_as.sql", "unique_id": "macro.dbt.get_create_view_as_sql", "macro_sql": "{% macro get_create_view_as_sql(relation, sql) -%}\n  {{ adapter.dispatch('get_create_view_as_sql', 'dbt')(relation, sql) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_create_view_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.61248, "supported_languages": null}, "macro.dbt.default__get_create_view_as_sql": {"name": "default__get_create_view_as_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/view/create_view_as.sql", "original_file_path": "macros/materializations/models/view/create_view_as.sql", "unique_id": "macro.dbt.default__get_create_view_as_sql", "macro_sql": "{% macro default__get_create_view_as_sql(relation, sql) -%}\n  {{ return(create_view_as(relation, sql)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.create_view_as"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.612725, "supported_languages": null}, "macro.dbt.create_view_as": {"name": "create_view_as", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/view/create_view_as.sql", "original_file_path": "macros/materializations/models/view/create_view_as.sql", "unique_id": "macro.dbt.create_view_as", "macro_sql": "{% macro create_view_as(relation, sql) -%}\n  {{ adapter.dispatch('create_view_as', 'dbt')(relation, sql) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__create_view_as"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6129987, "supported_languages": null}, "macro.dbt.default__create_view_as": {"name": "default__create_view_as", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/view/create_view_as.sql", "original_file_path": "macros/materializations/models/view/create_view_as.sql", "unique_id": "macro.dbt.default__create_view_as", "macro_sql": "{% macro default__create_view_as(relation, sql) -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {{ sql_header if sql_header is not none }}\n  create view {{ relation }}\n    {% set contract_config = config.get('contract') %}\n    {% if contract_config.enforced %}\n      {{ get_assert_columns_equivalent(sql) }}\n    {%- endif %}\n  as (\n    {{ sql }}\n  );\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.get_assert_columns_equivalent"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.613715, "supported_languages": null}, "macro.dbt.create_or_replace_view": {"name": "create_or_replace_view", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/view/create_or_replace_view.sql", "original_file_path": "macros/materializations/models/view/create_or_replace_view.sql", "unique_id": "macro.dbt.create_or_replace_view", "macro_sql": "{% macro create_or_replace_view() %}\n  {%- set identifier = model['alias'] -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n  {%- set exists_as_view = (old_relation is not none and old_relation.is_view) -%}\n\n  {%- set target_relation = api.Relation.create(\n      identifier=identifier, schema=schema, database=database,\n      type='view') -%}\n  {% set grant_config = config.get('grants') %}\n\n  {{ run_hooks(pre_hooks) }}\n\n  -- If there's a table with the same name and we weren't told to full refresh,\n  -- that's an error. If we were told to full refresh, drop it. This behavior differs\n  -- for Snowflake and BigQuery, so multiple dispatch is used.\n  {%- if old_relation is not none and old_relation.is_table -%}\n    {{ handle_existing_table(should_full_refresh(), old_relation) }}\n  {%- endif -%}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ get_create_view_as_sql(target_relation, sql) }}\n  {%- endcall %}\n\n  {% set should_revoke = should_revoke(exists_as_view, full_refresh_mode=True) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {{ run_hooks(post_hooks) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.handle_existing_table", "macro.dbt.should_full_refresh", "macro.dbt.statement", "macro.dbt.get_create_view_as_sql", "macro.dbt.should_revoke", "macro.dbt.apply_grants"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.615828, "supported_languages": null}, "macro.dbt.materialization_table_default": {"name": "materialization_table_default", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/table/table.sql", "original_file_path": "macros/materializations/models/table/table.sql", "unique_id": "macro.dbt.materialization_table_default", "macro_sql": "{% materialization table, default %}\n\n  {%- set existing_relation = load_cached_relation(this) -%}\n  {%- set target_relation = this.incorporate(type='table') %}\n  {%- set intermediate_relation =  make_intermediate_relation(target_relation) -%}\n  -- the intermediate_relation should not already exist in the database; get_relation\n  -- will return None in that case. Otherwise, we get a relation that we can drop\n  -- later, before we try to use this name for the current operation\n  {%- set preexisting_intermediate_relation = load_cached_relation(intermediate_relation) -%}\n  /*\n      See ../view/view.sql for more information about this relation.\n  */\n  {%- set backup_relation_type = 'table' if existing_relation is none else existing_relation.type -%}\n  {%- set backup_relation = make_backup_relation(target_relation, backup_relation_type) -%}\n  -- as above, the backup_relation should not already exist\n  {%- set preexisting_backup_relation = load_cached_relation(backup_relation) -%}\n  -- grab current tables grants config for comparision later on\n  {% set grant_config = config.get('grants') %}\n\n  -- drop the temp relations if they exist already in the database\n  {{ drop_relation_if_exists(preexisting_intermediate_relation) }}\n  {{ drop_relation_if_exists(preexisting_backup_relation) }}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ get_create_table_as_sql(False, intermediate_relation, sql) }}\n  {%- endcall %}\n\n  -- cleanup\n  {% if existing_relation is not none %}\n      {{ adapter.rename_relation(existing_relation, backup_relation) }}\n  {% endif %}\n\n  {{ adapter.rename_relation(intermediate_relation, target_relation) }}\n\n  {% do create_indexes(target_relation) %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {% set should_revoke = should_revoke(existing_relation, full_refresh_mode=True) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  -- `COMMIT` happens here\n  {{ adapter.commit() }}\n\n  -- finally, drop the existing/backup relation after the commit\n  {{ drop_relation_if_exists(backup_relation) }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n{% endmaterialization %}", "depends_on": {"macros": ["macro.dbt.load_cached_relation", "macro.dbt.make_intermediate_relation", "macro.dbt.make_backup_relation", "macro.dbt.drop_relation_if_exists", "macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.get_create_table_as_sql", "macro.dbt.create_indexes", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6193702, "supported_languages": ["sql"]}, "macro.dbt.get_table_columns_and_constraints": {"name": "get_table_columns_and_constraints", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/table/columns_spec_ddl.sql", "original_file_path": "macros/materializations/models/table/columns_spec_ddl.sql", "unique_id": "macro.dbt.get_table_columns_and_constraints", "macro_sql": "{%- macro get_table_columns_and_constraints() -%}\n  {{ adapter.dispatch('get_table_columns_and_constraints', 'dbt')() }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__get_table_columns_and_constraints"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.621121, "supported_languages": null}, "macro.dbt.default__get_table_columns_and_constraints": {"name": "default__get_table_columns_and_constraints", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/table/columns_spec_ddl.sql", "original_file_path": "macros/materializations/models/table/columns_spec_ddl.sql", "unique_id": "macro.dbt.default__get_table_columns_and_constraints", "macro_sql": "{% macro default__get_table_columns_and_constraints() -%}\n  {{ return(table_columns_and_constraints()) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.table_columns_and_constraints"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6213121, "supported_languages": null}, "macro.dbt.table_columns_and_constraints": {"name": "table_columns_and_constraints", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/table/columns_spec_ddl.sql", "original_file_path": "macros/materializations/models/table/columns_spec_ddl.sql", "unique_id": "macro.dbt.table_columns_and_constraints", "macro_sql": "{% macro table_columns_and_constraints() %}\n  {# loop through user_provided_columns to create DDL with data types and constraints #}\n    {%- set raw_column_constraints = adapter.render_raw_columns_constraints(raw_columns=model['columns']) -%}\n    {%- set raw_model_constraints = adapter.render_raw_model_constraints(raw_constraints=model['constraints']) -%}\n    (\n    {% for c in raw_column_constraints -%}\n      {{ c }}{{ \",\" if not loop.last or raw_model_constraints }}\n    {% endfor %}\n    {% for c in raw_model_constraints -%}\n        {{ c }}{{ \",\" if not loop.last }}\n    {% endfor -%}\n    )\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6230326, "supported_languages": null}, "macro.dbt.get_assert_columns_equivalent": {"name": "get_assert_columns_equivalent", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/table/columns_spec_ddl.sql", "original_file_path": "macros/materializations/models/table/columns_spec_ddl.sql", "unique_id": "macro.dbt.get_assert_columns_equivalent", "macro_sql": "\n\n{%- macro get_assert_columns_equivalent(sql) -%}\n  {{ adapter.dispatch('get_assert_columns_equivalent', 'dbt')(sql) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__get_assert_columns_equivalent"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6237464, "supported_languages": null}, "macro.dbt.default__get_assert_columns_equivalent": {"name": "default__get_assert_columns_equivalent", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/table/columns_spec_ddl.sql", "original_file_path": "macros/materializations/models/table/columns_spec_ddl.sql", "unique_id": "macro.dbt.default__get_assert_columns_equivalent", "macro_sql": "{% macro default__get_assert_columns_equivalent(sql) -%}\n  {{ return(assert_columns_equivalent(sql)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.assert_columns_equivalent"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6239595, "supported_languages": null}, "macro.dbt.assert_columns_equivalent": {"name": "assert_columns_equivalent", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/table/columns_spec_ddl.sql", "original_file_path": "macros/materializations/models/table/columns_spec_ddl.sql", "unique_id": "macro.dbt.assert_columns_equivalent", "macro_sql": "{% macro assert_columns_equivalent(sql) %}\n  {#-- Obtain the column schema provided by sql file. #}\n  {%- set sql_file_provided_columns = get_column_schema_from_query(sql) -%}\n  {#--Obtain the column schema provided by the schema file by generating an 'empty schema' query from the model's columns. #}\n  {%- set schema_file_provided_columns = get_column_schema_from_query(get_empty_schema_sql(model['columns'])) -%}\n\n  {#-- create dictionaries with name and formatted data type and strings for exception #}\n  {%- set sql_columns = format_columns(sql_file_provided_columns) -%}\n  {%- set yaml_columns = format_columns(schema_file_provided_columns)  -%}\n\n  {%- if sql_columns|length != yaml_columns|length -%}\n    {%- do exceptions.raise_contract_error(yaml_columns, sql_columns) -%}\n  {%- endif -%}\n\n  {%- for sql_col in sql_columns -%}\n    {%- set yaml_col = [] -%}\n    {%- for this_col in yaml_columns -%}\n      {%- if this_col['name'] == sql_col['name'] -%}\n        {%- do yaml_col.append(this_col) -%}\n        {%- break -%}\n      {%- endif -%}\n    {%- endfor -%}\n    {%- if not yaml_col -%}\n      {#-- Column with name not found in yaml #}\n      {%- do exceptions.raise_contract_error(yaml_columns, sql_columns) -%}\n    {%- endif -%}\n    {%- if sql_col['formatted'] != yaml_col[0]['formatted'] -%}\n      {#-- Column data types don't match #}\n      {%- do exceptions.raise_contract_error(yaml_columns, sql_columns) -%}\n    {%- endif -%}\n  {%- endfor -%}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_column_schema_from_query", "macro.dbt.get_empty_schema_sql", "macro.dbt.format_columns"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6255665, "supported_languages": null}, "macro.dbt.format_columns": {"name": "format_columns", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/table/columns_spec_ddl.sql", "original_file_path": "macros/materializations/models/table/columns_spec_ddl.sql", "unique_id": "macro.dbt.format_columns", "macro_sql": "{% macro format_columns(columns) %}\n  {% set formatted_columns = [] %}\n  {% for column in columns %}\n    {%- set formatted_column = adapter.dispatch('format_column', 'dbt')(column) -%}\n    {%- do formatted_columns.append(formatted_column) -%}\n  {% endfor %}\n  {{ return(formatted_columns) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__format_column"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6261427, "supported_languages": null}, "macro.dbt.default__format_column": {"name": "default__format_column", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/table/columns_spec_ddl.sql", "original_file_path": "macros/materializations/models/table/columns_spec_ddl.sql", "unique_id": "macro.dbt.default__format_column", "macro_sql": "{% macro default__format_column(column) -%}\n  {% set data_type = column.dtype %}\n  {% set formatted = column.column.lower() ~ \" \" ~ data_type %}\n  {{ return({'name': column.name, 'data_type': data_type, 'formatted': formatted}) }}\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.626657, "supported_languages": null}, "macro.dbt.get_create_table_as_sql": {"name": "get_create_table_as_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/table/create_table_as.sql", "original_file_path": "macros/materializations/models/table/create_table_as.sql", "unique_id": "macro.dbt.get_create_table_as_sql", "macro_sql": "{% macro get_create_table_as_sql(temporary, relation, sql) -%}\n  {{ adapter.dispatch('get_create_table_as_sql', 'dbt')(temporary, relation, sql) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_create_table_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6278157, "supported_languages": null}, "macro.dbt.default__get_create_table_as_sql": {"name": "default__get_create_table_as_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/table/create_table_as.sql", "original_file_path": "macros/materializations/models/table/create_table_as.sql", "unique_id": "macro.dbt.default__get_create_table_as_sql", "macro_sql": "{% macro default__get_create_table_as_sql(temporary, relation, sql) -%}\n  {{ return(create_table_as(temporary, relation, sql)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.create_table_as"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.628097, "supported_languages": null}, "macro.dbt.create_table_as": {"name": "create_table_as", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/table/create_table_as.sql", "original_file_path": "macros/materializations/models/table/create_table_as.sql", "unique_id": "macro.dbt.create_table_as", "macro_sql": "{% macro create_table_as(temporary, relation, compiled_code, language='sql') -%}\n  {# backward compatibility for create_table_as that does not support language #}\n  {% if language == \"sql\" %}\n    {{ adapter.dispatch('create_table_as', 'dbt')(temporary, relation, compiled_code)}}\n  {% else %}\n    {{ adapter.dispatch('create_table_as', 'dbt')(temporary, relation, compiled_code, language) }}\n  {% endif %}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__create_table_as"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6287472, "supported_languages": null}, "macro.dbt.default__create_table_as": {"name": "default__create_table_as", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/table/create_table_as.sql", "original_file_path": "macros/materializations/models/table/create_table_as.sql", "unique_id": "macro.dbt.default__create_table_as", "macro_sql": "{% macro default__create_table_as(temporary, relation, sql) -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {{ sql_header if sql_header is not none }}\n\n  create {% if temporary: -%}temporary{%- endif %} table\n    {{ relation.include(database=(not temporary), schema=(not temporary)) }}\n  {% set contract_config = config.get('contract') %}\n  {% if contract_config.enforced %}\n    {{ get_assert_columns_equivalent(sql) }}\n    {{ get_table_columns_and_constraints() }}\n    {%- set sql = get_select_subquery(sql) %}\n  {% endif %}\n  as (\n    {{ sql }}\n  );\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.get_assert_columns_equivalent", "macro.dbt.get_table_columns_and_constraints", "macro.dbt.get_select_subquery"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6298661, "supported_languages": null}, "macro.dbt.get_select_subquery": {"name": "get_select_subquery", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/table/create_table_as.sql", "original_file_path": "macros/materializations/models/table/create_table_as.sql", "unique_id": "macro.dbt.get_select_subquery", "macro_sql": "{% macro get_select_subquery(sql) %}\n  {{ return(adapter.dispatch('get_select_subquery', 'dbt')(sql)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_select_subquery"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.630172, "supported_languages": null}, "macro.dbt.default__get_select_subquery": {"name": "default__get_select_subquery", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/table/create_table_as.sql", "original_file_path": "macros/materializations/models/table/create_table_as.sql", "unique_id": "macro.dbt.default__get_select_subquery", "macro_sql": "{% macro default__get_select_subquery(sql) %}\n    select\n    {% for column in model['columns'] %}\n      {{ column }}{{ \", \" if not loop.last }}\n    {% endfor %}\n    from (\n        {{ sql }}\n    ) as model_subq\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6305673, "supported_languages": null}, "macro.dbt.create_csv_table": {"name": "create_csv_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.create_csv_table", "macro_sql": "{% macro create_csv_table(model, agate_table) -%}\n  {{ adapter.dispatch('create_csv_table', 'dbt')(model, agate_table) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__create_csv_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6366737, "supported_languages": null}, "macro.dbt.default__create_csv_table": {"name": "default__create_csv_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.default__create_csv_table", "macro_sql": "{% macro default__create_csv_table(model, agate_table) %}\n  {%- set column_override = model['config'].get('column_types', {}) -%}\n  {%- set quote_seed_column = model['config'].get('quote_columns', None) -%}\n\n  {% set sql %}\n    create table {{ this.render() }} (\n        {%- for col_name in agate_table.column_names -%}\n            {%- set inferred_type = adapter.convert_type(agate_table, loop.index0) -%}\n            {%- set type = column_override.get(col_name, inferred_type) -%}\n            {%- set column_name = (col_name | string) -%}\n            {{ adapter.quote_seed_column(column_name, quote_seed_column) }} {{ type }} {%- if not loop.last -%}, {%- endif -%}\n        {%- endfor -%}\n    )\n  {% endset %}\n\n  {% call statement('_') -%}\n    {{ sql }}\n  {%- endcall %}\n\n  {{ return(sql) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.637994, "supported_languages": null}, "macro.dbt.reset_csv_table": {"name": "reset_csv_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.reset_csv_table", "macro_sql": "{% macro reset_csv_table(model, full_refresh, old_relation, agate_table) -%}\n  {{ adapter.dispatch('reset_csv_table', 'dbt')(model, full_refresh, old_relation, agate_table) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__reset_csv_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6383455, "supported_languages": null}, "macro.dbt.default__reset_csv_table": {"name": "default__reset_csv_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.default__reset_csv_table", "macro_sql": "{% macro default__reset_csv_table(model, full_refresh, old_relation, agate_table) %}\n    {% set sql = \"\" %}\n    {% if full_refresh %}\n        {{ adapter.drop_relation(old_relation) }}\n        {% set sql = create_csv_table(model, agate_table) %}\n    {% else %}\n        {{ adapter.truncate_relation(old_relation) }}\n        {% set sql = \"truncate table \" ~ old_relation %}\n    {% endif %}\n\n    {{ return(sql) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.create_csv_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.639063, "supported_languages": null}, "macro.dbt.get_csv_sql": {"name": "get_csv_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.get_csv_sql", "macro_sql": "{% macro get_csv_sql(create_or_truncate_sql, insert_sql) %}\n    {{ adapter.dispatch('get_csv_sql', 'dbt')(create_or_truncate_sql, insert_sql) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_csv_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6393554, "supported_languages": null}, "macro.dbt.default__get_csv_sql": {"name": "default__get_csv_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.default__get_csv_sql", "macro_sql": "{% macro default__get_csv_sql(create_or_truncate_sql, insert_sql) %}\n    {{ create_or_truncate_sql }};\n    -- dbt seed --\n    {{ insert_sql }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6395657, "supported_languages": null}, "macro.dbt.get_binding_char": {"name": "get_binding_char", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.get_binding_char", "macro_sql": "{% macro get_binding_char() -%}\n  {{ adapter.dispatch('get_binding_char', 'dbt')() }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_binding_char"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6397867, "supported_languages": null}, "macro.dbt.default__get_binding_char": {"name": "default__get_binding_char", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.default__get_binding_char", "macro_sql": "{% macro default__get_binding_char() %}\n  {{ return('%s') }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6399715, "supported_languages": null}, "macro.dbt.get_batch_size": {"name": "get_batch_size", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.get_batch_size", "macro_sql": "{% macro get_batch_size() -%}\n  {{ return(adapter.dispatch('get_batch_size', 'dbt')()) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_batch_size"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6402164, "supported_languages": null}, "macro.dbt.default__get_batch_size": {"name": "default__get_batch_size", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.default__get_batch_size", "macro_sql": "{% macro default__get_batch_size() %}\n  {{ return(10000) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6404092, "supported_languages": null}, "macro.dbt.get_seed_column_quoted_csv": {"name": "get_seed_column_quoted_csv", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.get_seed_column_quoted_csv", "macro_sql": "{% macro get_seed_column_quoted_csv(model, column_names) %}\n  {%- set quote_seed_column = model['config'].get('quote_columns', None) -%}\n    {% set quoted = [] %}\n    {% for col in column_names -%}\n        {%- do quoted.append(adapter.quote_seed_column(col, quote_seed_column)) -%}\n    {%- endfor %}\n\n    {%- set dest_cols_csv = quoted | join(', ') -%}\n    {{ return(dest_cols_csv) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6411197, "supported_languages": null}, "macro.dbt.load_csv_rows": {"name": "load_csv_rows", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.load_csv_rows", "macro_sql": "{% macro load_csv_rows(model, agate_table) -%}\n  {{ adapter.dispatch('load_csv_rows', 'dbt')(model, agate_table) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__load_csv_rows"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.641407, "supported_languages": null}, "macro.dbt.default__load_csv_rows": {"name": "default__load_csv_rows", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.default__load_csv_rows", "macro_sql": "{% macro default__load_csv_rows(model, agate_table) %}\n\n  {% set batch_size = get_batch_size() %}\n\n  {% set cols_sql = get_seed_column_quoted_csv(model, agate_table.column_names) %}\n  {% set bindings = [] %}\n\n  {% set statements = [] %}\n\n  {% for chunk in agate_table.rows | batch(batch_size) %}\n      {% set bindings = [] %}\n\n      {% for row in chunk %}\n          {% do bindings.extend(row) %}\n      {% endfor %}\n\n      {% set sql %}\n          insert into {{ this.render() }} ({{ cols_sql }}) values\n          {% for row in chunk -%}\n              ({%- for column in agate_table.column_names -%}\n                  {{ get_binding_char() }}\n                  {%- if not loop.last%},{%- endif %}\n              {%- endfor -%})\n              {%- if not loop.last%},{%- endif %}\n          {%- endfor %}\n      {% endset %}\n\n      {% do adapter.add_query(sql, bindings=bindings, abridge_sql_log=True) %}\n\n      {% if loop.index0 == 0 %}\n          {% do statements.append(sql) %}\n      {% endif %}\n  {% endfor %}\n\n  {# Return SQL so we can render it out into the compiled files #}\n  {{ return(statements[0]) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_batch_size", "macro.dbt.get_seed_column_quoted_csv", "macro.dbt.get_binding_char"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6431959, "supported_languages": null}, "macro.dbt.materialization_seed_default": {"name": "materialization_seed_default", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/seed.sql", "original_file_path": "macros/materializations/seeds/seed.sql", "unique_id": "macro.dbt.materialization_seed_default", "macro_sql": "{% materialization seed, default %}\n\n  {%- set identifier = model['alias'] -%}\n  {%- set full_refresh_mode = (should_full_refresh()) -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n\n  {%- set exists_as_table = (old_relation is not none and old_relation.is_table) -%}\n  {%- set exists_as_view = (old_relation is not none and old_relation.is_view) -%}\n\n  {%- set grant_config = config.get('grants') -%}\n  {%- set agate_table = load_agate_table() -%}\n  -- grab current tables grants config for comparision later on\n\n  {%- do store_result('agate_table', response='OK', agate_table=agate_table) -%}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- build model\n  {% set create_table_sql = \"\" %}\n  {% if exists_as_view %}\n    {{ exceptions.raise_compiler_error(\"Cannot seed to '{}', it is a view\".format(old_relation)) }}\n  {% elif exists_as_table %}\n    {% set create_table_sql = reset_csv_table(model, full_refresh_mode, old_relation, agate_table) %}\n  {% else %}\n    {% set create_table_sql = create_csv_table(model, agate_table) %}\n  {% endif %}\n\n  {% set code = 'CREATE' if full_refresh_mode else 'INSERT' %}\n  {% set rows_affected = (agate_table.rows | length) %}\n  {% set sql = load_csv_rows(model, agate_table) %}\n\n  {% call noop_statement('main', code ~ ' ' ~ rows_affected, code, rows_affected) %}\n    {{ get_csv_sql(create_table_sql, sql) }};\n  {% endcall %}\n\n  {% set target_relation = this.incorporate(type='table') %}\n\n  {% set should_revoke = should_revoke(old_relation, full_refresh_mode) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {% if full_refresh_mode or not exists_as_table %}\n    {% do create_indexes(target_relation) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  -- `COMMIT` happens here\n  {{ adapter.commit() }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmaterialization %}", "depends_on": {"macros": ["macro.dbt.should_full_refresh", "macro.dbt.run_hooks", "macro.dbt.reset_csv_table", "macro.dbt.create_csv_table", "macro.dbt.load_csv_rows", "macro.dbt.noop_statement", "macro.dbt.get_csv_sql", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs", "macro.dbt.create_indexes"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6476464, "supported_languages": ["sql"]}, "macro.dbt.materialization_test_default": {"name": "materialization_test_default", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/tests/test.sql", "original_file_path": "macros/materializations/tests/test.sql", "unique_id": "macro.dbt.materialization_test_default", "macro_sql": "{%- materialization test, default -%}\n\n  {% set relations = [] %}\n\n  {% if should_store_failures() %}\n\n    {% set identifier = model['alias'] %}\n    {% set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) %}\n    {% set target_relation = api.Relation.create(\n        identifier=identifier, schema=schema, database=database, type='table') -%} %}\n\n    {% if old_relation %}\n        {% do adapter.drop_relation(old_relation) %}\n    {% endif %}\n\n    {% call statement(auto_begin=True) %}\n        {{ create_table_as(False, target_relation, sql) }}\n    {% endcall %}\n\n    {% do relations.append(target_relation) %}\n\n    {% set main_sql %}\n        select *\n        from {{ target_relation }}\n    {% endset %}\n\n    {{ adapter.commit() }}\n\n  {% else %}\n\n      {% set main_sql = sql %}\n\n  {% endif %}\n\n  {% set limit = config.get('limit') %}\n  {% set fail_calc = config.get('fail_calc') %}\n  {% set warn_if = config.get('warn_if') %}\n  {% set error_if = config.get('error_if') %}\n\n  {% call statement('main', fetch_result=True) -%}\n\n    {{ get_test_sql(main_sql, fail_calc, warn_if, error_if, limit)}}\n\n  {%- endcall %}\n\n  {{ return({'relations': relations}) }}\n\n{%- endmaterialization -%}", "depends_on": {"macros": ["macro.dbt.should_store_failures", "macro.dbt.statement", "macro.dbt.create_table_as", "macro.dbt.get_test_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6505194, "supported_languages": ["sql"]}, "macro.dbt.get_test_sql": {"name": "get_test_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/tests/helpers.sql", "original_file_path": "macros/materializations/tests/helpers.sql", "unique_id": "macro.dbt.get_test_sql", "macro_sql": "{% macro get_test_sql(main_sql, fail_calc, warn_if, error_if, limit) -%}\n  {{ adapter.dispatch('get_test_sql', 'dbt')(main_sql, fail_calc, warn_if, error_if, limit) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_test_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6511455, "supported_languages": null}, "macro.dbt.default__get_test_sql": {"name": "default__get_test_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/tests/helpers.sql", "original_file_path": "macros/materializations/tests/helpers.sql", "unique_id": "macro.dbt.default__get_test_sql", "macro_sql": "{% macro default__get_test_sql(main_sql, fail_calc, warn_if, error_if, limit) -%}\n    select\n      {{ fail_calc }} as failures,\n      {{ fail_calc }} {{ warn_if }} as should_warn,\n      {{ fail_calc }} {{ error_if }} as should_error\n    from (\n      {{ main_sql }}\n      {{ \"limit \" ~ limit if limit != none }}\n    ) dbt_internal_test\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6516125, "supported_languages": null}, "macro.dbt.get_where_subquery": {"name": "get_where_subquery", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/tests/where_subquery.sql", "original_file_path": "macros/materializations/tests/where_subquery.sql", "unique_id": "macro.dbt.get_where_subquery", "macro_sql": "{% macro get_where_subquery(relation) -%}\n    {% do return(adapter.dispatch('get_where_subquery', 'dbt')(relation)) %}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_where_subquery"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6521382, "supported_languages": null}, "macro.dbt.default__get_where_subquery": {"name": "default__get_where_subquery", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/tests/where_subquery.sql", "original_file_path": "macros/materializations/tests/where_subquery.sql", "unique_id": "macro.dbt.default__get_where_subquery", "macro_sql": "{% macro default__get_where_subquery(relation) -%}\n    {% set where = config.get('where', '') %}\n    {% if where %}\n        {%- set filtered -%}\n            (select * from {{ relation }} where {{ where }}) dbt_subquery\n        {%- endset -%}\n        {% do return(filtered) %}\n    {%- else -%}\n        {% do return(relation) %}\n    {%- endif -%}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6527236, "supported_languages": null}, "macro.dbt.test_unique": {"name": "test_unique", "resource_type": "macro", "package_name": "dbt", "path": "tests/generic/builtin.sql", "original_file_path": "tests/generic/builtin.sql", "unique_id": "macro.dbt.test_unique", "macro_sql": "{% test unique(model, column_name) %}\n    {% set macro = adapter.dispatch('test_unique', 'dbt') %}\n    {{ macro(model, column_name) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt.default__test_unique"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6534305, "supported_languages": null}, "macro.dbt.test_not_null": {"name": "test_not_null", "resource_type": "macro", "package_name": "dbt", "path": "tests/generic/builtin.sql", "original_file_path": "tests/generic/builtin.sql", "unique_id": "macro.dbt.test_not_null", "macro_sql": "{% test not_null(model, column_name) %}\n    {% set macro = adapter.dispatch('test_not_null', 'dbt') %}\n    {{ macro(model, column_name) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt.default__test_not_null"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6537879, "supported_languages": null}, "macro.dbt.test_accepted_values": {"name": "test_accepted_values", "resource_type": "macro", "package_name": "dbt", "path": "tests/generic/builtin.sql", "original_file_path": "tests/generic/builtin.sql", "unique_id": "macro.dbt.test_accepted_values", "macro_sql": "{% test accepted_values(model, column_name, values, quote=True) %}\n    {% set macro = adapter.dispatch('test_accepted_values', 'dbt') %}\n    {{ macro(model, column_name, values, quote) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt.default__test_accepted_values"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.6542184, "supported_languages": null}, "macro.dbt.test_relationships": {"name": "test_relationships", "resource_type": "macro", "package_name": "dbt", "path": "tests/generic/builtin.sql", "original_file_path": "tests/generic/builtin.sql", "unique_id": "macro.dbt.test_relationships", "macro_sql": "{% test relationships(model, column_name, to, field) %}\n    {% set macro = adapter.dispatch('test_relationships', 'dbt') %}\n    {{ macro(model, column_name, to, field) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt.default__test_relationships"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1703192134.654638, "supported_languages": null}}, "docs": {"doc.dbt.__overview__": {"name": "__overview__", "resource_type": "doc", "package_name": "dbt", "path": "overview.md", "original_file_path": "docs/overview.md", "unique_id": "doc.dbt.__overview__", "block_contents": "### Welcome!\n\nWelcome to the auto-generated documentation for your dbt project!\n\n### Navigation\n\nYou can use the `Project` and `Database` navigation tabs on the left side of the window to explore the models\nin your project.\n\n#### Project Tab\nThe `Project` tab mirrors the directory structure of your dbt project. In this tab, you can see all of the\nmodels defined in your dbt project, as well as models imported from dbt packages.\n\n#### Database Tab\nThe `Database` tab also exposes your models, but in a format that looks more like a database explorer. This view\nshows relations (tables and views) grouped into database schemas. Note that ephemeral models are _not_ shown\nin this interface, as they do not exist in the database.\n\n### Graph Exploration\nYou can click the blue icon on the bottom-right corner of the page to view the lineage graph of your models.\n\nOn model pages, you'll see the immediate parents and children of the model you're exploring. By clicking the `Expand`\nbutton at the top-right of this lineage pane, you'll be able to see all of the models that are used to build,\nor are built from, the model you're exploring.\n\nOnce expanded, you'll be able to use the `--select` and `--exclude` model selection syntax to filter the\nmodels in the graph. For more information on model selection, check out the [dbt docs](https://docs.getdbt.com/docs/model-selection-syntax).\n\nNote that you can also right-click on models to interactively filter and explore the graph.\n\n---\n\n### More information\n\n- [What is dbt](https://docs.getdbt.com/docs/introduction)?\n- Read the [dbt viewpoint](https://docs.getdbt.com/docs/viewpoint)\n- [Installation](https://docs.getdbt.com/docs/installation)\n- Join the [dbt Community](https://www.getdbt.com/community/) for questions and discussion"}}, "exposures": {}, "metrics": {}, "groups": {}, "selectors": {}, "disabled": {}, "parent_map": {"model.sagerx.int_ndc_all_ndcs_to_sources": ["model.sagerx.stg_fda_ndc__ndc", "model.sagerx.stg_rxnorm__all_ndcs", "model.sagerx.stg_rxnorm_historical__ndcs"], "model.sagerx.int_rxnorm_clinical_products_to_dose_forms": ["model.sagerx.stg_rxnorm__clinical_product_component_links", "model.sagerx.stg_rxnorm__clinical_product_components", "model.sagerx.stg_rxnorm__clinical_products", "model.sagerx.stg_rxnorm__dose_forms"], "model.sagerx.int_rxnorm_clinical_products_to_ingredient_strengths": ["model.sagerx.stg_rxnorm__clinical_product_component_links", "model.sagerx.stg_rxnorm__clinical_product_components", "model.sagerx.stg_rxnorm__clinical_products", "model.sagerx.stg_rxnorm__dose_forms", "model.sagerx.stg_rxnorm__ingredient_component_links", "model.sagerx.stg_rxnorm__ingredient_components", "model.sagerx.stg_rxnorm__ingredient_strength_links", "model.sagerx.stg_rxnorm__ingredient_strengths", "model.sagerx.stg_rxnorm__ingredients", "model.sagerx.stg_rxnorm__precise_ingredient_links", "model.sagerx.stg_rxnorm__precise_ingredients"], "model.sagerx.int_rxnorm_clinical_products_to_ingredient_components": ["model.sagerx.stg_rxnorm__clinical_product_component_links", "model.sagerx.stg_rxnorm__clinical_product_components", "model.sagerx.stg_rxnorm__clinical_products", "model.sagerx.stg_rxnorm__dose_forms", "model.sagerx.stg_rxnorm__ingredient_component_links", "model.sagerx.stg_rxnorm__ingredient_components", "model.sagerx.stg_rxnorm__ingredients"], "model.sagerx.int_rxnorm_all_ndcs_to_product_rxcuis": ["model.sagerx.stg_rxnorm__all_ndcs"], "model.sagerx.int_mthspl_products_to_active_moieties": ["model.sagerx.stg_rxnorm__mthspl_products", "model.sagerx.stg_rxnorm__mthspl_substances"], "model.sagerx.int_mthspl_products_to_inactive_ingredients": ["model.sagerx.stg_rxnorm__mthspl_products", "model.sagerx.stg_rxnorm__mthspl_substances"], "model.sagerx.int_rxnorm_clinical_products_to_ingredients": ["model.sagerx.stg_rxnorm__clinical_product_component_links", "model.sagerx.stg_rxnorm__clinical_product_components", "model.sagerx.stg_rxnorm__clinical_products", "model.sagerx.stg_rxnorm__dose_forms", "model.sagerx.stg_rxnorm__ingredients"], "model.sagerx.int_rxnorm_clinical_products_to_ndcs": ["model.sagerx.stg_rxnorm__clinical_product_component_links", "model.sagerx.stg_rxnorm__clinical_product_components", "model.sagerx.stg_rxnorm__clinical_products", "model.sagerx.stg_rxnorm__dose_forms", "model.sagerx.stg_rxnorm__ingredients", "model.sagerx.stg_rxnorm__ndcs"], "model.sagerx.int_mthspl_products_to_active_ingredients": ["model.sagerx.stg_rxnorm__mthspl_products", "model.sagerx.stg_rxnorm__mthspl_substances"], "model.sagerx.int_rxnorm_clinical_products_to_clinical_product_components": ["model.sagerx.stg_rxnorm__clinical_product_component_links", "model.sagerx.stg_rxnorm__clinical_product_components", "model.sagerx.stg_rxnorm__clinical_products", "model.sagerx.stg_rxnorm__ndcs"], "model.sagerx.int_atc_codes_to_product_rxcuis": ["model.sagerx.stg_rxnorm__atc_codes"], "model.sagerx.int_rxnorm_ndcs_to_products": ["model.sagerx.stg_rxnorm__brand_products", "model.sagerx.stg_rxnorm__clinical_products", "model.sagerx.stg_rxnorm__ndcs"], "model.sagerx.int_inactive_ingredients_to_fda_enforcement_reports": ["model.sagerx.int_mthspl_products_to_inactive_ingredients", "model.sagerx.int_rxnorm_clinical_products_to_ingredients", "model.sagerx.int_rxnorm_ndcs_to_products", "model.sagerx.stg_fda_enforcement__json_ndcs", "model.sagerx.stg_fda_enforcement__regex_ndcs", "model.sagerx.stg_fda_ndc__ndc"], "model.sagerx.stg_rxnorm__mthspl_ndcs": [], "model.sagerx.stg_rxnorm__dose_form_group_links": [], "model.sagerx.stg_rxnorm__ingredients": [], "model.sagerx.stg_rxnorm__atc_codes": [], "model.sagerx.stg_rxnorm__clinical_products": [], "model.sagerx.stg_rxnorm__ingredient_strengths": [], "model.sagerx.stg_rxnorm__precise_ingredients": [], "model.sagerx.stg_rxnorm__brand_products": [], "model.sagerx.stg_rxnorm__brands": [], "model.sagerx.stg_rxnorm__mthspl_products": [], "model.sagerx.stg_rxnorm__mthspl_substances": [], "model.sagerx.stg_rxnorm__ingredient_strength_links": [], "model.sagerx.stg_rxnorm__clinical_product_components": [], "model.sagerx.stg_rxnorm__clinical_product_component_links": [], "model.sagerx.stg_rxnorm__brand_product_component_links": [], "model.sagerx.stg_rxnorm__ingredient_component_links": [], "model.sagerx.stg_rxnorm__precise_ingredient_links": [], "model.sagerx.stg_rxnorm__brand_product_components": [], "model.sagerx.stg_rxnorm__ndcs": [], "model.sagerx.stg_rxnorm__ingredient_components": [], "model.sagerx.stg_rxnorm__all_ndcs": [], "model.sagerx.stg_rxnorm__dose_form_groups": [], "model.sagerx.stg_rxnorm__dose_forms": [], "model.sagerx.stg_fda_enforcement__reports": [], "model.sagerx.stg_fda_enforcement__regex_ndcs": [], "model.sagerx.stg_fda_enforcement__json_ndcs": [], "model.sagerx.stg_rxnorm_historical__ndcs": [], "model.sagerx.stg_fda_ndc__class": [], "model.sagerx.stg_fda_ndc__substance": [], "model.sagerx.stg_fda_ndc__ndc": ["source.sagerx.fda_ndc.fda_ndc_package", "source.sagerx.fda_ndc.fda_ndc_product"], "model.sagerx.sagerx_product_classification": [], "model.sagerx.scorecard_data": ["model.sagerx.int_inactive_ingredients_to_fda_enforcement_reports"], "test.sagerx.unique_stg_rxnorm__ndcs_ndc.9929df0b31": ["model.sagerx.stg_rxnorm__ndcs"], "test.sagerx.not_null_stg_rxnorm__ndcs_ndc.4db0f5b5df": ["model.sagerx.stg_rxnorm__ndcs"], "test.sagerx.unique_stg_rxnorm__clinical_products_rxcui.0bac3cbe9c": ["model.sagerx.stg_rxnorm__clinical_products"], "test.sagerx.not_null_stg_rxnorm__clinical_products_rxcui.5dd04a1235": ["model.sagerx.stg_rxnorm__clinical_products"], "test.sagerx.not_null_stg_rxnorm__clinical_product_component_links_clinical_product_rxcui.94c75bf656": ["model.sagerx.stg_rxnorm__clinical_product_component_links"], "test.sagerx.not_null_stg_rxnorm__clinical_product_component_links_clinical_product_component_rxcui.869196279f": ["model.sagerx.stg_rxnorm__clinical_product_component_links"], "test.sagerx.unique_stg_rxnorm__clinical_product_components_rxcui.2705e1f418": ["model.sagerx.stg_rxnorm__clinical_product_components"], "test.sagerx.not_null_stg_rxnorm__clinical_product_components_rxcui.0b9c81f7ae": ["model.sagerx.stg_rxnorm__clinical_product_components"], "test.sagerx.unique_stg_rxnorm__dose_forms_rxcui.c7fb3a8da2": ["model.sagerx.stg_rxnorm__dose_forms"], "test.sagerx.not_null_stg_rxnorm__dose_forms_rxcui.a06bc0be08": ["model.sagerx.stg_rxnorm__dose_forms"], "test.sagerx.not_null_stg_rxnorm__dose_form_group_links_dose_form_rxcui.3fdd0d4bb1": ["model.sagerx.stg_rxnorm__dose_form_group_links"], "test.sagerx.not_null_stg_rxnorm__dose_form_group_links_dose_form_group_rxcui.f4fde7102f": ["model.sagerx.stg_rxnorm__dose_form_group_links"], "test.sagerx.unique_stg_rxnorm__dose_form_groups_rxcui.b2e6200e1b": ["model.sagerx.stg_rxnorm__dose_form_groups"], "test.sagerx.not_null_stg_rxnorm__dose_form_groups_rxcui.eca504df20": ["model.sagerx.stg_rxnorm__dose_form_groups"], "test.sagerx.unique_stg_rxnorm__ingredients_rxcui.c6b139419f": ["model.sagerx.stg_rxnorm__ingredients"], "test.sagerx.not_null_stg_rxnorm__ingredients_rxcui.24a1dca332": ["model.sagerx.stg_rxnorm__ingredients"], "test.sagerx.not_null_stg_rxnorm__ingredient_component_links_ingredient_rxcui.303404889c": ["model.sagerx.stg_rxnorm__ingredient_component_links"], "test.sagerx.not_null_stg_rxnorm__ingredient_component_links_ingredient_component_rxcui.a6923961b3": ["model.sagerx.stg_rxnorm__ingredient_component_links"], "test.sagerx.unique_stg_rxnorm__ingredient_components_rxcui.75f7804348": ["model.sagerx.stg_rxnorm__ingredient_components"], "test.sagerx.not_null_stg_rxnorm__ingredient_components_rxcui.aed8b0d4c5": ["model.sagerx.stg_rxnorm__ingredient_components"], "test.sagerx.accepted_values_stg_rxnorm__ingredient_components_tty__IN.5d941aec74": ["model.sagerx.stg_rxnorm__ingredient_components"], "test.sagerx.not_null_stg_rxnorm__ingredient_strength_links_clinical_product_component_rxcui.6be28272b5": ["model.sagerx.stg_rxnorm__ingredient_strength_links"], "test.sagerx.not_null_stg_rxnorm__ingredient_strength_links_ingredient_component_rxcui.fec66d7333": ["model.sagerx.stg_rxnorm__ingredient_strength_links"], "test.sagerx.not_null_stg_rxnorm__ingredient_strength_links_ingredient_strength_rxcui.3527b30bda": ["model.sagerx.stg_rxnorm__ingredient_strength_links"], "test.sagerx.unique_stg_rxnorm__ingredient_strengths_rxcui.716f558a6b": ["model.sagerx.stg_rxnorm__ingredient_strengths"], "test.sagerx.not_null_stg_rxnorm__ingredient_strengths_rxcui.d4a27e753c": ["model.sagerx.stg_rxnorm__ingredient_strengths"], "test.sagerx.not_null_stg_rxnorm__mthspl_products_rxcui.21eb3d19b0": ["model.sagerx.stg_rxnorm__mthspl_products"], "test.sagerx.not_null_stg_rxnorm__mthspl_substances_rxcui.1b38748ca6": ["model.sagerx.stg_rxnorm__mthspl_substances"], "test.sagerx.unique_stg_rxnorm__brand_products_rxcui.da77867bbd": ["model.sagerx.stg_rxnorm__brand_products"], "test.sagerx.not_null_stg_rxnorm__brand_products_rxcui.634ef0c2ff": ["model.sagerx.stg_rxnorm__brand_products"], "test.sagerx.not_null_stg_rxnorm__brand_product_component_links_brand_product_rxcui.6135a1fa50": ["model.sagerx.stg_rxnorm__brand_product_component_links"], "test.sagerx.not_null_stg_rxnorm__brand_product_component_links_brand_product_component_rxcui.9f497ef16e": ["model.sagerx.stg_rxnorm__brand_product_component_links"], "test.sagerx.unique_stg_rxnorm__brand_product_components_rxcui.cd3b918573": ["model.sagerx.stg_rxnorm__brand_product_components"], "test.sagerx.not_null_stg_rxnorm__brand_product_components_rxcui.4917a3f0ca": ["model.sagerx.stg_rxnorm__brand_product_components"], "test.sagerx.not_null_stg_rxnorm__brand_product_components_clinical_product_component_rxcui.25fdaf356b": ["model.sagerx.stg_rxnorm__brand_product_components"], "test.sagerx.unique_stg_rxnorm__brands_rxcui.a2c8cd0cd0": ["model.sagerx.stg_rxnorm__brands"], "test.sagerx.not_null_stg_rxnorm__brands_rxcui.d067686860": ["model.sagerx.stg_rxnorm__brands"], "test.sagerx.unique_stg_fda_ndc__ndc_ndc11.60276e520c": ["model.sagerx.stg_fda_ndc__ndc"], "test.sagerx.not_null_stg_fda_ndc__ndc_ndc11.c94b597c0b": ["model.sagerx.stg_fda_ndc__ndc"], "source.sagerx.rxnorm.rxnorm_rxnatomarchive": [], "source.sagerx.rxnorm.rxnorm_rxnconso": [], "source.sagerx.rxnorm.rxnorm_rxncui": [], "source.sagerx.rxnorm.rxnorm_rxncuichanges": [], "source.sagerx.rxnorm.rxnorm_rxndoc": [], "source.sagerx.rxnorm.rxnorm_rxnrel": [], "source.sagerx.rxnorm.rxnorm_rxnsab": [], "source.sagerx.rxnorm.rxnorm_rxnsat": [], "source.sagerx.rxnorm.rxnorm_rxnsty": [], "source.sagerx.fda_enforcement.fda_enforcement": [], "source.sagerx.rxnorm_historical.rxnorm_historical": [], "source.sagerx.fda_ndc.fda_ndc_product": [], "source.sagerx.fda_ndc.fda_ndc_package": []}, "child_map": {"model.sagerx.int_ndc_all_ndcs_to_sources": [], "model.sagerx.int_rxnorm_clinical_products_to_dose_forms": [], "model.sagerx.int_rxnorm_clinical_products_to_ingredient_strengths": [], "model.sagerx.int_rxnorm_clinical_products_to_ingredient_components": [], "model.sagerx.int_rxnorm_all_ndcs_to_product_rxcuis": [], "model.sagerx.int_mthspl_products_to_active_moieties": [], "model.sagerx.int_mthspl_products_to_inactive_ingredients": ["model.sagerx.int_inactive_ingredients_to_fda_enforcement_reports"], "model.sagerx.int_rxnorm_clinical_products_to_ingredients": ["model.sagerx.int_inactive_ingredients_to_fda_enforcement_reports"], "model.sagerx.int_rxnorm_clinical_products_to_ndcs": [], "model.sagerx.int_mthspl_products_to_active_ingredients": [], "model.sagerx.int_rxnorm_clinical_products_to_clinical_product_components": [], "model.sagerx.int_atc_codes_to_product_rxcuis": [], "model.sagerx.int_rxnorm_ndcs_to_products": ["model.sagerx.int_inactive_ingredients_to_fda_enforcement_reports"], "model.sagerx.int_inactive_ingredients_to_fda_enforcement_reports": ["model.sagerx.scorecard_data"], "model.sagerx.stg_rxnorm__mthspl_ndcs": [], "model.sagerx.stg_rxnorm__dose_form_group_links": ["test.sagerx.not_null_stg_rxnorm__dose_form_group_links_dose_form_group_rxcui.f4fde7102f", "test.sagerx.not_null_stg_rxnorm__dose_form_group_links_dose_form_rxcui.3fdd0d4bb1"], "model.sagerx.stg_rxnorm__ingredients": ["model.sagerx.int_rxnorm_clinical_products_to_ingredient_components", "model.sagerx.int_rxnorm_clinical_products_to_ingredient_strengths", "model.sagerx.int_rxnorm_clinical_products_to_ingredients", "model.sagerx.int_rxnorm_clinical_products_to_ndcs", "test.sagerx.not_null_stg_rxnorm__ingredients_rxcui.24a1dca332", "test.sagerx.unique_stg_rxnorm__ingredients_rxcui.c6b139419f"], "model.sagerx.stg_rxnorm__atc_codes": ["model.sagerx.int_atc_codes_to_product_rxcuis"], "model.sagerx.stg_rxnorm__clinical_products": ["model.sagerx.int_rxnorm_clinical_products_to_clinical_product_components", "model.sagerx.int_rxnorm_clinical_products_to_dose_forms", "model.sagerx.int_rxnorm_clinical_products_to_ingredient_components", "model.sagerx.int_rxnorm_clinical_products_to_ingredient_strengths", "model.sagerx.int_rxnorm_clinical_products_to_ingredients", "model.sagerx.int_rxnorm_clinical_products_to_ndcs", "model.sagerx.int_rxnorm_ndcs_to_products", "test.sagerx.not_null_stg_rxnorm__clinical_products_rxcui.5dd04a1235", "test.sagerx.unique_stg_rxnorm__clinical_products_rxcui.0bac3cbe9c"], "model.sagerx.stg_rxnorm__ingredient_strengths": ["model.sagerx.int_rxnorm_clinical_products_to_ingredient_strengths", "test.sagerx.not_null_stg_rxnorm__ingredient_strengths_rxcui.d4a27e753c", "test.sagerx.unique_stg_rxnorm__ingredient_strengths_rxcui.716f558a6b"], "model.sagerx.stg_rxnorm__precise_ingredients": ["model.sagerx.int_rxnorm_clinical_products_to_ingredient_strengths"], "model.sagerx.stg_rxnorm__brand_products": ["model.sagerx.int_rxnorm_ndcs_to_products", "test.sagerx.not_null_stg_rxnorm__brand_products_rxcui.634ef0c2ff", "test.sagerx.unique_stg_rxnorm__brand_products_rxcui.da77867bbd"], "model.sagerx.stg_rxnorm__brands": ["test.sagerx.not_null_stg_rxnorm__brands_rxcui.d067686860", "test.sagerx.unique_stg_rxnorm__brands_rxcui.a2c8cd0cd0"], "model.sagerx.stg_rxnorm__mthspl_products": ["model.sagerx.int_mthspl_products_to_active_ingredients", "model.sagerx.int_mthspl_products_to_active_moieties", "model.sagerx.int_mthspl_products_to_inactive_ingredients", "test.sagerx.not_null_stg_rxnorm__mthspl_products_rxcui.21eb3d19b0"], "model.sagerx.stg_rxnorm__mthspl_substances": ["model.sagerx.int_mthspl_products_to_active_ingredients", "model.sagerx.int_mthspl_products_to_active_moieties", "model.sagerx.int_mthspl_products_to_inactive_ingredients", "test.sagerx.not_null_stg_rxnorm__mthspl_substances_rxcui.1b38748ca6"], "model.sagerx.stg_rxnorm__ingredient_strength_links": ["model.sagerx.int_rxnorm_clinical_products_to_ingredient_strengths", "test.sagerx.not_null_stg_rxnorm__ingredient_strength_links_clinical_product_component_rxcui.6be28272b5", "test.sagerx.not_null_stg_rxnorm__ingredient_strength_links_ingredient_component_rxcui.fec66d7333", "test.sagerx.not_null_stg_rxnorm__ingredient_strength_links_ingredient_strength_rxcui.3527b30bda"], "model.sagerx.stg_rxnorm__clinical_product_components": ["model.sagerx.int_rxnorm_clinical_products_to_clinical_product_components", "model.sagerx.int_rxnorm_clinical_products_to_dose_forms", "model.sagerx.int_rxnorm_clinical_products_to_ingredient_components", "model.sagerx.int_rxnorm_clinical_products_to_ingredient_strengths", "model.sagerx.int_rxnorm_clinical_products_to_ingredients", "model.sagerx.int_rxnorm_clinical_products_to_ndcs", "test.sagerx.not_null_stg_rxnorm__clinical_product_components_rxcui.0b9c81f7ae", "test.sagerx.unique_stg_rxnorm__clinical_product_components_rxcui.2705e1f418"], "model.sagerx.stg_rxnorm__clinical_product_component_links": ["model.sagerx.int_rxnorm_clinical_products_to_clinical_product_components", "model.sagerx.int_rxnorm_clinical_products_to_dose_forms", "model.sagerx.int_rxnorm_clinical_products_to_ingredient_components", "model.sagerx.int_rxnorm_clinical_products_to_ingredient_strengths", "model.sagerx.int_rxnorm_clinical_products_to_ingredients", "model.sagerx.int_rxnorm_clinical_products_to_ndcs", "test.sagerx.not_null_stg_rxnorm__clinical_product_component_links_clinical_product_component_rxcui.869196279f", "test.sagerx.not_null_stg_rxnorm__clinical_product_component_links_clinical_product_rxcui.94c75bf656"], "model.sagerx.stg_rxnorm__brand_product_component_links": ["test.sagerx.not_null_stg_rxnorm__brand_product_component_links_brand_product_component_rxcui.9f497ef16e", "test.sagerx.not_null_stg_rxnorm__brand_product_component_links_brand_product_rxcui.6135a1fa50"], "model.sagerx.stg_rxnorm__ingredient_component_links": ["model.sagerx.int_rxnorm_clinical_products_to_ingredient_components", "model.sagerx.int_rxnorm_clinical_products_to_ingredient_strengths", "test.sagerx.not_null_stg_rxnorm__ingredient_component_links_ingredient_component_rxcui.a6923961b3", "test.sagerx.not_null_stg_rxnorm__ingredient_component_links_ingredient_rxcui.303404889c"], "model.sagerx.stg_rxnorm__precise_ingredient_links": ["model.sagerx.int_rxnorm_clinical_products_to_ingredient_strengths"], "model.sagerx.stg_rxnorm__brand_product_components": ["test.sagerx.not_null_stg_rxnorm__brand_product_components_clinical_product_component_rxcui.25fdaf356b", "test.sagerx.not_null_stg_rxnorm__brand_product_components_rxcui.4917a3f0ca", "test.sagerx.unique_stg_rxnorm__brand_product_components_rxcui.cd3b918573"], "model.sagerx.stg_rxnorm__ndcs": ["model.sagerx.int_rxnorm_clinical_products_to_clinical_product_components", "model.sagerx.int_rxnorm_clinical_products_to_ndcs", "model.sagerx.int_rxnorm_ndcs_to_products", "test.sagerx.not_null_stg_rxnorm__ndcs_ndc.4db0f5b5df", "test.sagerx.unique_stg_rxnorm__ndcs_ndc.9929df0b31"], "model.sagerx.stg_rxnorm__ingredient_components": ["model.sagerx.int_rxnorm_clinical_products_to_ingredient_components", "model.sagerx.int_rxnorm_clinical_products_to_ingredient_strengths", "test.sagerx.accepted_values_stg_rxnorm__ingredient_components_tty__IN.5d941aec74", "test.sagerx.not_null_stg_rxnorm__ingredient_components_rxcui.aed8b0d4c5", "test.sagerx.unique_stg_rxnorm__ingredient_components_rxcui.75f7804348"], "model.sagerx.stg_rxnorm__all_ndcs": ["model.sagerx.int_ndc_all_ndcs_to_sources", "model.sagerx.int_rxnorm_all_ndcs_to_product_rxcuis"], "model.sagerx.stg_rxnorm__dose_form_groups": ["test.sagerx.not_null_stg_rxnorm__dose_form_groups_rxcui.eca504df20", "test.sagerx.unique_stg_rxnorm__dose_form_groups_rxcui.b2e6200e1b"], "model.sagerx.stg_rxnorm__dose_forms": ["model.sagerx.int_rxnorm_clinical_products_to_dose_forms", "model.sagerx.int_rxnorm_clinical_products_to_ingredient_components", "model.sagerx.int_rxnorm_clinical_products_to_ingredient_strengths", "model.sagerx.int_rxnorm_clinical_products_to_ingredients", "model.sagerx.int_rxnorm_clinical_products_to_ndcs", "test.sagerx.not_null_stg_rxnorm__dose_forms_rxcui.a06bc0be08", "test.sagerx.unique_stg_rxnorm__dose_forms_rxcui.c7fb3a8da2"], "model.sagerx.stg_fda_enforcement__reports": [], "model.sagerx.stg_fda_enforcement__regex_ndcs": ["model.sagerx.int_inactive_ingredients_to_fda_enforcement_reports"], "model.sagerx.stg_fda_enforcement__json_ndcs": ["model.sagerx.int_inactive_ingredients_to_fda_enforcement_reports"], "model.sagerx.stg_rxnorm_historical__ndcs": ["model.sagerx.int_ndc_all_ndcs_to_sources"], "model.sagerx.stg_fda_ndc__class": [], "model.sagerx.stg_fda_ndc__substance": [], "model.sagerx.stg_fda_ndc__ndc": ["model.sagerx.int_inactive_ingredients_to_fda_enforcement_reports", "model.sagerx.int_ndc_all_ndcs_to_sources", "test.sagerx.not_null_stg_fda_ndc__ndc_ndc11.c94b597c0b", "test.sagerx.unique_stg_fda_ndc__ndc_ndc11.60276e520c"], "model.sagerx.sagerx_product_classification": [], "model.sagerx.scorecard_data": [], "test.sagerx.unique_stg_rxnorm__ndcs_ndc.9929df0b31": [], "test.sagerx.not_null_stg_rxnorm__ndcs_ndc.4db0f5b5df": [], "test.sagerx.unique_stg_rxnorm__clinical_products_rxcui.0bac3cbe9c": [], "test.sagerx.not_null_stg_rxnorm__clinical_products_rxcui.5dd04a1235": [], "test.sagerx.not_null_stg_rxnorm__clinical_product_component_links_clinical_product_rxcui.94c75bf656": [], "test.sagerx.not_null_stg_rxnorm__clinical_product_component_links_clinical_product_component_rxcui.869196279f": [], "test.sagerx.unique_stg_rxnorm__clinical_product_components_rxcui.2705e1f418": [], "test.sagerx.not_null_stg_rxnorm__clinical_product_components_rxcui.0b9c81f7ae": [], "test.sagerx.unique_stg_rxnorm__dose_forms_rxcui.c7fb3a8da2": [], "test.sagerx.not_null_stg_rxnorm__dose_forms_rxcui.a06bc0be08": [], "test.sagerx.not_null_stg_rxnorm__dose_form_group_links_dose_form_rxcui.3fdd0d4bb1": [], "test.sagerx.not_null_stg_rxnorm__dose_form_group_links_dose_form_group_rxcui.f4fde7102f": [], "test.sagerx.unique_stg_rxnorm__dose_form_groups_rxcui.b2e6200e1b": [], "test.sagerx.not_null_stg_rxnorm__dose_form_groups_rxcui.eca504df20": [], "test.sagerx.unique_stg_rxnorm__ingredients_rxcui.c6b139419f": [], "test.sagerx.not_null_stg_rxnorm__ingredients_rxcui.24a1dca332": [], "test.sagerx.not_null_stg_rxnorm__ingredient_component_links_ingredient_rxcui.303404889c": [], "test.sagerx.not_null_stg_rxnorm__ingredient_component_links_ingredient_component_rxcui.a6923961b3": [], "test.sagerx.unique_stg_rxnorm__ingredient_components_rxcui.75f7804348": [], "test.sagerx.not_null_stg_rxnorm__ingredient_components_rxcui.aed8b0d4c5": [], "test.sagerx.accepted_values_stg_rxnorm__ingredient_components_tty__IN.5d941aec74": [], "test.sagerx.not_null_stg_rxnorm__ingredient_strength_links_clinical_product_component_rxcui.6be28272b5": [], "test.sagerx.not_null_stg_rxnorm__ingredient_strength_links_ingredient_component_rxcui.fec66d7333": [], "test.sagerx.not_null_stg_rxnorm__ingredient_strength_links_ingredient_strength_rxcui.3527b30bda": [], "test.sagerx.unique_stg_rxnorm__ingredient_strengths_rxcui.716f558a6b": [], "test.sagerx.not_null_stg_rxnorm__ingredient_strengths_rxcui.d4a27e753c": [], "test.sagerx.not_null_stg_rxnorm__mthspl_products_rxcui.21eb3d19b0": [], "test.sagerx.not_null_stg_rxnorm__mthspl_substances_rxcui.1b38748ca6": [], "test.sagerx.unique_stg_rxnorm__brand_products_rxcui.da77867bbd": [], "test.sagerx.not_null_stg_rxnorm__brand_products_rxcui.634ef0c2ff": [], "test.sagerx.not_null_stg_rxnorm__brand_product_component_links_brand_product_rxcui.6135a1fa50": [], "test.sagerx.not_null_stg_rxnorm__brand_product_component_links_brand_product_component_rxcui.9f497ef16e": [], "test.sagerx.unique_stg_rxnorm__brand_product_components_rxcui.cd3b918573": [], "test.sagerx.not_null_stg_rxnorm__brand_product_components_rxcui.4917a3f0ca": [], "test.sagerx.not_null_stg_rxnorm__brand_product_components_clinical_product_component_rxcui.25fdaf356b": [], "test.sagerx.unique_stg_rxnorm__brands_rxcui.a2c8cd0cd0": [], "test.sagerx.not_null_stg_rxnorm__brands_rxcui.d067686860": [], "test.sagerx.unique_stg_fda_ndc__ndc_ndc11.60276e520c": [], "test.sagerx.not_null_stg_fda_ndc__ndc_ndc11.c94b597c0b": [], "source.sagerx.rxnorm.rxnorm_rxnatomarchive": [], "source.sagerx.rxnorm.rxnorm_rxnconso": [], "source.sagerx.rxnorm.rxnorm_rxncui": [], "source.sagerx.rxnorm.rxnorm_rxncuichanges": [], "source.sagerx.rxnorm.rxnorm_rxndoc": [], "source.sagerx.rxnorm.rxnorm_rxnrel": [], "source.sagerx.rxnorm.rxnorm_rxnsab": [], "source.sagerx.rxnorm.rxnorm_rxnsat": [], "source.sagerx.rxnorm.rxnorm_rxnsty": [], "source.sagerx.fda_enforcement.fda_enforcement": [], "source.sagerx.rxnorm_historical.rxnorm_historical": [], "source.sagerx.fda_ndc.fda_ndc_product": ["model.sagerx.stg_fda_ndc__ndc"], "source.sagerx.fda_ndc.fda_ndc_package": ["model.sagerx.stg_fda_ndc__ndc"]}, "group_map": {}}