from pathlib import Path
import pendulum

from sagerx import get_dataset, read_sql_file, get_sql_list, alert_slack_channel

from airflow.decorators import dag, task

from airflow.operators.python import get_current_context
from airflow.providers.postgres.operators.postgres import PostgresOperator
from airflow.hooks.postgres_hook import PostgresHook
from airflow.hooks.subprocess import SubprocessHook


@dag(
    schedule="0 4 * * *",
    start_date=pendulum.today(),
    catchup=False,
)
def meps_population_characteristics():
    import pandas as pd 

    #Source: https://www.meps.ahrq.gov/survey_comp/hc_technical_notes.shtml
    meps_region_states = pd.DataFrame({'region_value': [1, 2, 3, 4], 
                'region_label': ['Northeast', 'Midwest', 'South', 'West'],
                'state': [['Connecticut', 'Maine', 'Massachusetts', 'New Hampshire', 'New Jersey',
                            'New York', 'Pennsylvania', 'Rhode Island', 'Vermont'],
                            ['Indiana', 'Illinois', 'Iowa', 'Kansas', 'Michigan', 'Minnesota', 'Missouri',
                            'Nebraska', 'North Dakota', 'Ohio', 'South Dakota', 'Wisconsin'],
                            ['Alabama', 'Arkansas', 'Delaware', 'District of Columbia', 'Florida',
                            'Georgia', 'Kentucky', 'Louisiana', 'Maryland', 'Mississippi', 'North Carolina', 'Oklahoma', 'South Carolina', 'Tennessee', 'Texas', 'Virginia',
                            'West Virginia'],
                            ['Alaska', 'Arizona', 'California', 'Colorado', 'Hawaii', 'Idaho', 'Montana',
                            'Nevada', 'New Mexico', 'Oregon', 'Utah', 'Washington', 'Wyoming']]
                    }).set_index(['region_value'])['state'].apply(pd.Series).stack().reset_index(level=1, drop=True).reset_index().rename(columns={0:'state'}).astype(str)

    col_names=["duid", "pid", "dupersid", "panel", "famid31", "famid42",
        "famid53", "famid18", "famidyr", "cpsfamid", "fcsz1231",
        "fcrp1231", "ruletr31", "ruletr42", "ruletr53", "ruletr18",
        "rusize31", "rusize42", "rusize53", "rusize18", "ruclas31",
        "ruclas42", "ruclas53", "ruclas18", "famsze31", "famsze42",
        "famsze53", "famsze18", "fmrs1231", "fams1231", "famszeyr",
        "famrfpyr", "region31", "region42", "region53", "region18",
        "refprs31", "refprs42", "refprs53", "refprs18", "resp31",
        "resp42", "resp53", "resp18", "proxy31", "proxy42",
        "proxy53", "proxy18", "intvlang", "begrfm31", "begrfy31",
        "endrfm31", "endrfy31", "begrfm42", "begrfy42", "endrfm42",
        "endrfy42", "begrfm53", "begrfy53", "endrfm53", "endrfy53",
        "endrfm18", "endrfy18", "keyness", "inscop31", "inscop42",
        "inscop53", "inscop18", "insc1231", "inscope", "elgrnd31",
        "elgrnd42", "elgrnd53", "elgrnd18", "pstats31", "pstats42",
        "pstats53", "rurslt31", "rurslt42", "rurslt53", "age31x",
        "age42x", "age53x", "age18x", "agelast", "dobmm", "dobyy",
        "sex", "racev1x", "racev2x", "raceax", "racebx", "racewx",
        "racethx", "hispanx", "hispncat", "marry31x", "marry42x",
        "marry53x", "marry18x", "spouid31", "spouid42", "spouid53",
        "spouid18", "spouin31", "spouin42", "spouin53", "spouin18",
        "educyr", "hideg", "ftstu31x", "ftstu42x", "ftstu53x",
        "ftstu18x", "actdty31", "actdty42", "actdty53", "honrdc31",
        "honrdc42", "refrl31x", "refrl42x", "refrl53x", "refrl18x",
        "othlang", "langspk", "hwellspe", "othlgspk", "whtlgspk",
        "hwellspk", "bornusa", "yrsinus", "mopid31x", "mopid42x",
        "mopid53x", "dapid31x", "dapid42x", "dapid53x", "rthlth31",
        "rthlth42", "rthlth53", "mnhlth31", "mnhlth42", "mnhlth53",
        "hibpdx", "hibpaged", "bpmldx", "chddx", "chdaged",
        "angidx", "angiaged", "midx", "miaged", "ohrtdx",
        "ohrtaged", "ohrttype", "strkdx", "strkaged", "emphdx",
        "emphaged", "chbron31", "choldx", "cholaged", "cancerdx",
        "cabladdr", "cabreast", "cacervix", "cacolon", "calung",
        "calymph", "camelano", "caother", "caprosta", "caskinnm",
        "caskindk", "cauterus", "diabdx_m18", "diabaged",
        "jtpain31_m18", "arthdx", "arthtype", "arthaged", "asthdx",
        "asthaged", "asstil31", "asatak31", "asthep31", "asacut31",
        "asmrcn31", "asprev31", "asdaly31", "aspkfl31", "asevfl31",
        "aswnfl31", "adhdaddx", "adhdaged", "iadlhp31", "adlhlp31",
        "aidhlp31", "wlklim31", "lftdif31", "stpdif31", "wlkdif31",
        "mildif31", "stndif31", "bendif31", "rchdif31", "fngrdf31",
        "actlim31", "wrklim31", "hselim31", "schlim31", "unable31",
        "soclim31", "coglim31", "dfhear42", "dfsee42", "dfcog42",
        "dfwlkc42", "dfdrsb42", "dfernd42", "anylmi18", "chpmed42",
        "chpmhb42", "chpmcn42", "chserv42", "chsrhb42", "chsrcn42",
        "chlimi42", "chlihb42", "chlico42", "chther42", "chthhb42",
        "chthco42", "chcoun42", "chempb42", "cshcn42", "meshgt42",
        "whnhgt42", "meswgt42", "whnwgt42", "chbmix42", "mesvis42",
        "eathlt42", "whneat42", "physcl42", "whnphy42", "safest42",
        "whnsaf42", "boost42", "whnbst42", "lapblt42", "whnlap42",
        "helmet42", "whnhel42", "nosmok42", "whnsmk42", "timaln42",
        "lsteth53", "phyexe53", "oftsmk53", "saqelig", "adsex42",
        "adage42", "adprox42", "adgenh42", "addaya42", "adclim42",
        "adacls42", "adwklm42", "ademls42", "admwcf42", "adpain42",
        "adpcfl42", "adengy42", "adprst42", "adsoca42", "vpcs42",
        "vmcs42", "vrflag42", "adnerv42", "adhope42", "adrest42",
        "adsad42", "adefrt42", "adwrth42", "k6sum42", "adintr42",
        "addprs42", "phq242", "adbrtc42", "admdvt42", "adflst42",
        "adwghd42", "adbmi42", "adwtad42", "adkalc42", "adrnk542",
        "adrnk442", "adstal42", "adtbac42", "adoftb42", "adqttb42",
        "adqtmd42", "adqthp42", "admood42", "adbpck42", "adchlc42",
        "adpneu42", "adshng42", "adnoap42", "addscu42", "adcoln42",
        "adclns42", "adsgmd42", "adblds42", "adpros42", "adpsag42",
        "adutrm42", "adpap42", "adpapg42", "adostp42", "adbndn42",
        "adbrst42", "admmgr42", "adcmpm42", "adcmpy42", "adlang42",
        "vsaqelig", "vactdy53", "vaprht53", "vacopd53", "vaderm53",
        "vagerd53", "vahrls53", "vaback53", "vajtpn53", "varthr53",
        "vagout53", "vaneck53", "vatmd53", "vaptsd53", "valcoh53",
        "vabipl53", "vadepr53", "vamood53", "vapros53", "varhab53",
        "vamnhc53", "vagcns53", "varxmd53", "vacrgv53", "vamobl53",
        "vacost53", "varecm53", "varep53", "vawait53", "valoct53",
        "vantwk53", "vaneed53", "vaout53", "vapast53", "vacomp53",
        "vamrec53", "vagtrc53", "vacarc53", "vaprob53", "vacare53",
        "vapact53", "vapcpr53", "vaprov53", "vapcot53", "vapcco53",
        "vapcrc53", "vapcsn53", "vapcrf53", "vapcso53", "vapcou53",
        "vapcun53", "vaspcl53", "vaspmh53", "vaspou53", "vaspun53",
        "vacmpm53", "vacmpy53", "vaprox53", "dcselig", "dsdia53",
        "dsa1c53", "dsft1953", "dsft1853", "dsft1753", "dsfb1753",
        "dsftnv53", "dsey1953", "dsey1853", "dsey1753", "dseb1753",
        "dseynv53", "dsch1953", "dsch1853", "dsch1753", "dscb1753",
        "dschnv53", "dsfl1953", "dsfl1853", "dsfl1753", "dsvb1753",
        "dsflnv53", "dskidn53", "dseypr53", "dsdiet53", "dsmed53",
        "dsinsu53", "dscpcp53", "dscnpc53", "dscphn53", "dscint53",
        "dscgrp53", "dsconf53", "dsprx53", "ddnwrk18", "othdys18",
        "othndd18", "acceli42", "haveus42", "practp42",
        "ynousc42_m18", "provty42_m18", "plctyp42", "tmtkus42",
        "typepe42", "locatn42", "hsplap42", "whitpr42", "blckpr42",
        "asianp42", "natamp42", "pacisp42", "othrcp42", "gendrp42",
        "phnreg42", "offhou42", "afthou42", "treatm42", "decide42",
        "explop42", "prvspk42", "dlayca42", "afrdca42", "dlaydn42",
        "afrddn42", "dlaypm42", "afrdpm42", "empst31", "empst42",
        "empst53", "rndflg31", "morjob31", "morjob42", "morjob53",
        "evrwrk", "hrwg31x", "hrwg42x", "hrwg53x", "hrwgim31",
        "hrwgim42", "hrwgim53", "hrhow31", "hrhow42", "hrhow53",
        "diffwg31", "diffwg42", "diffwg53", "nhrwg31", "nhrwg42",
        "nhrwg53", "hour31", "hour42", "hour53", "tempjb31",
        "tempjb42", "tempjb53", "ssnljb31", "ssnljb42", "ssnljb53",
        "selfcm31", "selfcm42", "selfcm53", "disvw31x", "disvw42x",
        "disvw53x", "choic31", "choic42", "choic53", "indcat31",
        "indcat42", "indcat53", "numemp31", "numemp42", "numemp53",
        "more31", "more42", "more53", "union31", "union42",
        "union53", "nwk31", "nwk42", "nwk53", "chgj3142",
        "chgj4253", "ychj3142", "ychj4253", "stjbmm31", "stjbyy31",
        "stjbmm42", "stjbyy42", "stjbmm53", "stjbyy53", "evretire",
        "occcat31", "occcat42", "occcat53", "payvac31", "payvac42",
        "payvac53", "sicpay31", "sicpay42", "sicpay53", "paydr31",
        "paydr42", "paydr53", "retpln31", "retpln42", "retpln53",
        "bsnty31", "bsnty42", "bsnty53", "joborg31", "joborg42",
        "joborg53", "held31x", "held42x", "held53x", "offer31x",
        "offer42x", "offer53x", "ofremp31", "ofremp42", "ofremp53",
        "empst31h", "empst42h", "empst53h", "slfcm31h", "slfcm42h",
        "slfcm53h", "nmemp31h", "nmemp42h", "nmemp53h", "more31h",
        "more42h", "more53h", "indct31h", "indct42h", "indct53h",
        "occct31h", "occct42h", "occct53h", "hour31h", "hour42h",
        "hour53h", "jborg31h", "jborg42h", "jborg53h", "union31h",
        "union42h", "union53h", "bsnty31h", "bsnty42h", "bsnty53h",
        "hrwg31h", "hrwg42h", "hrwg53h", "cmjhld31", "cmjhld42",
        "cmjhld53", "offer31h", "offer42h", "offer53h", "ofemp31h",
        "ofemp42h", "ofemp53h", "pyvac31h", "pyvac42h", "pyvac53h",
        "scpay31h", "scpay42h", "scpay53h", "paydr31h", "paydr42h",
        "paydr53h", "rtpln31h", "rtpln42h", "rtpln53h", "filedr18",
        "wilfil18", "flstat18", "filer18", "jtinru18", "jntpid18",
        "taxfrm18", "foodst18", "foodmn18", "foodvl18", "ttlp18x",
        "faminc18", "povcat18", "povlev18", "wagep18x", "wagimp18",
        "busnp18x", "busimp18", "unemp18x", "uneimp18", "wcmpp18x",
        "wcpimp18", "intrp18x", "intimp18", "divdp18x", "divimp18",
        "salep18x", "salimp18", "pensp18x", "penimp18", "ssecp18x",
        "sscimp18", "trstp18x", "trtimp18", "vetsp18x", "vetimp18",
        "irasp18x", "iraimp18", "alimp18x", "aliimp18", "chldp18x",
        "chlimp18", "cashp18x", "cshimp18", "ssip18x", "ssiimp18",
        "pubp18x", "pubimp18", "othrp18x", "othimp18", "hieuidx",
        "trija18x", "trife18x", "trima18x", "triap18x", "trimy18x",
        "triju18x", "trijl18x", "triau18x", "trise18x", "trioc18x",
        "trino18x", "tride18x", "mcrja18", "mcrfe18", "mcrma18",
        "mcrap18", "mcrmy18", "mcrju18", "mcrjl18", "mcrau18",
        "mcrse18", "mcroc18", "mcrno18", "mcrde18", "mcrja18x",
        "mcrfe18x", "mcrma18x", "mcrap18x", "mcrmy18x", "mcrju18x",
        "mcrjl18x", "mcrau18x", "mcrse18x", "mcroc18x", "mcrno18x",
        "mcrde18x", "mcdja18", "mcdfe18", "mcdma18", "mcdap18",
        "mcdmy18", "mcdju18", "mcdjl18", "mcdau18", "mcdse18",
        "mcdoc18", "mcdno18", "mcdde18", "mcdja18x", "mcdfe18x",
        "mcdma18x", "mcdap18x", "mcdmy18x", "mcdju18x", "mcdjl18x",
        "mcdau18x", "mcdse18x", "mcdoc18x", "mcdno18x", "mcdde18x",
        "gvaja18", "gvafe18", "gvama18", "gvaap18", "gvamy18",
        "gvaju18", "gvajl18", "gvaau18", "gvase18", "gvaoc18",
        "gvano18", "gvade18", "gvbja18", "gvbfe18", "gvbma18",
        "gvbap18", "gvbmy18", "gvbju18", "gvbjl18", "gvbau18",
        "gvbse18", "gvboc18", "gvbno18", "gvbde18", "gvcja18",
        "gvcfe18", "gvcma18", "gvcap18", "gvcmy18", "gvcju18",
        "gvcjl18", "gvcau18", "gvcse18", "gvcoc18", "gvcno18",
        "gvcde18", "vapja18", "vapfe18", "vapma18", "vapap18",
        "vapmy18", "vapju18", "vapjl18", "vapau18", "vapse18",
        "vapoc18", "vapno18", "vapde18", "ihsja18", "ihsfe18",
        "ihsma18", "ihsap18", "ihsmy18", "ihsju18", "ihsjl18",
        "ihsau18", "ihsse18", "ihsoc18", "ihsno18", "ihsde18",
        "pubja18x", "pubfe18x", "pubma18x", "pubap18x", "pubmy18x",
        "pubju18x", "pubjl18x", "pubau18x", "pubse18x", "puboc18x",
        "pubno18x", "pubde18x", "pegja18", "pegfe18", "pegma18",
        "pegap18", "pegmy18", "pegju18", "pegjl18", "pegau18",
        "pegse18", "pegoc18", "pegno18", "pegde18", "pdkja18",
        "pdkfe18", "pdkma18", "pdkap18", "pdkmy18", "pdkju18",
        "pdkjl18", "pdkau18", "pdkse18", "pdkoc18", "pdkno18",
        "pdkde18", "pngja18", "pngfe18", "pngma18", "pngap18",
        "pngmy18", "pngju18", "pngjl18", "pngau18", "pngse18",
        "pngoc18", "pngno18", "pngde18", "pogja18", "pogfe18",
        "pogma18", "pogap18", "pogmy18", "pogju18", "pogjl18",
        "pogau18", "pogse18", "pogoc18", "pogno18", "pogde18",
        "poeja18", "poefe18", "poema18", "poeap18", "poemy18",
        "poeju18", "poejl18", "poeau18", "poese18", "poeoc18",
        "poeno18", "poede18", "pneja18", "pnefe18", "pnema18",
        "pneap18", "pnemy18", "pneju18", "pnejl18", "pneau18",
        "pnese18", "pneoc18", "pneno18", "pnede18", "prxja18",
        "prxfe18", "prxma18", "prxap18", "prxmy18", "prxju18",
        "prxjl18", "prxau18", "prxse18", "prxoc18", "prxno18",
        "prxde18", "prija18", "prife18", "prima18", "priap18",
        "primy18", "priju18", "prijl18", "priau18", "prise18",
        "prioc18", "prino18", "pride18", "hpeja18", "hpefe18",
        "hpema18", "hpeap18", "hpemy18", "hpeju18", "hpejl18",
        "hpeau18", "hpese18", "hpeoc18", "hpeno18", "hpede18",
        "hpdja18", "hpdfe18", "hpdma18", "hpdap18", "hpdmy18",
        "hpdju18", "hpdjl18", "hpdau18", "hpdse18", "hpdoc18",
        "hpdno18", "hpdde18", "hpnja18", "hpnfe18", "hpnma18",
        "hpnap18", "hpnmy18", "hpnju18", "hpnjl18", "hpnau18",
        "hpnse18", "hpnoc18", "hpnno18", "hpnde18", "hpoja18",
        "hpofe18", "hpoma18", "hpoap18", "hpomy18", "hpoju18",
        "hpojl18", "hpoau18", "hpose18", "hpooc18", "hpono18",
        "hpode18", "hpxja18", "hpxfe18", "hpxma18", "hpxap18",
        "hpxmy18", "hpxju18", "hpxjl18", "hpxau18", "hpxse18",
        "hpxoc18", "hpxno18", "hpxde18", "hprja18", "hprfe18",
        "hprma18", "hprap18", "hprmy18", "hprju18", "hprjl18",
        "hprau18", "hprse18", "hproc18", "hprno18", "hprde18",
        "insja18x", "insfe18x", "insma18x", "insap18x", "insmy18x",
        "insju18x", "insjl18x", "insau18x", "insse18x", "insoc18x",
        "insno18x", "insde18x", "prvev18", "triev18", "mcrev18",
        "mcdev18", "vaev18", "gvaev18", "gvbev18", "gvcev18",
        "unins18", "inscov18", "insurc18", "trist31x", "trist42x",
        "trist18x", "tripr31x", "tripr42x", "tripr18x", "triex31x",
        "triex42x", "triex18x", "trili31x", "trili42x", "trili18x",
        "trich31x", "trich42x", "trich18x", "mcrpd31", "mcrpd42",
        "mcrpd18", "mcrpd31x", "mcrpd42x", "mcrpd18x", "mcrpb31",
        "mcrpb42", "mcrpb18", "mcrpho31", "mcrpho42", "mcrpho18",
        "mcdhmo31", "mcdhmo42", "mcdhmo18", "mcdmc31", "mcdmc42",
        "mcdmc18", "prvhmo31", "prvhmo42", "prvhmo18", "fsagt31",
        "hasfsa31", "pfsamt31", "prevcovr", "morecovr", "tricr31x",
        "tricr42x", "tricr53x", "tricr18x", "triat31x", "triat42x",
        "triat53x", "triat18x", "mcaid31", "mcaid42", "mcaid53",
        "mcaid18", "mcaid31x", "mcaid42x", "mcaid53x", "mcaid18x",
        "mcare31", "mcare42", "mcare53", "mcare18", "mcare31x",
        "mcare42x", "mcare53x", "mcare18x", "mcdat31x", "mcdat42x",
        "mcdat53x", "mcdat18x", "govta31", "govta42", "govta53",
        "govta18", "govaat31", "govaat42", "govaat53", "govaat18",
        "govtb31", "govtb42", "govtb53", "govtb18", "govbat31",
        "govbat42", "govbat53", "govbat18", "govtc31", "govtc42",
        "govtc53", "govtc18", "govcat31", "govcat42", "govcat53",
        "govcat18", "vaprog31", "vaprog42", "vaprog53", "vaprog18",
        "vaprat31", "vaprat42", "vaprat53", "vaprat18", "ihs31",
        "ihs42", "ihs53", "ihs18", "ihsat31", "ihsat42", "ihsat53",
        "ihsat18", "pridk31", "pridk42", "pridk53", "pridk18",
        "prieu31", "prieu42", "prieu53", "prieu18", "pring31",
        "pring42", "pring53", "pring18", "priog31", "priog42",
        "priog53", "priog18", "prineo31", "prineo42", "prineo53",
        "prineo18", "prieuo31", "prieuo42", "prieuo53", "prieuo18",
        "prstx31", "prstx42", "prstx53", "prstx18", "priv31",
        "priv42", "priv53", "priv18", "privat31", "privat42",
        "privat53", "privat18", "pub31x", "pub42x", "pub53x",
        "pub18x", "pubat31x", "pubat42x", "pubat53x", "pubat18x",
        "verflg31", "verflg42", "verflg18", "ins31x", "ins42x",
        "ins53x", "ins18x", "insat31x", "insat42x", "insat53x",
        "insat18x", "dentin31", "dentin42", "dentin53", "dntins31",
        "dntins18", "pmedin31", "pmedin42", "pmedin53", "pmdins31",
        "pmdins18", "probpy42", "crfmpy42", "pyunbl42", "pmedup31",
        "pmedup42", "pmedup53", "pmedpy31", "pmedpy42", "pmedpy53",
        "tottch18", "totexp18", "totslf18", "totmcr18", "totmcd18",
        "totprv18", "totva18", "tottri18", "totofd18", "totstl18",
        "totwcp18", "totopr18", "totopu18", "totosr18", "totptr18",
        "tototh18", "obtotv18", "obvtch18", "obvexp18", "obvslf18",
        "obvmcr18", "obvmcd18", "obvprv18", "obvva18", "obvtri18",
        "obvofd18", "obvstl18", "obvwcp18", "obvopr18", "obvopu18",
        "obvosr18", "obvptr18", "obvoth18", "obdrv18", "obdtch18",
        "obdexp18", "obdslf18", "obdmcr18", "obdmcd18", "obdprv18",
        "obdva18", "obdtri18", "obdofd18", "obdstl18", "obdwcp18",
        "obdopr18", "obdopu18", "obdosr18", "obdptr18", "obdoth18",
        "optotv18", "opttch18", "optexp18", "optslf18", "optmcr18",
        "optmcd18", "optprv18", "optva18", "opttri18", "optofd18",
        "optstl18", "optwcp18", "optopr18", "optopu18", "optosr18",
        "optptr18", "optoth18", "opftch18", "opfexp18", "opfslf18",
        "opfmcr18", "opfmcd18", "opfprv18", "opfva18", "opftri18",
        "opfofd18", "opfstl18", "opfwcp18", "opfopr18", "opfopu18",
        "opfosr18", "opfptr18", "opfoth18", "opdexp18", "opdtch18",
        "opdslf18", "opdmcr18", "opdmcd18", "opdprv18", "opdva18",
        "opdtri18", "opdofd18", "opdstl18", "opdwcp18", "opdopr18",
        "opdopu18", "opdosr18", "opdptr18", "opdoth18", "opdrv18",
        "opvtch18", "opvexp18", "opvslf18", "opvmcr18", "opvmcd18",
        "opvprv18", "opvva18", "opvtri18", "opvofd18", "opvstl18",
        "opvwcp18", "opvopr18", "opvopu18", "opvosr18", "opvptr18",
        "opvoth18", "opsexp18", "opstch18", "opsslf18", "opsmcr18",
        "opsmcd18", "opsprv18", "opsva18", "opstri18", "opsofd18",
        "opsstl18", "opswcp18", "opsopr18", "opsopu18", "opsosr18",
        "opsptr18", "opsoth18", "ertot18", "erttch18", "ertexp18",
        "ertslf18", "ertmcr18", "ertmcd18", "ertprv18", "ertva18",
        "erttri18", "ertofd18", "ertstl18", "ertwcp18", "ertopr18",
        "ertopu18", "ertosr18", "ertptr18", "ertoth18", "erftch18",
        "erfexp18", "erfslf18", "erfmcr18", "erfmcd18", "erfprv18",
        "erfva18", "erftri18", "erfofd18", "erfstl18", "erfwcp18",
        "erfopr18", "erfopu18", "erfosr18", "erfptr18", "erfoth18",
        "erdexp18", "erdtch18", "erdslf18", "erdmcr18", "erdmcd18",
        "erdprv18", "erdva18", "erdtri18", "erdofd18", "erdstl18",
        "erdwcp18", "erdopr18", "erdopu18", "erdosr18", "erdptr18",
        "erdoth18", "ipdis18", "iptexp18", "ipttch18", "iptslf18",
        "iptmcr18", "iptmcd18", "iptprv18", "iptva18", "ipttri18",
        "iptofd18", "iptstl18", "iptwcp18", "iptopr18", "iptopu18",
        "iptosr18", "iptptr18", "iptoth18", "ipfexp18", "ipftch18",
        "ipfslf18", "ipfmcr18", "ipfmcd18", "ipfprv18", "ipfva18",
        "ipftri18", "ipfofd18", "ipfstl18", "ipfwcp18", "ipfopr18",
        "ipfopu18", "ipfosr18", "ipfptr18", "ipfoth18", "ipdexp18",
        "ipdtch18", "ipdslf18", "ipdmcr18", "ipdmcd18", "ipdprv18",
        "ipdva18", "ipdtri18", "ipdofd18", "ipdstl18", "ipdwcp18",
        "ipdopr18", "ipdopu18", "ipdosr18", "ipdptr18", "ipdoth18",
        "ipngtd18", "dvtot18", "dvttch18", "dvtexp18", "dvtslf18",
        "dvtmcr18", "dvtmcd18", "dvtprv18", "dvtva18", "dvttri18",
        "dvtofd18", "dvtstl18", "dvtwcp18", "dvtopr18", "dvtopu18",
        "dvtosr18", "dvtptr18", "dvtoth18", "hhtotd18", "hhagd18",
        "hhatch18", "hhaexp18", "hhaslf18", "hhamcr18", "hhamcd18",
        "hhaprv18", "hhava18", "hhatri18", "hhaofd18", "hhastl18",
        "hhawcp18", "hhaopr18", "hhaopu18", "hhaosr18", "hhaptr18",
        "hhaoth18", "hhindd18", "hhntch18", "hhnexp18", "hhnslf18",
        "hhnmcd18", "hhnmcr18", "hhnprv18", "hhnva18", "hhntri18",
        "hhnofd18", "hhnstl18", "hhnwcp18", "hhnopr18", "hhnopu18",
        "hhnosr18", "hhnptr18", "hhnoth18", "hhinfd18", "visexp18",
        "vistch18", "visslf18", "vismcr18", "vismcd18", "visprv18",
        "visva18", "vistri18", "visofd18", "visstl18", "viswcp18",
        "visopr18", "visopu18", "visosr18", "visptr18", "visoth18",
        "othtch18", "othexp18", "othslf18", "othmcr18", "othmcd18",
        "othprv18", "othva18", "othtri18", "othofd18", "othstl18",
        "othwcp18", "othopr18", "othopu18", "othosr18", "othptr18",
        "othoth18", "rxtot18", "rxexp18", "rxslf18", "rxmcr18",
        "rxmcd18", "rxprv18", "rxva18", "rxtri18", "rxofd18",
        "rxstl18", "rxwcp18", "rxopr18", "rxopu18", "rxosr18",
        "rxptr18", "rxoth18", "perwt18f", "famwt18f", "famwt18c",
        "saqwt18f", "diabw18f", "vsaqw18f", "varstr", "varpsu"]

    col_spaces = [(0,7),
    (7,10),
    (10,20),
    (20,22),
    (22,24),
    (24,26),
    (26,28),
    (28,30),
    (30,32),
    (32,34),
    (34,36),
    (36,38),
    (38,40),
    (40,42),
    (42,44),
    (44,47),
    (47,49),
    (49,51),
    (51,53),
    (53,55),
    (55,57),
    (57,59),
    (59,61),
    (61,62),
    (62,64),
    (64,66),
    (66,68),
    (68,70),
    (70,72),
    (72,74),
    (74,76),
    (76,77),
    (77,79),
    (79,81),
    (81,83),
    (83,85),
    (85,88),
    (88,91),
    (91,94),
    (94,97),
    (97,98),
    (98,99),
    (99,100),
    (100,101),
    (101,103),(103,105),(105,107),(107,108),(108,110),(110,112),(112,116),(116,118),(118,122),(122,124),(124,128),(128,130),(130,134),(134,136),(136,140),(140,142),(142,146),(146,148),(148,152),(152,153),(153,154),(154,155),(155,156),(156,157),(157,158),(158,159),(159,160),(160,161),(161,162),(162,163),(163,165),(165,167),(167,169),(169,171),(171,173),(173,175),(175,177),(177,179),(179,181),(181,183),(183,185),(185,187),(187,191),(191,192),(192,193),(193,195),(195,196),(196,197),(197,198),(198,199),(199,200),(200,201),(201,203),(203,205),(205,207),(207,209),(209,212),(212,215),(215,218),(218,221),(221,224),(224,227),(227,230),(230,233),(233,236),(236,239),(239,241),(241,243),(243,245),(245,247),(247,249),(249,251),(251,253),(253,256),(256,259),(259,261),(261,263),(263,265),(265,267),(267,270),(270,272),(272,275),(275,278),(278,280),(280,282),(282,285),(285,287),(287,290),(290,293),(293,296),(296,299),(299,302),(302,305),(305,307),(307,309),(309,311),(311,313),(313,315),(315,317),(317,320),(320,322),(322,324),(324,327),(327,329),(329,332),(332,334),(334,337),(337,339),(339,342),(342,344),(344,346),(346,349),(349,351),(351,354),(354,356),(356,358),(358,361),(361,363),(363,366),(366,368),(368,370),(370,372),(372,374),(374,376),(376,378),(378,380),(380,382),(382,384),(384,386),(386,388),(388,390),(390,393),(393,395),(395,397),(397,400),(400,402),(402,405),(405,407),(407,409),(409,412),(412,415),(415,417),(417,420),(420,422),(422,425),(425,427),(427,430),(430,432),(432,434),(434,437),(437,439),(439,441),(441,443),(443,445),(445,447),(447,449),(449,451),(451,453),(453,455),(455,457),(457,459),(459,461),(461,463),(463,465),(465,467),(467,469),(469,471),(471,473),(473,475),(475,477),(477,479),(479,481),(481,483),(483,485),(485,487),(487,489),(489,492),(492,495),(495,497),(497,499),(499,502),(502,504),(504,506),(506,509),(509,511),(511,513),(513,516),(516,518),(518,520),(520,523),(523,525),(525,527),(527,530),(530,532),(532,535),(535,537),(537,542),(542,545),(545,548),(548,550),(550,553),(553,555),(555,557),(557,559),(559,562),(562,564),(564,567),(567,569),(569,572),(572,574),(574,577),(577,579),(579,582),(582,584),(584,586),(586,588),(588,589),(589,592),(592,595),(595,598),(598,601),(601,604),(604,607),(607,610),(610,613),(613,616),(616,619),(619,622),(622,625),(625,628),(628,631),(631,634),(634,640),(640,646),(646,648),(648,651),(651,654),(654,657),(657,660),(660,663),(663,666),(666,669),(669,672),(672,675),(675,678),(678,681),(681,684),(684,687),(687,690),(690,695),(695,698),(698,701),(701,704),(704,707),(707,710),(710,713),(713,716),(716,719),(719,722),(722,725),(725,728),(728,731),(731,734),(734,737),(737,740),(740,743),(743,746),(746,749),(749,752),(752,755),(755,758),(758,761),(761,764),(764,767),(767,770),(770,773),(773,776),(776,779),(779,782),(782,785),(785,788),(788,792),(792,794),(794,795),(795,797),(797,800),(800,803),(803,806),(806,809),(809,812),(812,815),(815,818),(818,821),(821,824),(824,827),(827,830),(830,833),(833,836),(836,839),(839,842),(842,845),(845,848),(848,851),(851,854),(854,857),(857,860),(860,863),(863,866),(866,869),(869,872),(872,875),(875,878),(878,881),(881,884),(884,887),(887,890),(890,893),(893,896),(896,899),(899,902),(902,905),(905,908),(908,911),(911,914),(914,917),(917,920),(920,923),(923,926),(926,929),(929,931),(931,934),(934,937),(937,940),(940,942),(942,945),(945,948),(948,951),(951,954),(954,957),(957,961),(961,964),(964,965),(965,967),(967,970),(970,973),(973,976),(976,979),(979,982),(982,985),(985,988),(988,991),(991,994),(994,997),(997,1000),
    (1000,1003),(1003,1006),(1006,1009),(1009,1012),(1012,1015),(1015,1018),(1018,1021),(1021,1024),(1024,1027),(1027,1030),(1030,1033),(1033,1036),(1036,1039),(1039,1042),(1042,1045),(1045,1047),(1047,1049),(1049,1051),(1051,1053),(1053,1055),(1055,1058),(1058,1061),(1061,1064),(1064,1067),(1067,1070),(1070,1072),(1072,1074),(1074,1076),(1076,1078),(1078,1080),(1080,1082),(1082,1084),(1084,1086),(1086,1088),(1088,1090),(1090,1092),(1092,1094),(1094,1096),(1096,1098),(1098,1100),(1100,1102),(1102,1104),(1104,1106),(1106,1108),(1108,1110),(1110,1112),(1112,1114),(1114,1116),(1116,1118),(1118,1120),(1120,1122),(1122,1124),(1124,1126),(1126,1128),(1128,1130),(1130,1133),(1133,1136),(1136,1139),(1139,1141),(1141,1144),(1144,1147),(1147,1150),(1150,1153),(1153,1159),(1159,1165),(1165,1171),(1171,1172),(1172,1173),(1173,1174),(1174,1177),(1177,1180),(1180,1183),(1183,1186),(1186,1189),(1189,1192),(1192,1198),(1198,1204),(1204,1210),(1210,1213),(1213,1216),(1216,1219),(1219,1222),(1222,1225),(1225,1228),(1228,1231),(1231,1234),(1234,1237),(1237,1240),(1240,1243),(1243,1246),(1246,1249),(1249,1252),(1252,1255),(1255,1258),(1258,1261),(1261,1264),(1264,1267),(1267,1270),(1270,1273),(1273,1276),(1276,1279),(1279,1282),(1282,1285),(1285,1288),(1288,1291),(1291,1294),(1294,1297),(1297,1300),(1300,1303),(1303,1305),(1305,1307),(1307,1310),(1310,1313),(1313,1316),(1316,1319),(1319,1322),(1322,1326),(1326,1329),(1329,1333),(1333,1336),(1336,1340),(1340,1343),(1343,1346),(1346,1349),(1349,1352),(1352,1355),(1355,1358),(1358,1361),(1361,1364),(1364,1367),(1367,1370),(1370,1373),(1373,1376),(1376,1379),(1379,1382),(1382,1385),(1385,1388),(1388,1391),(1391,1394),(1394,1397),(1397,1400),(1400,1403),(1403,1406),(1406,1409),(1409,1412),(1412,1415),(1415,1418),(1418,1421),(1421,1424),(1424,1427),(1427,1430),(1430,1433),(1433,1435),(1435,1437),(1437,1439),(1439,1441),(1441,1443),(1443,1445),(1445,1448),(1448,1451),(1451,1454),(1454,1456),(1456,1458),(1458,1460),(1460,1462),(1462,1464),(1464,1466),(1466,1468),(1468,1470),(1470,1472),(1472,1475),(1475,1478),(1478,1481),(1481,1483),(1483,1485),(1485,1487),(1487,1489),(1489,1491),(1491,1493),(1493,1495),(1495,1497),(1497,1499),(1499,1505),(1505,1511),(1511,1517),(1517,1519),(1519,1521),(1521,1523),(1523,1525),(1525,1527),(1527,1529),(1529,1531),(1531,1533),(1533,1535),(1535,1537),(1537,1539),(1539,1541),(1541,1543),(1543,1545),(1545,1547),(1547,1549),(1549,1551),(1551,1553),(1553,1555),(1555,1557),(1557,1559),(1559,1561),(1561,1563),(1563,1565),(1565,1567),(1567,1569),(1569,1572),(1572,1574),(1574,1576),(1576,1578),(1578,1582),(1582,1589),(1589,1596),(1596,1597),(1597,1609),(1609,1615),(1615,1616),(1616,1622),(1622,1623),(1623,1628),(1628,1629),(1629,1634),(1634,1635),(1635,1640),(1640,1641),(1641,1646),(1646,1647),(1647,1654),(1654,1655),(1655,1660),(1660,1661),(1661,1666),(1666,1667),(1667,1674),(1674,1675),(1675,1680),(1680,1681),(1681,1686),(1686,1687),(1687,1692),(1692,1693),(1693,1698),(1698,1699),(1699,1704),(1704,1705),(1705,1710),(1710,1711),(1711,1716),(1716,1717),(1717,1723),(1723,1724),(1724,1733),(1733,1735),(1735,1737),(1737,1739),(1739,1741),(1741,1743),(1743,1745),(1745,1747),(1747,1749),(1749,1751),(1751,1753),(1753,1755),(1755,1757),(1757,1759),(1759,1761),(1761,1763),(1763,1765),(1765,1767),(1767,1769),(1769,1771),(1771,1773),(1773,1775),(1775,1777),(1777,1779),(1779,1781),(1781,1783),(1783,1785),(1785,1787),(1787,1789),(1789,1791),(1791,1793),(1793,1795),(1795,1797),(1797,1799),(1799,1801),(1801,1803),(1803,1805),(1805,1807),(1807,1809),(1809,1811),(1811,1813),(1813,1815),(1815,1817),(1817,1819),(1819,1821),(1821,1823),(1823,1825),(1825,1827),(1827,1829),(1829,1831),(1831,1833),(1833,1835),(1835,1837),(1837,1839),(1839,1841),(1841,1843),(1843,1845),(1845,1847),(1847,1849),(1849,1851),(1851,1853),(1853,1855),(1855,1857),(1857,1859),(1859,1861),(1861,1863),(1863,1865),(1865,1867),(1867,1869),(1869,1871),(1871,1873),(1873,1875),(1875,1877),(1877,1879),(1879,1881),(1881,1883),(1883,1885),(1885,1887),(1887,1889),(1889,1891),(1891,1893),(1893,1895),(1895,1897),(1897,1899),(1899,1901),(1901,1903),(1903,1905),(1905,1907),(1907,1909),(1909,1911),(1911,1913),(1913,1915),(1915,1917),(1917,1919),(1919,1921),(1921,1923),(1923,1925),(1925,1927),(1927,1929),(1929,1931),(1931,1933),(1933,1935),(1935,1937),(1937,1939),(1939,1941),(1941,1943),(1943,1945),(1945,1947),(1947,1949),(1949,1951),(1951,1953),(1953,1955),(1955,1957),(1957,1959),(1959,1961),(1961,1963),(1963,1965),(1965,1967),(1967,1969),(1969,1971),(1971,1973),(1973,1975),(1975,1977),(1977,1979),(1979,1981),(1981,1983),(1983,1985),(1985,1987),(1987,1989),(1989,1991),(1991,1993),(1993,1995),(1995,1997),(1997,1999),(1999,2001),(2001,2003),(2003,2005),(2005,2007),(2007,2009),(2009,2011),(2011,2013),(2013,2015),(2015,2017),(2017,2019),(2019,2021),(2021,2023),(2023,2025),(2025,2027),(2027,2029),(2029,2031),(2031,2033),(2033,2035),(2035,2037),(2037,2039),(2039,2041),(2041,2043),(2043,2045),(2045,2047),(2047,2049),(2049,2051),(2051,2053),(2053,2055),(2055,2057),(2057,2059),(2059,2061),(2061,2063),(2063,2065),(2065,2067),(2067,2069),(2069,2071),(2071,2073),(2073,2075),(2075,2077),(2077,2079),(2079,2081),(2081,2083),(2083,2085),(2085,2087),(2087,2089),(2089,2091),(2091,2093),(2093,2095),(2095,2097),(2097,2099),(2099,2101),(2101,2103),(2103,2105),(2105,2107),(2107,2109),(2109,2111),(2111,2113),(2113,2115),(2115,2117),(2117,2119),(2119,2121),(2121,2123),(2123,2125),(2125,2127),(2127,2129),(2129,2131),(2131,2133),(2133,2135),(2135,2137),(2137,2139),(2139,2141),(2141,2143),(2143,2145),(2145,2147),(2147,2149),(2149,2151),(2151,2153),(2153,2155),(2155,2157),(2157,2159),(2159,2161),(2161,2163),(2163,2165),(2165,2167),(2167,2169),(2169,2171),(2171,2173),(2173,2175),(2175,2177),(2177,2179),(2179,2181),(2181,2183),(2183,2185),(2185,2187),(2187,2189),(2189,2191),(2191,2193),(2193,2195),(2195,2197),(2197,2199),(2199,2201),(2201,2203),(2203,2205),(2205,2207),(2207,2209),(2209,2211),(2211,2213),(2213,2215),(2215,2217),(2217,2219),(2219,2221),(2221,2223),(2223,2225),(2225,2227),(2227,2229),(2229,2231),(2231,2233),(2233,2235),(2235,2237),(2237,2239),(2239,2241),(2241,2243),(2243,2245),(2245,2247),(2247,2249),(2249,2251),(2251,2253),(2253,2255),(2255,2257),(2257,2259),(2259,2261),(2261,2263),(2263,2265),(2265,2267),(2267,2269),(2269,2271),(2271,2273),(2273,2275),(2275,2277),(2277,2279),(2279,2281),(2281,2283),(2283,2285),(2285,2287),(2287,2289),(2289,2291),(2291,2293),(2293,2295),(2295,2297),(2297,2299),(2299,2301),(2301,2303),(2303,2305),(2305,2307),(2307,2309),(2309,2311),(2311,2313),(2313,2315),(2315,2317),(2317,2319),(2319,2321),(2321,2323),(2323,2325),(2325,2327),(2327,2329),(2329,2331),(2331,2333),(2333,2335),(2335,2337),(2337,2339),(2339,2341),(2341,2343),(2343,2345),(2345,2347),(2347,2349),(2349,2351),(2351,2353),(2353,2355),(2355,2357),(2357,2358),(2358,2359),(2359,2360),(2360,2361),(2361,2362),(2362,2363),(2363,2364),(2364,2365),(2365,2366),(2366,2367),(2367,2368),(2368,2370),(2370,2372),(2372,2374),(2374,2376),(2376,2378),(2378,2380),(2380,2382),(2382,2384),(2384,2386),(2386,2388),(2388,2390),(2390,2392),(2392,2394),(2394,2396),(2396,2398),(2398,2401),(2401,2404),(2404,2407),(2407,2410),(2410,2413),(2413,2416),(2416,2419),(2419,2422),(2422,2425),(2425,2428),(2428,2431),(2431,2434),(2434,2437),(2437,2440),(2440,2443),(2443,2446),(2446,2449),(2449,2452),(2452,2455),(2455,2458),(2458,2461),(2461,2463),(2463,2466),(2466,2470),(2470,2472),(2472,2474),(2474,2476),(2476,2478),(2478,2480),(2480,2482),(2482,2484),(2484,2486),(2486,2488),(2488,2490),(2490,2492),(2492,2494),(2494,2496),(2496,2498),(2498,2500),(2500,2502),(2502,2504),(2504,2506),(2506,2508),(2508,2510),(2510,2512),(2512,2514),(2514,2516),(2516,2518),(2518,2520),(2520,2522),(2522,2524),(2524,2526),(2526,2528),(2528,2530),(2530,2532),(2532,2534),(2534,2536),(2536,2538),(2538,2540),(2540,2542),(2542,2544),(2544,2546),(2546,2548),(2548,2550),(2550,2552),(2552,2554),(2554,2556),(2556,2558),(2558,2560),(2560,2562),(2562,2564),(2564,2566),(2566,2568),(2568,2570),(2570,2572),(2572,2574),(2574,2576),(2576,2578),(2578,2580),(2580,2582),(2582,2584),(2584,2586),(2586,2588),(2588,2590),(2590,2592),(2592,2594),(2594,2596),(2596,2598),(2598,2600),(2600,2602),(2602,2604),(2604,2606),(2606,2608),(2608,2610),(2610,2612),(2612,2614),(2614,2616),(2616,2618),(2618,2620),(2620,2622),(2622,2624),(2624,2626),(2626,2628),(2628,2630),(2630,2632),(2632,2634),(2634,2636),(2636,2638),(2638,2640),(2640,2642),(2642,2644),(2644,2646),(2646,2648),(2648,2650),(2650,2652),(2652,2654),(2654,2656),(2656,2658),(2658,2660),(2660,2662),(2662,2664),(2664,2666),(2666,2668),(2668,2670),(2670,2672),(2672,2674),(2674,2676),(2676,2678),(2678,2680),(2680,2682),(2682,2684),(2684,2686),(2686,2688),(2688,2690),(2690,2692),(2692,2694),(2694,2696),(2696,2698),(2698,2700),(2700,2702),(2702,2704),(2704,2706),(2706,2708),(2708,2710),(2710,2712),(2712,2714),(2714,2716),(2716,2718),(2718,2720),(2720,2722),(2722,2724),(2724,2726),(2726,2728),(2728,2730),(2730,2732),(2732,2734),(2734,2736),(2736,2738),(2738,2740),(2740,2742),(2742,2744),(2744,2746),(2746,2748),(2748,2750),(2750,2752),(2752,2755),(2755,2758),(2758,2761),(2761,2768),(2768,2774),(2774,2780),(2780,2786),(2786,2792),(2792,2798),(2798,2804),(2804,2810),(2810,2815),(2815,2820),(2820,2825),(2825,2831),(2831,2836),(2836,2842),(2842,2848),(2848,2854),(2854,2857),(2857,2864),(2864,2870),(2870,2876),(2876,2882),(2882,2887),(2887,2893),(2893,2898),(2898,2903),(2903,2908),(2908,2912),(2912,2917),(2917,2922),(2922,2926),(2926,2931),(2931,2937),(2937,2942),(2942,2945),(2945,2952),(2952,2958),(2958,2964),(2964,2970),(2970,2975),(2975,2981),(2981,2986),(2986,2991),(2991,2996),(2996,3000),(3000,3005),(3005,3010),(3010,3014),(3014,3019),(3019,3025),(3025,3030),(3030,3033),(3033,3040),(3040,3046),(3046,3051),(3051,3056),(3056,3062),(3062,3068),(3068,3073),(3073,3078),(3078,3082),(3082,3087),(3087,3092),(3092,3096),(3096,3100),(3100,3105),(3105,3111),(3111,3116),(3116,3123),(3123,3129),(3129,3134),(3134,3139),(3139,3145),(3145,3151),(3151,3156),(3156,3161),(3161,3165),(3165,3170),(3170,3175),(3175,3179),(3179,3183),(3183,3188),(3188,3194),(3194,3199),(3199,3204),(3204,3209),(3209,3213),(3213,3218),(3218,3223),(3223,3228),(3228,3233),(3233,3237),(3237,3238),(3238,3241),(3241,3245),(3245,3249),(3249,3253),(3253,3258),(3258,3263),(3263,3268),(3268,3270),(3270,3277),(3277,3283),(3283,3288),(3288,3293),(3293,3299),(3299,3304),(3304,3309),(3309,3313),(3313,3317),(3317,3321),(3321,3326),(3326,3330),(3330,3334),(3334,3339),(3339,3344),(3344,3349),(3349,3354),(3354,3359),(3359,3363),(3363,3368),(3368,3372),(3372,3377),(3377,3381),(3381,3385),(3385,3386),(3386,3389),(3389,3393),(3393,3397),(3397,3401),(3401,3406),(3406,3411),(3411,3416),(3416,3418),(3418,3424),(3424,3429),(3429,3433),(3433,3438),(3438,3443),(3443,3448),(3448,3452),(3452,3456),(3456,3460),(3460,3465),(3465,3470),(3470,3474),(3474,3478),(3478,3482),(3482,3487),(3487,3492),(3492,3498),(3498,3503),(3503,3507),(3507,3512),(3512,3517),(3517,3522),(3522,3526),(3526,3530),(3530,3534),(3534,3539),(3539,3544),(3544,3548),(3548,3552),(3552,3556),(3556,3561),(3561,3566),(3566,3571),(3571,3576),(3576,3580),(3580,3584),(3584,3588),(3588,3592),(3592,3596),(3596,3600),(3600,3601),(3601,3604),(3604,3608),(3608,3612),(3612,3615),(3615,3619),(3619,3623),(3623,3627),(3627,3629),(3629,3635),(3635,3642),(3642,3647),(3647,3653),(3653,3659),(3659,3665),(3665,3671),(3671,3676),(3676,3681),(3681,3686),(3686,3691),(3691,3696),(3696,3701),(3701,3707),(3707,3713),(3713,3719),(3719,3725),(3725,3732),(3732,3737),(3737,3743),(3743,3749),(3749,3755),(3755,3761),(3761,3766),(3766,3771),(3771,3776),(3776,3781),(3781,3786),(3786,3791),(3791,3797),(3797,3803),(3803,3809),(3809,3814),(3814,3820),(3820,3824),(3824,3829),(3829,3834),(3834,3839),(3839,3844),(3844,3848),(3848,3849),(3849,3853),(3853,3857),(3857,3861),(3861,3865),(3865,3870),(3870,3875),(3875,3880),(3880,3883),(3883,3885),(3885,3890),(3890,3895),(3895,3900),(3900,3904),(3904,3909),(3909,3914),(3914,3918),(3918,3922),(3922,3926),(3926,3930),(3930,3933),(3933,3937),(3937,3941),(3941,3945),(3945,3950),(3950,3954),(3954,3957),(3957,3960),(3960,3966),(3966,3972),(3972,3977),(3977,3983),(3983,3989),(3989,3994),(3994,3999),(3999,4000),(4000,4004),(4004,4009),(4009,4010),(4010,4014),(4014,4018),(4018,4022),(4022,4027),(4027,4032),(4032,4035),(4035,4041),(4041,4047),(4047,4053),(4053,4058),(4058,4062),(4062,4066),(4066,4071),(4071,4073),(4073,4074),(4074,4077),(4077,4078),(4078,4081),(4081,4082),(4082,4087),(4087,4091),(4091,4096),(4096,4099),(4099,4104),(4104,4109),(4109,4113),(4113,4117),(4117,4122),(4122,4126),(4126,4129),(4129,4132),(4132,4135),(4135,4138),(4138,4141),(4141,4145),(4145,4148),(4148,4152),(4152,4156),(4156,4160),(4160,4165),(4165,4170),(4170,4175),(4175,4180),(4180,4185),(4185,4190),(4190,4194),(4194,4199),(4199,4204),(4204,4208),(4208,4213),(4213,4217),(4217,4221),(4221,4225),(4225,4230),(4230,4235),(4235,4238),(4238,4244),(4244,4249),(4249,4255),(4255,4261),(4261,4267),(4267,4272),(4272,4277),(4277,4282),(4282,4287),(4287,4291),(4291,4297),(4297,4302),(4302,4308),(4308,4314),(4314,4320),(4320,4332),(4332,4344),(4344,4356),(4356,4369),(4369,4381),(4381,4393),(4393,4397),(4397,None)]

    dag_id = "meps_population_characteristics"
    filename = "h209"
    ds_url = f"https://meps.ahrq.gov/mepsweb/data_files/pufs/{filename}/{filename}dat.zip"

    # Task to download data from web location
    @task
    def extract():
        data_folder = Path("/opt/airflow/data") / dag_id
        data_path = get_dataset(ds_url, data_folder)
        return data_path
    
    @task
    def load(data_path):
        import pandas as pd
        import sqlalchemy
        
        pg_hook = PostgresHook(postgres_conn_id="postgres_default")
        engine = pg_hook.get_sqlalchemy_engine()

        # create empty table with columns in postgres
        # overwrite existing table, if exists
        df = pd.DataFrame(columns = col_names)
        df.to_sql(
            dag_id,
            con=engine,
            schema="datasource",
            if_exists="replace",
            index=False
        )

        with pd.read_fwf(
            data_path + f'/{filename}.dat',
            header=None,
            names=col_names,
            converters={col: str for col in col_names},
            colspecs=col_spaces,
            chunksize=1000
        ) as reader:
            reader
            for chunk in reader:
                chunk.to_sql(
                    dag_id,
                    con=engine,
                    schema="datasource",
                    if_exists="append",
                    index=False
                )

    load(extract())

meps_population_characteristics()
